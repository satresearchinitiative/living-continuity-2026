{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///Applications/MAMP/htdocs/35-SAT/SAT/app/api/submit-entry/route.js"],"sourcesContent":["export const dynamic = 'force-dynamic';\n\nexport async function POST(request) {\n  try {\n    const body = await request.json();\n    const { interpretation, name, keyword } = body;\n\n    if (!interpretation) {\n      return Response.json(\n        { error: 'Interpretation is required' },\n        { status: 400 }\n      );\n    }\n\n    const emailData = {\n      interpretation,\n      name: name || 'Anonymous',\n      keyword,\n      timestamp: new Date().toISOString()\n    };\n\n    const resendApiKey = process.env.RESEND_API_KEY;\n    \n    if (!resendApiKey) {\n      console.error('RESEND_API_KEY is not configured');\n      return Response.json(\n        { error: 'Email service is not configured' },\n        { status: 500 }\n      );\n    }\n\n    const toEmails = process.env.RESEND_TO_EMAIL \n      ? process.env.RESEND_TO_EMAIL.split(',').map(email => email.trim())\n      : ['admin@example.com'];\n\n    const emailPayload = {\n      from: process.env.RESEND_FROM_EMAIL || 'noreply@example.com',\n      to: toEmails,\n      subject: `New Interpretation Submission: ${keyword}`,\n      html: `\n        <h2>New Interpretation Submission</h2>\n        <p><strong>Keyword:</strong> ${keyword}</p>\n        <p><strong>Name:</strong> ${emailData.name}</p>\n        <p><strong>Interpretation:</strong></p>\n        <p>${interpretation.replace(/\\n/g, '<br>')}</p>\n        <p><strong>Submitted:</strong> ${emailData.timestamp}</p>\n      `\n    };\n\n    const resendResponse = await fetch('https://api.resend.com/emails', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': `Bearer ${resendApiKey}`\n      },\n      body: JSON.stringify(emailPayload)\n    });\n\n    if (!resendResponse.ok) {\n      const errorData = await resendResponse.json();\n      console.error('Resend API error:', errorData);\n      return Response.json(\n        { error: 'Failed to send email' },\n        { status: 500 }\n      );\n    }\n\n    const result = await resendResponse.json();\n    \n    return Response.json(\n      { \n        success: true, \n        messageId: result.id,\n        message: 'Entry submitted successfully' \n      },\n      { status: 200 }\n    );\n\n  } catch (error) {\n    console.error('Error processing submission:', error);\n    return Response.json(\n      { error: 'Internal server error' },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":";;;;;;AAAO,MAAM,UAAU;AAEhB,eAAe,KAAK,OAAO;IAChC,IAAI;QACF,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,EAAE,cAAc,EAAE,IAAI,EAAE,OAAO,EAAE,GAAG;QAE1C,IAAI,CAAC,gBAAgB;YACnB,OAAO,SAAS,IAAI,CAClB;gBAAE,OAAO;YAA6B,GACtC;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,YAAY;YAChB;YACA,MAAM,QAAQ;YACd;YACA,WAAW,IAAI,OAAO,WAAW;QACnC;QAEA,MAAM,eAAe,QAAQ,GAAG,CAAC,cAAc;QAE/C,IAAI,CAAC,cAAc;YACjB,QAAQ,KAAK,CAAC;YACd,OAAO,SAAS,IAAI,CAClB;gBAAE,OAAO;YAAkC,GAC3C;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,WAAW,QAAQ,GAAG,CAAC,eAAe,GACxC,QAAQ,GAAG,CAAC,eAAe,CAAC,KAAK,CAAC,KAAK,GAAG,CAAC,CAAA,QAAS,MAAM,IAAI,MAC9D;YAAC;SAAoB;QAEzB,MAAM,eAAe;YACnB,MAAM,QAAQ,GAAG,CAAC,iBAAiB,IAAI;YACvC,IAAI;YACJ,SAAS,CAAC,+BAA+B,EAAE,SAAS;YACpD,MAAM,CAAC;;qCAEwB,EAAE,QAAQ;kCACb,EAAE,UAAU,IAAI,CAAC;;WAExC,EAAE,eAAe,OAAO,CAAC,OAAO,QAAQ;uCACZ,EAAE,UAAU,SAAS,CAAC;MACvD,CAAC;QACH;QAEA,MAAM,iBAAiB,MAAM,MAAM,iCAAiC;YAClE,QAAQ;YACR,SAAS;gBACP,gBAAgB;gBAChB,iBAAiB,CAAC,OAAO,EAAE,cAAc;YAC3C;YACA,MAAM,KAAK,SAAS,CAAC;QACvB;QAEA,IAAI,CAAC,eAAe,EAAE,EAAE;YACtB,MAAM,YAAY,MAAM,eAAe,IAAI;YAC3C,QAAQ,KAAK,CAAC,qBAAqB;YACnC,OAAO,SAAS,IAAI,CAClB;gBAAE,OAAO;YAAuB,GAChC;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,SAAS,MAAM,eAAe,IAAI;QAExC,OAAO,SAAS,IAAI,CAClB;YACE,SAAS;YACT,WAAW,OAAO,EAAE;YACpB,SAAS;QACX,GACA;YAAE,QAAQ;QAAI;IAGlB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,gCAAgC;QAC9C,OAAO,SAAS,IAAI,CAClB;YAAE,OAAO;QAAwB,GACjC;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}