(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,50144,e=>{e.v({bottomButtons:"styles-module-scss-module__dJBWzG__bottomButtons",bottom_bar_wrapper:"styles-module-scss-module__dJBWzG__bottom_bar_wrapper",bottombarbutton:"styles-module-scss-module__dJBWzG__bottombarbutton",box_wrapper:"styles-module-scss-module__dJBWzG__box_wrapper",button:"styles-module-scss-module__dJBWzG__button",button_wrapper:"styles-module-scss-module__dJBWzG__button_wrapper",camera_modal:"styles-module-scss-module__dJBWzG__camera_modal",camera_modal_1:"styles-module-scss-module__dJBWzG__camera_modal_1",center_button:"styles-module-scss-module__dJBWzG__center_button",full:"styles-module-scss-module__dJBWzG__full",half:"styles-module-scss-module__dJBWzG__half",highlightedTerm:"styles-module-scss-module__dJBWzG__highlightedTerm",isDesktop:"styles-module-scss-module__dJBWzG__isDesktop",isMobile:"styles-module-scss-module__dJBWzG__isMobile",left:"styles-module-scss-module__dJBWzG__left",left_wrapper:"styles-module-scss-module__dJBWzG__left_wrapper",modal:"styles-module-scss-module__dJBWzG__modal",optionsbutton:"styles-module-scss-module__dJBWzG__optionsbutton",right:"styles-module-scss-module__dJBWzG__right",small_button:"styles-module-scss-module__dJBWzG__small_button",stoprotationbutton:"styles-module-scss-module__dJBWzG__stoprotationbutton",submenu:"styles-module-scss-module__dJBWzG__submenu",supplementbutton:"styles-module-scss-module__dJBWzG__supplementbutton",title:"styles-module-scss-module__dJBWzG__title",topbar_wrapper:"styles-module-scss-module__dJBWzG__topbar_wrapper",topbar_wrapper_mobile:"styles-module-scss-module__dJBWzG__topbar_wrapper_mobile",visible:"styles-module-scss-module__dJBWzG__visible",wrapper:"styles-module-scss-module__dJBWzG__wrapper"})},25547,e=>{e.v({close_button:"style-module-scss-module__CB8I9q__close_button",content:"style-module-scss-module__CB8I9q__content",modal_wrapper:"style-module-scss-module__CB8I9q__modal_wrapper"})},60796,e=>{e.v({camera_modal:"style-module-scss-module__ALzo2W__camera_modal",camera_wrapper:"style-module-scss-module__ALzo2W__camera_wrapper",item:"style-module-scss-module__ALzo2W__item",link:"style-module-scss-module__ALzo2W__link"})},81694,e=>{"use strict";let t,n,r;var i,o,a,s,l,u=e.i(20786),d=e.i(43476),c=e.i(33027),h=e.i(31067),f=e.i(71645),m=e.i(27138),p=e.i(1899),g=e.i(94848),g=g,v=e.i(2898),y=g,x=e.i(90072),w=x,_=e.i(31497);class A extends w.Mesh{set radius(e){this.material.uniforms.radius.value=e}get radius(){return this.material.uniforms.radius.value}set height(e){this.material.uniforms.height.value=e}get height(){return this.material.uniforms.height.value}constructor(e,t){var n,r;const i=(e=>e&&e.isCubeTexture)(e),o=Math.floor(Math.log2((null!=(r=i?null==(n=e.image[0])?void 0:n.width:e.image.width)?r:1024)/4)),a=Math.pow(2,o),s=3*Math.max(a,112),l=[i?"#define ENVMAP_TYPE_CUBE":"","#define CUBEUV_TEXEL_WIDTH ".concat(1/s),"#define CUBEUV_TEXEL_HEIGHT ".concat(1/(4*a)),"#define CUBEUV_MAX_MIP ".concat(o,".0")].join("\n")+"\n        #define ENVMAP_TYPE_CUBE_UV\n        varying vec3 vWorldPosition;\n        uniform float radius;\n        uniform float height;\n        uniform float angle;\n        #ifdef ENVMAP_TYPE_CUBE\n            uniform samplerCube map;\n        #else\n            uniform sampler2D map;\n        #endif\n        // From: https://www.shadertoy.com/view/4tsBD7\n        float diskIntersectWithBackFaceCulling( vec3 ro, vec3 rd, vec3 c, vec3 n, float r ) \n        {\n            float d = dot ( rd, n );\n            \n            if( d > 0.0 ) { return 1e6; }\n            \n            vec3  o = ro - c;\n            float t = - dot( n, o ) / d;\n            vec3  q = o + rd * t;\n            \n            return ( dot( q, q ) < r * r ) ? t : 1e6;\n        }\n        // From: https://www.iquilezles.org/www/articles/intersectors/intersectors.htm\n        float sphereIntersect( vec3 ro, vec3 rd, vec3 ce, float ra ) \n        {\n            vec3 oc = ro - ce;\n            float b = dot( oc, rd );\n            float c = dot( oc, oc ) - ra * ra;\n            float h = b * b - c;\n            \n            if( h < 0.0 ) { return -1.0; }\n            \n            h = sqrt( h );\n            \n            return - b + h;\n        }\n        vec3 project() \n        {\n            vec3 p = normalize( vWorldPosition );\n            vec3 camPos = cameraPosition;\n            camPos.y -= height;\n            float intersection = sphereIntersect( camPos, p, vec3( 0.0 ), radius );\n            if( intersection > 0.0 ) {\n                \n                vec3 h = vec3( 0.0, - height, 0.0 );\n                float intersection2 = diskIntersectWithBackFaceCulling( camPos, p, h, vec3( 0.0, 1.0, 0.0 ), radius );\n                p = ( camPos + min( intersection, intersection2 ) * p ) / radius;\n            } else {\n                p = vec3( 0.0, 1.0, 0.0 );\n            }\n            return p;\n        }\n        #include <common>\n        #include <cube_uv_reflection_fragment>\n        void main() \n        {\n            vec3 projectedWorldPosition = project();\n            \n            #ifdef ENVMAP_TYPE_CUBE\n                vec3 outcolor = textureCube( map, projectedWorldPosition ).rgb;\n            #else\n                vec3 direction = normalize( projectedWorldPosition );\n                vec2 uv = equirectUv( direction );\n                vec3 outcolor = texture2D( map, uv ).rgb;\n            #endif\n            gl_FragColor = vec4( outcolor, 1.0 );\n            #include <tonemapping_fragment>\n            #include <".concat(_.version>=154?"colorspace_fragment":"encodings_fragment",">\n        }\n        "),u={map:{value:e},height:{value:(null==t?void 0:t.height)||15},radius:{value:(null==t?void 0:t.radius)||100}};super(new w.IcosahedronGeometry(1,16),new w.ShaderMaterial({uniforms:u,fragmentShader:l,vertexShader:"\n        varying vec3 vWorldPosition;\n        void main() \n        {\n            vec4 worldPosition = ( modelMatrix * vec4( position, 1.0 ) );\n            vWorldPosition = worldPosition.xyz;\n            \n            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        }\n        ",side:w.DoubleSide}))}}var S=e.i(90652),b=x;class M extends b.DataTextureLoader{parse(e){let t,n,r,i=function(e,t){switch(e){case 1:throw Error("THREE.RGBELoader: Read Error: "+(t||""));case 2:throw Error("THREE.RGBELoader: Write Error: "+(t||""));case 3:throw Error("THREE.RGBELoader: Bad File Format: "+(t||""));default:throw Error("THREE.RGBELoader: Memory Error: "+(t||""))}},o=function(e,t,n){t=t||1024;let r=e.pos,i=-1,o=0,a="",s=String.fromCharCode.apply(null,new Uint16Array(e.subarray(r,r+128)));for(;0>(i=s.indexOf("\n"))&&o<t&&r<e.byteLength;)a+=s,o+=s.length,r+=128,s+=String.fromCharCode.apply(null,new Uint16Array(e.subarray(r,r+128)));return -1<i&&(!1!==n&&(e.pos+=o+i+1),a+s.slice(0,i))},a=new Uint8Array(e);a.pos=0;let s=function(e){let t,n,r=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,a=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,s=/^\s*FORMAT=(\S+)\s*$/,l=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,u={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};for(!(e.pos>=e.byteLength)&&(t=o(e))||i(1,"no header found"),(n=t.match(/^#\?(\S+)/))||i(3,"bad initial token"),u.valid|=1,u.programtype=n[1],u.string+=t+"\n";!1!==(t=o(e));){if(u.string+=t+"\n","#"===t.charAt(0)){u.comments+=t+"\n";continue}if((n=t.match(r))&&(u.gamma=parseFloat(n[1])),(n=t.match(a))&&(u.exposure=parseFloat(n[1])),(n=t.match(s))&&(u.valid|=2,u.format=n[1]),(n=t.match(l))&&(u.valid|=4,u.height=parseInt(n[1],10),u.width=parseInt(n[2],10)),2&u.valid&&4&u.valid)break}return 2&u.valid||i(3,"missing format specifier"),4&u.valid||i(3,"missing image size specifier"),u}(a),l=s.width,u=s.height,d=function(e,t,n){if(t<8||t>32767||2!==e[0]||2!==e[1]||128&e[2])return new Uint8Array(e);t!==(e[2]<<8|e[3])&&i(3,"wrong scanline width");let r=new Uint8Array(4*t*n);r.length||i(4,"unable to allocate buffer space");let o=0,a=0,s=4*t,l=new Uint8Array(4),u=new Uint8Array(s),d=n;for(;d>0&&a<e.byteLength;){a+4>e.byteLength&&i(1),l[0]=e[a++],l[1]=e[a++],l[2]=e[a++],l[3]=e[a++],(2!=l[0]||2!=l[1]||(l[2]<<8|l[3])!=t)&&i(3,"bad rgbe scanline format");let n=0,c;for(;n<s&&a<e.byteLength;){let t=(c=e[a++])>128;if(t&&(c-=128),(0===c||n+c>s)&&i(3,"bad scanline data"),t){let t=e[a++];for(let e=0;e<c;e++)u[n++]=t}else u.set(e.subarray(a,a+c),n),n+=c,a+=c}for(let e=0;e<t;e++){let n=0;r[o]=u[e+n],n+=t,r[o+1]=u[e+n],n+=t,r[o+2]=u[e+n],n+=t,r[o+3]=u[e+n],o+=4}d--}return r}(a.subarray(a.pos),l,u);switch(this.type){case b.FloatType:let c=new Float32Array(4*(r=d.length/4));for(let e=0;e<r;e++)!function(e,t,n,r){let i=Math.pow(2,e[t+3]-128)/255;n[r+0]=e[t+0]*i,n[r+1]=e[t+1]*i,n[r+2]=e[t+2]*i,n[r+3]=1}(d,4*e,c,4*e);t=c,n=b.FloatType;break;case b.HalfFloatType:let h=new Uint16Array(4*(r=d.length/4));for(let e=0;e<r;e++)!function(e,t,n,r){let i=Math.pow(2,e[t+3]-128)/255;n[r+0]=b.DataUtils.toHalfFloat(Math.min(e[t+0]*i,65504)),n[r+1]=b.DataUtils.toHalfFloat(Math.min(e[t+1]*i,65504)),n[r+2]=b.DataUtils.toHalfFloat(Math.min(e[t+2]*i,65504)),n[r+3]=b.DataUtils.toHalfFloat(1)}(d,4*e,h,4*e);t=h,n=b.HalfFloatType;break;default:throw Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:l,height:u,data:t,header:s.string,gamma:s.gamma,exposure:s.exposure,type:n}}setDataType(e){return this.type=e,this}load(e,t,n,r){return super.load(e,function(e,n){switch(e.type){case b.FloatType:case b.HalfFloatType:"colorSpace"in e?e.colorSpace="srgb-linear":e.encoding=3e3,e.minFilter=b.LinearFilter,e.magFilter=b.LinearFilter,e.generateMipmaps=!1,e.flipY=!0}t&&t(e,n)},n,r)}constructor(e){super(e),this.type=b.HalfFloatType}}var E=x,j={},C=function(e,t,n,r,i){var o=new Worker(j[t]||(j[t]=URL.createObjectURL(new Blob([e],{type:"text/javascript"}))));return o.onerror=function(e){return i(e.error,null)},o.onmessage=function(e){return i(null,e.data)},o.postMessage(n,r),o},T=Uint8Array,N=Uint16Array,k=Uint32Array,R=new T([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),F=new T([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),z=new T([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),L=function(e,t){for(var n=new N(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];for(var i=new k(n[30]),r=1;r<30;++r)for(var o=n[r];o<n[r+1];++o)i[o]=o-n[r]<<5|r;return[n,i]},G=L(R,2),U=G[0],I=G[1];U[28]=258,I[258]=28;for(var O=L(F,0),P=O[0],B=O[1],D=new N(32768),W=0;W<32768;++W){var H=(43690&W)>>>1|(21845&W)<<1;H=(61680&(H=(52428&H)>>>2|(13107&H)<<2))>>>4|(3855&H)<<4,D[W]=((65280&H)>>>8|(255&H)<<8)>>>1}for(var V=function(e,t,n){for(var r,i=e.length,o=0,a=new N(t);o<i;++o)++a[e[o]-1];var s=new N(t);for(o=0;o<t;++o)s[o]=s[o-1]+a[o-1]<<1;if(n){r=new N(1<<t);var l=15-t;for(o=0;o<i;++o)if(e[o])for(var u=o<<4|e[o],d=t-e[o],c=s[e[o]-1]++<<d,h=c|(1<<d)-1;c<=h;++c)r[D[c]>>>l]=u}else for(o=0,r=new N(i);o<i;++o)e[o]&&(r[o]=D[s[e[o]-1]++]>>>15-e[o]);return r},q=new T(288),W=0;W<144;++W)q[W]=8;for(var W=144;W<256;++W)q[W]=9;for(var W=256;W<280;++W)q[W]=7;for(var W=280;W<288;++W)q[W]=8;for(var X=new T(32),W=0;W<32;++W)X[W]=5;var Y=V(q,9,0),J=V(q,9,1),Z=V(X,5,0),Q=V(X,5,1),$=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},K=function(e,t,n){var r=t/8|0;return(e[r]|e[r+1]<<8)>>(7&t)&n},ee=function(e,t){var n=t/8|0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>(7&t)},et=function(e){return(e/8|0)+(7&e&&1)},en=function(e,t,n){(null==t||t<0)&&(t=0),(null==n||n>e.length)&&(n=e.length);var r=new(e instanceof N?N:e instanceof k?k:T)(n-t);return r.set(e.subarray(t,n)),r},er=function(e,t,n){var r=e.length;if(!r||n&&!n.l&&r<5)return t||new T(0);var i=!t||n,o=!n||n.i;n||(n={}),t||(t=new T(3*r));var a=function(e){var n=t.length;if(e>n){var r=new T(Math.max(2*n,e));r.set(t),t=r}},s=n.f||0,l=n.p||0,u=n.b||0,d=n.l,c=n.d,h=n.m,f=n.n,m=8*r;do{if(!d){n.f=s=K(e,l,1);var p=K(e,l+1,3);if(l+=3,p)if(1==p)d=J,c=Q,h=9,f=5;else if(2==p){var g=K(e,l,31)+257,v=K(e,l+10,15)+4,y=g+K(e,l+5,31)+1;l+=14;for(var x=new T(y),w=new T(19),_=0;_<v;++_)w[z[_]]=K(e,l+3*_,7);l+=3*v;for(var A=$(w),S=(1<<A)-1,b=V(w,A,1),_=0;_<y;){var M=b[K(e,l,S)];l+=15&M;var E=M>>>4;if(E<16)x[_++]=E;else{var j=0,C=0;for(16==E?(C=3+K(e,l,3),l+=2,j=x[_-1]):17==E?(C=3+K(e,l,7),l+=3):18==E&&(C=11+K(e,l,127),l+=7);C--;)x[_++]=j}}var N=x.subarray(0,g),k=x.subarray(g);h=$(N),f=$(k),d=V(N,h,1),c=V(k,f,1)}else throw"invalid block type";else{var E=et(l)+4,L=e[E-4]|e[E-3]<<8,G=E+L;if(G>r){if(o)throw"unexpected EOF";break}i&&a(u+L),t.set(e.subarray(E,G),u),n.b=u+=L,n.p=l=8*G;continue}if(l>m){if(o)throw"unexpected EOF";break}}i&&a(u+131072);for(var I=(1<<h)-1,O=(1<<f)-1,B=l;;B=l){var j=d[ee(e,l)&I],D=j>>>4;if((l+=15&j)>m){if(o)throw"unexpected EOF";break}if(!j)throw"invalid length/literal";if(D<256)t[u++]=D;else if(256==D){B=l,d=null;break}else{var W=D-254;if(D>264){var _=D-257,H=R[_];W=K(e,l,(1<<H)-1)+U[_],l+=H}var q=c[ee(e,l)&O],X=q>>>4;if(!q)throw"invalid distance";l+=15&q;var k=P[X];if(X>3){var H=F[X];k+=ee(e,l)&(1<<H)-1,l+=H}if(l>m){if(o)throw"unexpected EOF";break}i&&a(u+131072);for(var Y=u+W;u<Y;u+=4)t[u]=t[u-k],t[u+1]=t[u+1-k],t[u+2]=t[u+2-k],t[u+3]=t[u+3-k];u=Y}}n.l=d,n.p=B,n.b=u,d&&(s=1,n.m=h,n.d=c,n.n=f)}while(!s)return u==t.length?t:en(t,0,u)},ei=function(e,t,n){n<<=7&t;var r=t/8|0;e[r]|=n,e[r+1]|=n>>>8},eo=function(e,t,n){n<<=7&t;var r=t/8|0;e[r]|=n,e[r+1]|=n>>>8,e[r+2]|=n>>>16},ea=function(e,t){for(var n=[],r=0;r<e.length;++r)e[r]&&n.push({s:r,f:e[r]});var i=n.length,o=n.slice();if(!i)return[ef,0];if(1==i){var a=new T(n[0].s+1);return a[n[0].s]=1,[a,1]}n.sort(function(e,t){return e.f-t.f}),n.push({s:-1,f:25001});var s=n[0],l=n[1],u=0,d=1,c=2;for(n[0]={s:-1,f:s.f+l.f,l:s,r:l};d!=i-1;)s=n[n[u].f<n[c].f?u++:c++],l=n[u!=d&&n[u].f<n[c].f?u++:c++],n[d++]={s:-1,f:s.f+l.f,l:s,r:l};for(var h=o[0].s,r=1;r<i;++r)o[r].s>h&&(h=o[r].s);var f=new N(h+1),m=es(n[d-1],f,0);if(m>t){var r=0,p=0,g=m-t,v=1<<g;for(o.sort(function(e,t){return f[t.s]-f[e.s]||e.f-t.f});r<i;++r){var y=o[r].s;if(f[y]>t)p+=v-(1<<m-f[y]),f[y]=t;else break}for(p>>>=g;p>0;){var x=o[r].s;f[x]<t?p-=1<<t-f[x]++-1:++r}for(;r>=0&&p;--r){var w=o[r].s;f[w]==t&&(--f[w],++p)}m=t}return[new T(f),m]},es=function(e,t,n){return -1==e.s?Math.max(es(e.l,t,n+1),es(e.r,t,n+1)):t[e.s]=n},el=function(e){for(var t=e.length;t&&!e[--t];);for(var n=new N(++t),r=0,i=e[0],o=1,a=function(e){n[r++]=e},s=1;s<=t;++s)if(e[s]==i&&s!=t)++o;else{if(!i&&o>2){for(;o>138;o-=138)a(32754);o>2&&(a(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(a(i),--o;o>6;o-=6)a(8304);o>2&&(a(o-3<<5|8208),o=0)}for(;o--;)a(i);o=1,i=e[s]}return[n.subarray(0,r),t]},eu=function(e,t){for(var n=0,r=0;r<t.length;++r)n+=e[r]*t[r];return n},ed=function(e,t,n){var r=n.length,i=et(t+2);e[i]=255&r,e[i+1]=r>>>8,e[i+2]=255^e[i],e[i+3]=255^e[i+1];for(var o=0;o<r;++o)e[i+o+4]=n[o];return(i+4+r)*8},ec=function(e,t,n,r,i,o,a,s,l,u,d){ei(t,d++,n),++i[256];for(var c,h,f,m,p=ea(i,15),g=p[0],v=p[1],y=ea(o,15),x=y[0],w=y[1],_=el(g),A=_[0],S=_[1],b=el(x),M=b[0],E=b[1],j=new N(19),C=0;C<A.length;++C)j[31&A[C]]++;for(var C=0;C<M.length;++C)j[31&M[C]]++;for(var T=ea(j,7),k=T[0],L=T[1],G=19;G>4&&!k[z[G-1]];--G);var U=u+5<<3,I=eu(i,q)+eu(o,X)+a,O=eu(i,g)+eu(o,x)+a+14+3*G+eu(j,k)+(2*j[16]+3*j[17]+7*j[18]);if(U<=I&&U<=O)return ed(t,d,e.subarray(l,l+u));if(ei(t,d,1+(O<I)),d+=2,O<I){c=V(g,v,0),h=g,f=V(x,w,0),m=x;var P=V(k,L,0);ei(t,d,S-257),ei(t,d+5,E-1),ei(t,d+10,G-4),d+=14;for(var C=0;C<G;++C)ei(t,d+3*C,k[z[C]]);d+=3*G;for(var B=[A,M],D=0;D<2;++D)for(var W=B[D],C=0;C<W.length;++C){var H=31&W[C];ei(t,d,P[H]),d+=k[H],H>15&&(ei(t,d,W[C]>>>5&127),d+=W[C]>>>12)}}else c=Y,h=q,f=Z,m=X;for(var C=0;C<s;++C)if(r[C]>255){var H=r[C]>>>18&31;eo(t,d,c[H+257]),d+=h[H+257],H>7&&(ei(t,d,r[C]>>>23&31),d+=R[H]);var J=31&r[C];eo(t,d,f[J]),d+=m[J],J>3&&(eo(t,d,r[C]>>>5&8191),d+=F[J])}else eo(t,d,c[r[C]]),d+=h[r[C]];return eo(t,d,c[256]),d+h[256]},eh=new k([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),ef=new T(0),em=function(e,t,n,r,i,o){var a=e.length,s=new T(r+a+5*(1+Math.ceil(a/7e3))+i),l=s.subarray(r,s.length-i),u=0;if(!t||a<8)for(var d=0;d<=a;d+=65535){var c=d+65535;c<a?u=ed(l,u,e.subarray(d,c)):(l[d]=o,u=ed(l,u,e.subarray(d,a)))}else{for(var h=eh[t-1],f=h>>>13,m=8191&h,p=(1<<n)-1,g=new N(32768),v=new N(p+1),y=Math.ceil(n/3),x=2*y,w=function(t){return(e[t]^e[t+1]<<y^e[t+2]<<x)&p},_=new k(25e3),A=new N(288),S=new N(32),b=0,M=0,d=0,E=0,j=0,C=0;d<a;++d){var z=w(d),L=32767&d,G=v[z];if(g[L]=G,v[z]=L,j<=d){var U=a-d;if((b>7e3||E>24576)&&U>423){u=ec(e,l,0,_,A,S,M,E,C,d-C,u),E=b=M=0,C=d;for(var O=0;O<286;++O)A[O]=0;for(var O=0;O<30;++O)S[O]=0}var P=2,D=0,W=m,H=L-G&32767;if(U>2&&z==w(d-H))for(var V=Math.min(f,U)-1,q=Math.min(32767,d),X=Math.min(258,U);H<=q&&--W&&L!=G;){if(e[d+P]==e[d+P-H]){for(var Y=0;Y<X&&e[d+Y]==e[d+Y-H];++Y);if(Y>P){if(P=Y,D=H,Y>V)break;for(var J=Math.min(H,Y-2),Z=0,O=0;O<J;++O){var Q=d-H+O+32768&32767,$=g[Q],K=Q-$+32768&32767;K>Z&&(Z=K,G=Q)}}}G=g[L=G],H+=L-G+32768&32767}if(D){_[E++]=0x10000000|I[P]<<18|B[D];var ee=31&I[P],er=31&B[D];M+=R[ee]+F[er],++A[257+ee],++S[er],j=d+P,++b}else _[E++]=e[d],++A[e[d]]}}u=ec(e,l,o,_,A,S,M,E,C,d-C,u),!o&&7&u&&(u=ed(l,u+1,ef))}return en(s,0,r+et(u)+i)},ep=function(){for(var e=new Int32Array(256),t=0;t<256;++t){for(var n=t,r=9;--r;)n=(1&n&&-0x12477ce0)^n>>>1;e[t]=n}return e}(),eg=function(){var e=-1;return{p:function(t){for(var n=e,r=0;r<t.length;++r)n=ep[255&n^t[r]]^n>>>8;e=n},d:function(){return~e}}},ev=function(){var e=1,t=0;return{p:function(n){for(var r=e,i=t,o=n.length,a=0;a!=o;){for(var s=Math.min(a+2655,o);a<s;++a)i+=r+=n[a];r=(65535&r)+15*(r>>16),i=(65535&i)+15*(i>>16)}e=r,t=i},d:function(){return e%=65521,t%=65521,(255&e)<<24|e>>>8<<16|(255&t)<<8|t>>>8}}},ey=function(e,t,n,r,i){return em(e,null==t.level?6:t.level,null==t.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(e.length)))):12+t.mem,n,r,!i)},ex=function(e,t){var n={};for(var r in e)n[r]=e[r];for(var r in t)n[r]=t[r];return n},ew=function(e,t,n){for(var r=e(),i=e.toString(),o=i.slice(i.indexOf("[")+1,i.lastIndexOf("]")).replace(/ /g,"").split(","),a=0;a<r.length;++a){var s=r[a],l=o[a];if("function"==typeof s){t+=";"+l+"=";var u=s.toString();if(s.prototype)if(-1!=u.indexOf("[native code]")){var d=u.indexOf(" ",8)+1;t+=u.slice(d,u.indexOf("(",d))}else for(var c in t+=u,s.prototype)t+=";"+l+".prototype."+c+"="+s.prototype[c].toString();else t+=u}else n[l]=s}return[t,n]},e_=[],eA=function(e){var t=[];for(var n in e)(e[n]instanceof T||e[n]instanceof N||e[n]instanceof k)&&t.push((e[n]=new e[n].constructor(e[n])).buffer);return t},eS=function(e,t,n,r){if(!e_[n]){for(var i,o="",a={},s=e.length-1,l=0;l<s;++l)o=(i=ew(e[l],o,a))[0],a=i[1];e_[n]=ew(e[s],o,a)}var u=ex({},e_[n][1]);return C(e_[n][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+t.toString()+"}",n,u,eA(u),r)},eb=function(){return[T,N,k,R,F,z,U,P,J,Q,D,V,$,K,ee,et,en,er,eY,eC,eT]},eM=function(){return[T,N,k,R,F,z,I,B,Y,q,Z,X,D,eh,ef,V,ei,eo,ea,es,el,eu,ed,ec,et,en,em,ey,eV,eC]},eE=function(){return[eU,eI]},ej=function(){return[eB]},eC=function(e){return postMessage(e,[e.buffer])},eT=function(e){return e&&e.size&&new T(e.size)},eN=function(e){return e.ondata=function(e,t){return postMessage([e,t],[e.buffer])},function(t){return e.push(t.data[0],t.data[1])}},ek=function(e,t,n,r,i){var o,a=eS(e,r,i,function(e,n){e?(a.terminate(),t.ondata.call(t,e)):(n[1]&&a.terminate(),t.ondata.call(t,e,n[0],n[1]))});a.postMessage(n),t.push=function(e,n){if(o)throw"stream finished";if(!t.ondata)throw"no stream handler";a.postMessage([e,o=n],[e.buffer])},t.terminate=function(){a.terminate()}},eR=function(e,t){return e[t]|e[t+1]<<8},eF=function(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0},ez=function(e,t){return eF(e,t)+0x100000000*eF(e,t+4)},eL=function(e,t,n){for(;n;++t)e[t]=n,n>>>=8},eG=function(e,t){var n=t.filename;if(e[0]=31,e[1]=139,e[2]=8,e[8]=t.level<2?4:2*(9==t.level),e[9]=3,0!=t.mtime&&eL(e,4,Math.floor(new Date(t.mtime||Date.now())/1e3)),n){e[3]=8;for(var r=0;r<=n.length;++r)e[r+10]=n.charCodeAt(r)}},eU=function(e){if(31!=e[0]||139!=e[1]||8!=e[2])throw"invalid gzip data";var t=e[3],n=10;4&t&&(n+=e[10]|(e[11]<<8)+2);for(var r=(t>>3&1)+(t>>4&1);r>0;r-=!e[n++]);return n+(2&t)},eI=function(e){var t=e.length;return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0},eO=function(e){return 10+(e.filename&&e.filename.length+1||0)},eP=function(e,t){var n=t.level,r=0==n?0:n<6?1:9==n?3:2;e[0]=120,e[1]=r<<6|(r?32-2*r:1)},eB=function(e){if((15&e[0])!=8||e[0]>>>4>7||(e[0]<<8|e[1])%31)throw"invalid zlib data";if(32&e[1])throw"invalid zlib data: preset dictionaries not supported"};function eD(e,t){return t||"function"!=typeof e||(t=e,e={}),this.ondata=t,e}var eW=function(){function e(e,t){t||"function"!=typeof e||(t=e,e={}),this.ondata=t,this.o=e||{}}return e.prototype.p=function(e,t){this.ondata(ey(e,this.o,0,0,!t),t)},e.prototype.push=function(e,t){if(this.d)throw"stream finished";if(!this.ondata)throw"no stream handler";this.d=t,this.p(e,t||!1)},e}(),eH=function(e,t){ek([eM,function(){return[eN,eW]}],this,eD.call(this,e,t),function(e){onmessage=eN(new eW(e.data))},6)};function eV(e,t){return ey(e,t||{},0,0)}var eq=function(){function e(e){this.s={},this.p=new T(0),this.ondata=e}return e.prototype.e=function(e){if(this.d)throw"stream finished";if(!this.ondata)throw"no stream handler";var t=this.p.length,n=new T(t+e.length);n.set(this.p),n.set(e,t),this.p=n},e.prototype.c=function(e){this.d=this.s.i=e||!1;var t=this.s.b,n=er(this.p,this.o,this.s);this.ondata(en(n,t,this.s.b),this.d),this.o=en(n,this.s.b-32768),this.s.b=this.o.length,this.p=en(this.p,this.s.p/8|0),this.s.p&=7},e.prototype.push=function(e,t){this.e(e),this.c(t)},e}(),eX=function(e){this.ondata=e,ek([eb,function(){return[eN,eq]}],this,0,function(){onmessage=eN(new eq)},7)};function eY(e,t){return er(e,t)}(function(){function e(e,t){this.c=eg(),this.l=0,this.v=1,eW.call(this,e,t)}e.prototype.push=function(e,t){eW.prototype.push.call(this,e,t)},e.prototype.p=function(e,t){this.c.p(e),this.l+=e.length;var n=ey(e,this.o,this.v&&eO(this.o),t&&8,!t);this.v&&(eG(n,this.o),this.v=0),t&&(eL(n,n.length-8,this.c.d()),eL(n,n.length-4,this.l)),this.ondata(n,t)}})();var eJ=function(){function e(e){this.v=1,eq.call(this,e)}return e.prototype.push=function(e,t){if(eq.prototype.e.call(this,e),this.v){var n=this.p.length>3?eU(this.p):4;if(n>=this.p.length&&!t)return;this.p=this.p.subarray(n),this.v=0}if(t){if(this.p.length<8)throw"invalid gzip stream";this.p=this.p.subarray(0,-8)}eq.prototype.c.call(this,t)},e}(),eZ=function(e){this.ondata=e,ek([eb,eE,function(){return[eN,eq,eJ]}],this,0,function(){onmessage=eN(new eJ)},9)},eQ=(function(){function e(e,t){this.c=ev(),this.v=1,eW.call(this,e,t)}e.prototype.push=function(e,t){eW.prototype.push.call(this,e,t)},e.prototype.p=function(e,t){this.c.p(e);var n=ey(e,this.o,this.v&&2,t&&4,!t);this.v&&(eP(n,this.o),this.v=0),t&&eL(n,n.length-4,this.c.d()),this.ondata(n,t)}}(),function(){function e(e){this.v=1,eq.call(this,e)}return e.prototype.push=function(e,t){if(eq.prototype.e.call(this,e),this.v){if(this.p.length<2&&!t)return;this.p=this.p.subarray(2),this.v=0}if(t){if(this.p.length<4)throw"invalid zlib stream";this.p=this.p.subarray(0,-4)}eq.prototype.c.call(this,t)},e}()),e$=function(e){this.ondata=e,ek([eb,ej,function(){return[eN,eq,eQ]}],this,0,function(){onmessage=eN(new eQ)},11)};function eK(e,t){return er((eB(e),e.subarray(2,-4)),t)}var e0=function(){function e(e){this.G=eJ,this.I=eq,this.Z=eQ,this.ondata=e}return e.prototype.push=function(e,t){if(!this.ondata)throw"no stream handler";if(this.s)this.s.push(e,t);else{if(this.p&&this.p.length){var n=new T(this.p.length+e.length);n.set(this.p),n.set(e,this.p.length)}else this.p=e;if(this.p.length>2){var r=this,i=function(){r.ondata.apply(r,arguments)};this.s=31==this.p[0]&&139==this.p[1]&&8==this.p[2]?new this.G(i):(15&this.p[0])!=8||this.p[0]>>4>7||(this.p[0]<<8|this.p[1])%31?new this.I(i):new this.Z(i),this.s.push(this.p,t),this.p=null}}},e}();(function(e){this.G=eZ,this.I=eX,this.Z=e$,this.ondata=e}).prototype.push=function(e,t){e0.prototype.push.call(this,e,t)};var e1="undefined"!=typeof TextEncoder&&new TextEncoder,e2="undefined"!=typeof TextDecoder&&new TextDecoder,e3=0;try{e2.decode(ef,{stream:!0}),e3=1}catch(e){}var e5=function(e){for(var t="",n=0;;){var r=e[n++],i=(r>127)+(r>223)+(r>239);if(n+i>e.length)return[t,en(e,n-1)];i?3==i?t+=String.fromCharCode(55296|(r=((15&r)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536)>>10,56320|1023&r):1&i?t+=String.fromCharCode((31&r)<<6|63&e[n++]):t+=String.fromCharCode((15&r)<<12|(63&e[n++])<<6|63&e[n++]):t+=String.fromCharCode(r)}};function e4(e,t){if(t){for(var n=new T(e.length),r=0;r<e.length;++r)n[r]=e.charCodeAt(r);return n}if(e1)return e1.encode(e);for(var i=e.length,o=new T(e.length+(e.length>>1)),a=0,s=function(e){o[a++]=e},r=0;r<i;++r){if(a+5>o.length){var l=new T(a+8+(i-r<<1));l.set(o),o=l}var u=e.charCodeAt(r);u<128||t?s(u):(u<2048?s(192|u>>6):(u>55295&&u<57344?(s(240|(u=65536+(1047552&u)|1023&e.charCodeAt(++r))>>18),s(128|u>>12&63)):s(224|u>>12),s(128|u>>6&63)),s(128|63&u))}return en(o,0,a)}(function(e){this.ondata=e,e3?this.t=new TextDecoder:this.p=ef}).prototype.push=function(e,t){if(!this.ondata)throw"no callback";if(t=!!t,this.t){if(this.ondata(this.t.decode(e,{stream:!0}),t),t){if(this.t.decode().length)throw"invalid utf-8 data";this.t=null}return}if(!this.p)throw"stream finished";var n=new T(this.p.length+e.length);n.set(this.p),n.set(e,this.p.length);var r=e5(n),i=r[0],o=r[1];if(t){if(o.length)throw"invalid utf-8 data";this.p=null}else this.p=o;this.ondata(i,t)},(function(e){this.ondata=e}).prototype.push=function(e,t){if(!this.ondata)throw"no callback";if(this.d)throw"stream finished";this.ondata(e4(e),this.d=t||!1)};var e8=function(e){return 1==e?3:e<6?2:+(9==e)},e6=function(e,t){for(;1!=eR(e,t);t+=4+eR(e,t+2));return[ez(e,t+12),ez(e,t+4),ez(e,t+20)]},e7=function(e){var t=0;if(e)for(var n in e){var r=e[n].length;if(r>65535)throw"extra field too long";t+=r+4}return t},e9=function(e,t,n,r,i,o,a,s){var l=r.length,u=n.extra,d=s&&s.length,c=e7(u);eL(e,t,null!=a?0x2014b50:0x4034b50),t+=4,null!=a&&(e[t++]=20,e[t++]=n.os),e[t]=20,t+=2,e[t++]=n.flag<<1|(null==o&&8),e[t++]=i&&8,e[t++]=255&n.compression,e[t++]=n.compression>>8;var h=new Date(null==n.mtime?Date.now():n.mtime),f=h.getFullYear()-1980;if(f<0||f>119)throw"date not in range 1980-2099";if(eL(e,t,f<<25|h.getMonth()+1<<21|h.getDate()<<16|h.getHours()<<11|h.getMinutes()<<5|h.getSeconds()>>>1),t+=4,null!=o&&(eL(e,t,n.crc),eL(e,t+4,o),eL(e,t+8,n.size)),eL(e,t+12,l),eL(e,t+14,c),t+=16,null!=a&&(eL(e,t,d),eL(e,t+6,n.attrs),eL(e,t+10,a),t+=14),e.set(r,t),t+=l,c)for(var m in u){var p=u[m],g=p.length;eL(e,t,+m),eL(e,t+2,g),e.set(p,t+4),t+=4+g}return d&&(e.set(s,t),t+=d),t},te=function(e,t,n,r,i){eL(e,t,0x6054b50),eL(e,t+8,n),eL(e,t+10,n),eL(e,t+12,r),eL(e,t+16,i)},tt=function(){function e(e){this.filename=e,this.c=eg(),this.size=0,this.compression=0}return e.prototype.process=function(e,t){this.ondata(null,e,t)},e.prototype.push=function(e,t){if(!this.ondata)throw"no callback - add to ZIP archive before pushing";this.c.p(e),this.size+=e.length,t&&(this.crc=this.c.d()),this.process(e,t||!1)},e}();function tn(e,t){var n=this;t||(t={}),tt.call(this,e),this.d=new eW(t,function(e,t){n.ondata(null,e,t)}),this.compression=8,this.flag=e8(t.level)}function tr(e,t){var n=this;t||(t={}),tt.call(this,e),this.d=new eH(t,function(e,t,r){n.ondata(e,t,r)}),this.compression=8,this.flag=e8(t.level),this.terminate=this.d.terminate}function ti(e){this.ondata=e,this.u=[],this.d=1}tn.prototype.process=function(e,t){try{this.d.push(e,t)}catch(e){this.ondata(e,null,t)}},tn.prototype.push=function(e,t){tt.prototype.push.call(this,e,t)},tr.prototype.process=function(e,t){this.d.push(e,t)},tr.prototype.push=function(e,t){tt.prototype.push.call(this,e,t)},ti.prototype.add=function(e){var t=this;if(2&this.d)throw"stream finished";var n=e4(e.filename),r=n.length,i=e.comment,o=i&&e4(i),a=r!=e.filename.length||o&&i.length!=o.length,s=r+e7(e.extra)+30;if(r>65535)throw"filename too long";var l=new T(s);e9(l,0,e,n,a);var u=[l],d=function(){for(var e=0,n=u;e<n.length;e++){var r=n[e];t.ondata(null,r,!1)}u=[]},c=this.d;this.d=0;var h=this.u.length,f=ex(e,{f:n,u:a,o:o,t:function(){e.terminate&&e.terminate()},r:function(){if(d(),c){var e=t.u[h+1];e?e.r():t.d=1}c=1}}),m=0;e.ondata=function(n,r,i){if(n)t.ondata(n,r,i),t.terminate();else if(m+=r.length,u.push(r),i){var o=new T(16);eL(o,0,0x8074b50),eL(o,4,e.crc),eL(o,8,m),eL(o,12,e.size),u.push(o),f.c=m,f.b=s+m+16,f.crc=e.crc,f.size=e.size,c&&f.r(),c=1}else c&&d()},this.u.push(f)},ti.prototype.end=function(){var e=this;if(2&this.d){if(1&this.d)throw"stream finishing";throw"stream finished"}this.d?this.e():this.u.push({r:function(){1&e.d&&(e.u.splice(-1,1),e.e())},t:function(){}}),this.d=3},ti.prototype.e=function(){for(var e=0,t=0,n=0,r=0,i=this.u;r<i.length;r++){var o=i[r];n+=46+o.f.length+e7(o.extra)+(o.o?o.o.length:0)}for(var a=new T(n+22),s=0,l=this.u;s<l.length;s++){var o=l[s];e9(a,e,o,o.f,o.u,o.c,t,o.o),e+=46+o.f.length+e7(o.extra)+(o.o?o.o.length:0),t+=o.b}te(a,e,this.u.length,n,t),this.ondata(null,a,!0),this.d=2},ti.prototype.terminate=function(){for(var e=0,t=this.u;e<t.length;e++)t[e].t();this.d=2};var to=function(){function e(){}return e.prototype.push=function(e,t){this.ondata(null,e,t)},e.compression=0,e}();function ta(){var e=this;this.i=new eq(function(t,n){e.ondata(null,t,n)})}function ts(e,t){var n=this;t<32e4?this.i=new eq(function(e,t){n.ondata(null,e,t)}):(this.i=new eX(function(e,t,r){n.ondata(e,t,r)}),this.terminate=this.i.terminate)}function tl(e){this.onfile=e,this.k=[],this.o={0:to},this.p=ef}ta.prototype.push=function(e,t){try{this.i.push(e,t)}catch(n){this.ondata(n,e,t)}},ta.compression=8,ts.prototype.push=function(e,t){this.i.terminate&&(e=en(e,0)),this.i.push(e,t)},ts.compression=8,tl.prototype.push=function(e,t){var n=this;if(!this.onfile)throw"no callback";if(!this.p)throw"stream finished";if(this.c>0){var r=Math.min(this.c,e.length),i=e.subarray(0,r);if(this.c-=r,this.d?this.d.push(i,!this.c):this.k[0].push(i),(e=e.subarray(r)).length)return this.push(e,t)}else{var o=0,a=0,s=void 0,l=void 0;this.p.length?e.length?((l=new T(this.p.length+e.length)).set(this.p),l.set(e,this.p.length)):l=this.p:l=e;for(var u=l.length,d=this.c,c=d&&this.d,h=this;a<u-4&&"break"!==function(){var e=eF(l,a);if(0x4034b50==e){o=1,s=a,h.d=null,h.c=0;var t=eR(l,a+6),r=eR(l,a+8),i=8&t,c=eR(l,a+26),f=eR(l,a+28);if(u>a+30+c+f){var m,p,g=[];h.k.unshift(g),o=2;var v=eF(l,a+18),y=eF(l,a+22),x=function(e,t){if(t){for(var n="",r=0;r<e.length;r+=16384)n+=String.fromCharCode.apply(null,e.subarray(r,r+16384));return n}if(e2)return e2.decode(e);var i=e5(e),o=i[0];if(i[1].length)throw"invalid utf-8 data";return o}(l.subarray(a+30,a+=30+c),!(2048&t));0xffffffff==v?(v=(m=i?[-2]:e6(l,a))[0],y=m[1]):i&&(v=-1),a+=f,h.c=v;var w={name:x,compression:r,start:function(){if(!w.ondata)throw"no callback";if(v){var e=n.o[r];if(!e)throw"unknown compression type "+r;(p=v<0?new e(x):new e(x,v,y)).ondata=function(e,t,n){w.ondata(e,t,n)};for(var t=0;t<g.length;t++){var i=g[t];p.push(i,!1)}n.k[0]==g&&n.c?n.d=p:p.push(ef,!0)}else w.ondata(null,ef,!0)},terminate:function(){p&&p.terminate&&p.terminate()}};v>=0&&(w.size=v,w.originalSize=y),h.onfile(w)}return"break"}if(d){if(0x8074b50==e)return s=a+=12+(-2==d&&8),o=3,h.c=0,"break";else if(0x2014b50==e)return s=a-=4,o=3,h.c=0,"break"}}();++a);if(this.p=ef,d<0){var f=o?l.subarray(0,s-12-(-2==d&&8)-(0x8074b50==eF(l,s-16)&&4)):l.subarray(0,a);c?c.push(f,!!o):this.k[+(2==o)].push(f)}if(2&o)return this.push(l.subarray(a),t);this.p=l.subarray(a)}if(t){if(this.c)throw"invalid zip file";this.p=null}},tl.prototype.register=function(e){this.o[e.compression]=e};let tu=_.version>=152;class td extends E.DataTextureLoader{parse(e){let t={l:0,c:0,lc:0};function n(e,n,r,i,o){for(;r<e;)n=n<<8|M(i,o),r+=8;t.l=n>>(r-=e)&(1<<e)-1,t.c=n,t.lc=r}let r=Array(59),i={c:0,lc:0};function o(e,t,n,r){e=e<<8|M(n,r),t+=8,i.c=e,i.lc=t}let a={c:0,lc:0};function s(e,t,n,r,s,l,u,d,c,h){if(e==t){r<8&&(o(n,r,s,u),n=i.c,r=i.lc);var f=n>>(r-=8),f=new Uint8Array([f])[0];if(c.value+f>h)return!1;for(var m=d[c.value-1];f-- >0;)d[c.value++]=m}else{if(!(c.value<h))return!1;d[c.value++]=e}a.c=n,a.lc=r}function l(e){var t=65535&e;return t>32767?t-65536:t}let u={a:0,b:0};function d(e,t){var n=l(e),r=l(t),i=n+(1&r)+(r>>1),o=i-r;u.a=i,u.b=o}function c(e,t){var n=65535&t,r=(65535&e)-(n>>1)&65535;u.a=n+r-32768&65535,u.b=r}function h(e,l,u,d,c,h){var f=u.value,m=b(l,u),p=b(l,u);u.value+=4;var g=b(l,u);if(u.value+=4,m<0||m>=65537||p<0||p>=65537)throw"Something wrong with HUF_ENCSIZE";for(var v=Array(65537),y=Array(16384),x=0;x<16384;x++)y[x]={},y[x].len=0,y[x].lit=0,y[x].p=null;var w=d-(u.value-f);if(!function(e,i,o,a,s,l,u){for(var d=0,c=0;s<=l;s++){if(o.value-o.value>a)return!1;n(6,d,c,e,o);var h=t.l;if(d=t.c,c=t.lc,u[s]=h,63==h){if(o.value-o.value>a)throw"Something wrong with hufUnpackEncTable";n(8,d,c,e,o);var f=t.l+6;if(d=t.c,c=t.lc,s+f>l+1)throw"Something wrong with hufUnpackEncTable";for(;f--;)u[s++]=0;s--}else if(h>=59){var f=h-59+2;if(s+f>l+1)throw"Something wrong with hufUnpackEncTable";for(;f--;)u[s++]=0;s--}}!function(e){for(var t=0;t<=58;++t)r[t]=0;for(var t=0;t<65537;++t)r[e[t]]+=1;for(var n=0,t=58;t>0;--t){var i=n+r[t]>>1;r[t]=n,n=i}for(var t=0;t<65537;++t){var o=e[t];o>0&&(e[t]=o|r[o]++<<6)}}(u)}(e,0,u,w,m,p,v),g>8*(d-(u.value-f)))throw"Something wrong with hufUncompress";!function(e,t,n,r){for(;t<=n;t++){var i=e[t]>>6,o=63&e[t];if(i>>o)throw"Invalid table entry";if(o>14){var a=r[i>>o-14];if(a.len)throw"Invalid table entry";if(a.lit++,a.p){var s=a.p;a.p=Array(a.lit);for(var l=0;l<a.lit-1;++l)a.p[l]=s[l]}else a.p=[,];a.p[a.lit-1]=t}else if(o)for(var u=0,l=1<<14-o;l>0;l--){var a=r[(i<<14-o)+u];if(a.len||a.p)throw"Invalid table entry";a.len=o,a.lit=t,u++}}}(v,m,p,y),function(e,t,n,r,l,u,d,c,h,f){for(var m=0,p=0,g=Math.trunc(l.value+(u+7)/8);l.value<g;)for(o(m,p,n,l),m=i.c,p=i.lc;p>=14;){var v=t[m>>p-14&16383];if(v.len)p-=v.len,s(v.lit,d,m,p,n,r,l,h,f,c),m=a.c,p=a.lc;else{if(!v.p)throw"hufDecode issues";for(y=0;y<v.lit;y++){for(var y,x=63&e[v.p[y]];p<x&&l.value<g;)o(m,p,n,l),m=i.c,p=i.lc;if(p>=x&&e[v.p[y]]>>6==(m>>p-x&(1<<x)-1)){p-=x,s(v.p[y],d,m,p,n,r,l,h,f,c),m=a.c,p=a.lc;break}}if(y==v.lit)throw"hufDecode issues"}}var w=8-u&7;for(m>>=w,p-=w;p>0;){var v=t[m<<14-p&16383];if(v.len)p-=v.len,s(v.lit,d,m,p,n,r,l,h,f,c),m=a.c,p=a.lc;else throw"hufDecode issues"}}(v,y,e,l,u,g,p,h,c,{value:0})}function f(e){for(var t=1;t<e.length;t++){var n=e[t-1]+e[t]-128;e[t]=n}}function m(e,t){for(var n=0,r=Math.floor((e.length+1)/2),i=0,o=e.length-1;!(i>o)&&(t[i++]=e[n++],!(i>o));){;t[i++]=e[r++]}}function p(e){for(var t=e.byteLength,n=[],r=0,i=new DataView(e);t>0;){var o=i.getInt8(r++);if(o<0){var a=-o;t-=a+1;for(var s=0;s<a;s++)n.push(i.getUint8(r++))}else{var a=o;t-=2;for(var l=i.getUint8(r++),s=0;s<a+1;s++)n.push(l)}}return n}function g(e){return new DataView(e.array.buffer,e.offset.value,e.size)}function v(e){var t=new Uint8Array(p(e.viewer.buffer.slice(e.offset.value,e.offset.value+e.size))),n=new Uint8Array(t.length);return f(t),m(t,n),new DataView(n.buffer)}function y(e){var t=eK(e.array.slice(e.offset.value,e.offset.value+e.size)),n=new Uint8Array(t.length);return f(t),m(t,n),new DataView(n.buffer)}function x(e){for(var t=e.viewer,n={value:e.offset.value},r=new Uint16Array(e.width*e.scanlineBlockSize*(e.channels*e.type)),i=new Uint8Array(8192),o=0,a=Array(e.channels),s=0;s<e.channels;s++)a[s]={},a[s].start=o,a[s].end=a[s].start,a[s].nx=e.width,a[s].ny=e.lines,a[s].size=e.type,o+=a[s].nx*a[s].ny*a[s].size;var l=R(t,n),f=R(t,n);if(f>=8192)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(l<=f)for(var s=0;s<f-l+1;s++)i[s+l]=j(t,n);var m=new Uint16Array(65536),p=function(e,t){for(var n=0,r=0;r<65536;++r)(0==r||e[r>>3]&1<<(7&r))&&(t[n++]=r);for(var i=n-1;n<65536;)t[n++]=0;return i}(i,m),g=b(t,n);h(e.array,t,n,g,r,o);for(var s=0;s<e.channels;++s)for(var v=a[s],y=0;y<a[s].size;++y)!function(e,t,n,r,i,o,a){for(var s=a<16384,l=n>i?i:n,h=1;h<=l;)h<<=1;for(h>>=1,f=h,h>>=1;h>=1;){for(var f,m,p,g,v,y=0,x=0+o*(i-f),w=o*h,_=o*f,A=r*h,S=r*f;y<=x;y+=_){for(var b=y,M=y+r*(n-f);b<=M;b+=S){var E=b+A,j=b+w,C=j+A;s?(d(e[b+t],e[j+t]),m=u.a,g=u.b,d(e[E+t],e[C+t]),p=u.a,v=u.b,d(m,p),e[b+t]=u.a,e[E+t]=u.b,d(g,v)):(c(e[b+t],e[j+t]),m=u.a,g=u.b,c(e[E+t],e[C+t]),p=u.a,v=u.b,c(m,p),e[b+t]=u.a,e[E+t]=u.b,c(g,v)),e[j+t]=u.a,e[C+t]=u.b}if(n&h){var j=b+w;s?d(e[b+t],e[j+t]):c(e[b+t],e[j+t]),m=u.a,e[j+t]=u.b,e[b+t]=m}}if(i&h)for(var b=y,M=y+r*(n-f);b<=M;b+=S){var E=b+A;s?d(e[b+t],e[E+t]):c(e[b+t],e[E+t]),m=u.a,e[E+t]=u.b,e[b+t]=m}f=h,h>>=1}}(r,v.start+y,v.nx,v.size,v.ny,v.nx*v.size,p);for(var x=o,w=0;w<x;++w)r[w]=m[r[w]];for(var _=0,A=new Uint8Array(r.buffer.byteLength),S=0;S<e.lines;S++)for(var M=0;M<e.channels;M++){var v=a[M],E=v.nx*v.size,C=new Uint8Array(r.buffer,2*v.end,2*E);A.set(C,_),_+=2*E,v.end+=E}return new DataView(A.buffer)}function w(e){var t=eK(e.array.slice(e.offset.value,e.offset.value+e.size));let n=e.lines*e.channels*e.width,r=1==e.type?new Uint16Array(n):new Uint32Array(n),i=0,o=0,a=[,,,,];for(let n=0;n<e.lines;n++)for(let n=0;n<e.channels;n++){let n=0;switch(e.type){case 1:a[0]=i,a[1]=a[0]+e.width,i=a[1]+e.width;for(let i=0;i<e.width;++i)n+=t[a[0]++]<<8|t[a[1]++],r[o]=n,o++;break;case 2:a[0]=i,a[1]=a[0]+e.width,a[2]=a[1]+e.width,i=a[2]+e.width;for(let i=0;i<e.width;++i)n+=t[a[0]++]<<24|t[a[1]++]<<16|t[a[2]++]<<8,r[o]=n,o++}}return new DataView(r.buffer)}function _(e){var t=e.viewer,n={value:e.offset.value},r=new Uint8Array(e.width*e.lines*(e.channels*e.type*2)),i={version:C(t,n),unknownUncompressedSize:C(t,n),unknownCompressedSize:C(t,n),acCompressedSize:C(t,n),dcCompressedSize:C(t,n),rleCompressedSize:C(t,n),rleUncompressedSize:C(t,n),rleRawSize:C(t,n),totalAcUncompressedCount:C(t,n),totalDcUncompressedCount:C(t,n),acCompression:C(t,n)};if(i.version<2)throw"EXRLoader.parse: "+U.compression+" version "+i.version+" is unsupported";for(var o=[],a=R(t,n)-2;a>0;){var s=A(t.buffer,n),l=j(t,n),u=l>>2&3,d=new Int8Array([(l>>4)-1])[0],c=j(t,n);o.push({name:s,index:d,type:c,compression:u}),a-=s.length+3}for(var f=U.channels,m=Array(e.channels),g=0;g<e.channels;++g){var v=m[g]={},x=f[g];v.name=x.name,v.compression=0,v.decoded=!1,v.type=x.pixelType,v.pLinear=x.pLinear,v.width=e.width,v.height=e.lines}for(var w={idx:[,,,]},_=0;_<e.channels;++_)for(var v=m[_],g=0;g<o.length;++g){var S=o[g];v.name==S.name&&(v.compression=S.compression,S.index>=0&&(w.idx[S.index]=_),v.offset=_)}if(i.acCompressedSize>0)switch(i.acCompression){case 0:var b=new Uint16Array(i.totalAcUncompressedCount);h(e.array,t,n,i.acCompressedSize,b,i.totalAcUncompressedCount);break;case 1:var M=e.array.slice(n.value,n.value+i.totalAcUncompressedCount),T=eK(M),b=new Uint16Array(T.buffer);n.value+=i.totalAcUncompressedCount}if(i.dcCompressedSize>0){var N=new Uint16Array(y({array:e.array,offset:n,size:i.dcCompressedSize}).buffer);n.value+=i.dcCompressedSize}if(i.rleRawSize>0){var M=e.array.slice(n.value,n.value+i.rleCompressedSize),T=eK(M),F=p(T.buffer);n.value+=i.rleCompressedSize}for(var z=0,L=Array(m.length),g=0;g<L.length;++g)L[g]=[];for(var G=0;G<e.lines;++G)for(var I=0;I<m.length;++I)L[I].push(z),z+=m[I].width*e.type*2;!function(e,t,n,r,i,o){var a=new DataView(o.buffer),s=n[e.idx[0]].width,l=n[e.idx[0]].height,u=Math.floor(s/8),d=Math.ceil(s/8),c=Math.ceil(l/8),h=s-(d-1)*8,f=l-(c-1)*8,m={value:0},p=[,,,],g=[,,,],v=[,,,],y=[,,,],x=[,,,];for(let n=0;n<3;++n)x[n]=t[e.idx[n]],p[n]=n<1?0:p[n-1]+d*c,g[n]=new Float32Array(64),v[n]=new Uint16Array(64),y[n]=new Uint16Array(64*d);for(let t=0;t<c;++t){var w,_,A=8;t==c-1&&(A=f);var S=8;for(let e=0;e<d;++e){e==d-1&&(S=h);for(let e=0;e<3;++e){v[e].fill(0),v[e][0]=i[p[e]++],function(e,t,n){for(var r,i=1;i<64;)65280==(r=t[e.value])?i=64:r>>8==255?i+=255&r:(n[i]=r,i++),e.value++}(m,r,v[e]),w=v[e],(_=g[e])[0]=k(w[0]),_[1]=k(w[1]),_[2]=k(w[5]),_[3]=k(w[6]),_[4]=k(w[14]),_[5]=k(w[15]),_[6]=k(w[27]),_[7]=k(w[28]),_[8]=k(w[2]),_[9]=k(w[4]),_[10]=k(w[7]),_[11]=k(w[13]),_[12]=k(w[16]),_[13]=k(w[26]),_[14]=k(w[29]),_[15]=k(w[42]),_[16]=k(w[3]),_[17]=k(w[8]),_[18]=k(w[12]),_[19]=k(w[17]),_[20]=k(w[25]),_[21]=k(w[30]),_[22]=k(w[41]),_[23]=k(w[43]),_[24]=k(w[9]),_[25]=k(w[11]),_[26]=k(w[18]),_[27]=k(w[24]),_[28]=k(w[31]),_[29]=k(w[40]),_[30]=k(w[44]),_[31]=k(w[53]),_[32]=k(w[10]),_[33]=k(w[19]),_[34]=k(w[23]),_[35]=k(w[32]),_[36]=k(w[39]),_[37]=k(w[45]),_[38]=k(w[52]),_[39]=k(w[54]),_[40]=k(w[20]),_[41]=k(w[22]),_[42]=k(w[33]),_[43]=k(w[38]),_[44]=k(w[46]),_[45]=k(w[51]),_[46]=k(w[55]),_[47]=k(w[60]),_[48]=k(w[21]),_[49]=k(w[34]),_[50]=k(w[37]),_[51]=k(w[47]),_[52]=k(w[50]),_[53]=k(w[56]),_[54]=k(w[59]),_[55]=k(w[61]),_[56]=k(w[35]),_[57]=k(w[36]),_[58]=k(w[48]),_[59]=k(w[49]),_[60]=k(w[57]),_[61]=k(w[58]),_[62]=k(w[62]),_[63]=k(w[63]),function(e){let t=.5*Math.cos(3.14159/16),n=.5*Math.cos(3.14159/8),r=.5*Math.cos(3*3.14159/16),i=.5*Math.cos(3*3.14159/8);for(var o=[,,,,],a=[,,,,],s=[,,,,],l=[,,,,],u=0;u<8;++u){var d=8*u;o[0]=n*e[d+2],o[1]=i*e[d+2],o[2]=n*e[d+6],o[3]=i*e[d+6],a[0]=t*e[d+1]+r*e[d+3]+.2777854612564676*e[d+5]+.09754573032714427*e[d+7],a[1]=r*e[d+1]-.09754573032714427*e[d+3]-t*e[d+5]-.2777854612564676*e[d+7],a[2]=.2777854612564676*e[d+1]-t*e[d+3]+.09754573032714427*e[d+5]+r*e[d+7],a[3]=.09754573032714427*e[d+1]-.2777854612564676*e[d+3]+r*e[d+5]-t*e[d+7],s[0]=.35355362513961314*(e[d+0]+e[d+4]),s[3]=.35355362513961314*(e[d+0]-e[d+4]),s[1]=o[0]+o[3],s[2]=o[1]-o[2],l[0]=s[0]+s[1],l[1]=s[3]+s[2],l[2]=s[3]-s[2],l[3]=s[0]-s[1],e[d+0]=l[0]+a[0],e[d+1]=l[1]+a[1],e[d+2]=l[2]+a[2],e[d+3]=l[3]+a[3],e[d+4]=l[3]-a[3],e[d+5]=l[2]-a[2],e[d+6]=l[1]-a[1],e[d+7]=l[0]-a[0]}for(var c=0;c<8;++c)o[0]=n*e[16+c],o[1]=i*e[16+c],o[2]=n*e[48+c],o[3]=i*e[48+c],a[0]=t*e[8+c]+r*e[24+c]+.2777854612564676*e[40+c]+.09754573032714427*e[56+c],a[1]=r*e[8+c]-.09754573032714427*e[24+c]-t*e[40+c]-.2777854612564676*e[56+c],a[2]=.2777854612564676*e[8+c]-t*e[24+c]+.09754573032714427*e[40+c]+r*e[56+c],a[3]=.09754573032714427*e[8+c]-.2777854612564676*e[24+c]+r*e[40+c]-t*e[56+c],s[0]=.35355362513961314*(e[c]+e[32+c]),s[3]=.35355362513961314*(e[c]-e[32+c]),s[1]=o[0]+o[3],s[2]=o[1]-o[2],l[0]=s[0]+s[1],l[1]=s[3]+s[2],l[2]=s[3]-s[2],l[3]=s[0]-s[1],e[0+c]=l[0]+a[0],e[8+c]=l[1]+a[1],e[16+c]=l[2]+a[2],e[24+c]=l[3]+a[3],e[32+c]=l[3]-a[3],e[40+c]=l[2]-a[2],e[48+c]=l[1]-a[1],e[56+c]=l[0]-a[0]}(g[e])}for(var b=g,M=0;M<64;++M){var j=b[0][M],C=b[1][M],T=b[2][M];b[0][M]=j+1.5747*T,b[1][M]=j-.1873*C-.4682*T,b[2][M]=j+1.8556*C}for(let t=0;t<3;++t)!function(e,t,n){for(var r,i=0;i<64;++i){t[n+i]=E.DataUtils.toHalfFloat((r=e[i])<=1?Math.sign(r)*Math.pow(Math.abs(r),2.2):Math.sign(r)*Math.pow(9.025013291561939,Math.abs(r)-1))}}(g[t],y[t],64*e)}let o=0;for(let r=0;r<3;++r){let i=n[e.idx[r]].type;for(let e=8*t;e<8*t+A;++e){o=x[r][e];for(let t=0;t<u;++t){let n=64*t+(7&e)*8;a.setUint16(o+0*i,y[r][n+0],!0),a.setUint16(o+2*i,y[r][n+1],!0),a.setUint16(o+4*i,y[r][n+2],!0),a.setUint16(o+6*i,y[r][n+3],!0),a.setUint16(o+8*i,y[r][n+4],!0),a.setUint16(o+10*i,y[r][n+5],!0),a.setUint16(o+12*i,y[r][n+6],!0),a.setUint16(o+14*i,y[r][n+7],!0),o+=16*i}}if(u!=d)for(let e=8*t;e<8*t+A;++e){let t=x[r][e]+8*u*2*i,n=64*u+(7&e)*8;for(let e=0;e<S;++e)a.setUint16(t+2*e*i,y[r][n+e],!0)}}}for(var N=new Uint16Array(s),a=new DataView(o.buffer),R=0;R<3;++R){n[e.idx[R]].decoded=!0;var F=n[e.idx[R]].type;if(2==n[R].type)for(var z=0;z<l;++z){let e=x[R][z];for(var L=0;L<s;++L)N[L]=a.getUint16(e+2*L*F,!0);for(var L=0;L<s;++L)a.setFloat32(e+2*L*F,k(N[L]),!0)}}}(w,L,m,b,N,r);for(var g=0;g<m.length;++g){var v=m[g];if(!v.decoded)if(2===v.compression)for(var O=0,P=0,G=0;G<e.lines;++G){for(var B=L[g][O],D=0;D<v.width;++D){for(var W=0;W<2*v.type;++W)r[B++]=F[P+W*v.width*v.height];P++}O++}else throw"EXRLoader.parse: unsupported channel compression"}return new DataView(r.buffer)}function A(e,t){for(var n=new Uint8Array(e),r=0;0!=n[t.value+r];)r+=1;var i=new TextDecoder().decode(n.slice(t.value,t.value+r));return t.value=t.value+r+1,i}function S(e,t){var n=e.getInt32(t.value,!0);return t.value=t.value+4,n}function b(e,t){var n=e.getUint32(t.value,!0);return t.value=t.value+4,n}function M(e,t){var n=e[t.value];return t.value=t.value+1,n}function j(e,t){var n=e.getUint8(t.value);return t.value=t.value+1,n}let C=function(e,t){let n;return n="getBigInt64"in DataView.prototype?Number(e.getBigInt64(t.value,!0)):e.getUint32(t.value+4,!0)+Number(e.getUint32(t.value,!0)<<32),t.value+=8,n};function T(e,t){var n=e.getFloat32(t.value,!0);return t.value+=4,n}function N(e,t){return E.DataUtils.toHalfFloat(T(e,t))}function k(e){var t=(31744&e)>>10,n=1023&e;return(e>>15?-1:1)*(t?31===t?n?NaN:1/0:Math.pow(2,t-15)*(1+n/1024):n/1024*6103515625e-14)}function R(e,t){var n=e.getUint16(t.value,!0);return t.value+=2,n}function F(e,t){return k(R(e,t))}let z=new DataView(e),L=new Uint8Array(e),G={value:0},U=function(e,t,n){let r={};if(0x1312f76!=e.getUint32(0,!0))throw"THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.";r.version=e.getUint8(4);let i=e.getUint8(5);r.spec={singleTile:!!(2&i),longName:!!(4&i),deepFormat:!!(8&i),multiPart:!!(16&i)},n.value=8;for(var o=!0;o;){var a=A(t,n);if(0==a)o=!1;else{var s=A(t,n),l=b(e,n),u=function(e,t,n,r,i){var o,a,s,l,u,d,c;if("string"===r||"stringvector"===r||"iccProfile"===r)return o=new TextDecoder().decode(new Uint8Array(t).slice(n.value,n.value+i)),n.value=n.value+i,o;if("chlist"===r)return function(e,t,n,r){for(var i=n.value,o=[];n.value<i+r-1;){var a=A(t,n),s=S(e,n),l=j(e,n);n.value+=3;var u=S(e,n),d=S(e,n);o.push({name:a,pixelType:s,pLinear:l,xSampling:u,ySampling:d})}return n.value+=1,o}(e,t,n,i);if("chromaticities"===r)return a=T(e,n),s=T(e,n),l=T(e,n),u=T(e,n),d=T(e,n),{redX:a,redY:s,greenX:l,greenY:u,blueX:d,blueY:T(e,n),whiteX:T(e,n),whiteY:T(e,n)};if("compression"===r)return["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"][j(e,n)];if("box2i"===r)return c=b(e,n),{xMin:c,yMin:b(e,n),xMax:b(e,n),yMax:b(e,n)};else if("lineOrder"===r)return["INCREASING_Y"][j(e,n)];else if("float"===r)return T(e,n);else if("v2f"===r)return[T(e,n),T(e,n)];else if("v3f"===r)return[T(e,n),T(e,n),T(e,n)];else if("int"===r)return S(e,n);else if("rational"===r)return[S(e,n),b(e,n)];else if("timecode"===r)return[b(e,n),b(e,n)];else return"preview"===r?(n.value+=i,"skipped"):(n.value+=i,void 0)}(e,t,n,s,l);void 0===u?console.warn("EXRLoader.parse: skipped unknown header attribute type '".concat(s,"'.")):r[a]=u}}if((-5&i)!=0)throw console.error("EXRHeader:",r),"THREE.EXRLoader: provided file is currently unsupported.";return r}(z,e,G),I=function(e,t,n,r,i){let o={size:0,viewer:t,array:n,offset:r,width:e.dataWindow.xMax-e.dataWindow.xMin+1,height:e.dataWindow.yMax-e.dataWindow.yMin+1,channels:e.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:e.channels[0].pixelType,uncompress:null,getter:null,format:null,[tu?"colorSpace":"encoding"]:null};switch(e.compression){case"NO_COMPRESSION":o.lines=1,o.uncompress=g;break;case"RLE_COMPRESSION":o.lines=1,o.uncompress=v;break;case"ZIPS_COMPRESSION":o.lines=1,o.uncompress=y;break;case"ZIP_COMPRESSION":o.lines=16,o.uncompress=y;break;case"PIZ_COMPRESSION":o.lines=32,o.uncompress=x;break;case"PXR24_COMPRESSION":o.lines=16,o.uncompress=w;break;case"DWAA_COMPRESSION":o.lines=32,o.uncompress=_;break;case"DWAB_COMPRESSION":o.lines=256,o.uncompress=_;break;default:throw"EXRLoader.parse: "+e.compression+" is unsupported"}if(o.scanlineBlockSize=o.lines,1==o.type)switch(i){case E.FloatType:o.getter=F,o.inputSize=2;break;case E.HalfFloatType:o.getter=R,o.inputSize=2}else if(2==o.type)switch(i){case E.FloatType:o.getter=T,o.inputSize=4;break;case E.HalfFloatType:o.getter=N,o.inputSize=4}else throw"EXRLoader.parse: unsupported pixelType "+o.type+" for "+e.compression+".";o.blockCount=(e.dataWindow.yMax+1)/o.scanlineBlockSize;for(var a=0;a<o.blockCount;a++)C(t,r);o.outputChannels=3==o.channels?4:o.channels;let s=o.width*o.height*o.outputChannels;switch(i){case E.FloatType:o.byteArray=new Float32Array(s),o.channels<o.outputChannels&&o.byteArray.fill(1,0,s);break;case E.HalfFloatType:o.byteArray=new Uint16Array(s),o.channels<o.outputChannels&&o.byteArray.fill(15360,0,s);break;default:console.error("THREE.EXRLoader: unsupported type: ",i)}return o.bytesPerLine=o.width*o.inputSize*o.channels,4==o.outputChannels?o.format=E.RGBAFormat:o.format=E.RedFormat,tu?o.colorSpace="srgb-linear":o.encoding=3e3,o}(U,z,L,G,this.type),O={value:0},P={R:0,G:1,B:2,A:3,Y:0};for(let e=0;e<I.height/I.scanlineBlockSize;e++){let t=b(z,G);I.size=b(z,G),I.lines=t+I.scanlineBlockSize>I.height?I.height-t:I.scanlineBlockSize;let n=I.size<I.lines*I.bytesPerLine?I.uncompress(I):g(I);G.value+=I.size;for(let t=0;t<I.scanlineBlockSize;t++){let r=t+e*I.scanlineBlockSize;if(r>=I.height)break;for(let e=0;e<I.channels;e++){let i=P[U.channels[e].name];for(let o=0;o<I.width;o++){O.value=(t*(I.channels*I.width)+e*I.width+o)*I.inputSize;let a=(I.height-1-r)*(I.width*I.outputChannels)+o*I.outputChannels+i;I.byteArray[a]=I.getter(n,O)}}}}return{header:U,width:I.width,height:I.height,data:I.byteArray,format:I.format,[tu?"colorSpace":"encoding"]:I[tu?"colorSpace":"encoding"],type:this.type}}setDataType(e){return this.type=e,this}load(e,t,n,r){return super.load(e,function(e,n){tu?e.colorSpace=n.colorSpace:e.encoding=n.encoding,e.minFilter=E.LinearFilter,e.magFilter=E.LinearFilter,e.generateMipmaps=!1,e.flipY=!1,t&&t(e,n)},n,r)}constructor(e){super(e),this.type=E.HalfFloatType}}var tc=e.i(92808),th=e.i(8560);let tf=(e,t,n)=>{let r;switch(e){case x.UnsignedByteType:r=new Uint8ClampedArray(t*n*4);break;case x.HalfFloatType:r=new Uint16Array(t*n*4);break;case x.UnsignedIntType:r=new Uint32Array(t*n*4);break;case x.ByteType:r=new Int8Array(t*n*4);break;case x.ShortType:r=new Int16Array(t*n*4);break;case x.IntType:r=new Int32Array(t*n*4);break;case x.FloatType:r=new Float32Array(t*n*4);break;default:throw Error("Unsupported data type")}return r};class tm{static instantiateRenderer(){let e=new th.WebGLRenderer;return e.setSize(128,128),e}toArray(){if(!this._supportsReadPixels)throw Error("Can't read pixels in this browser");let e=tf(this._type,this._width,this._height);return this._renderer.readRenderTargetPixels(this._renderTarget,0,0,this._width,this._height,e),e}toDataTexture(e){let t=new x.DataTexture(this.toArray(),this.width,this.height,x.RGBAFormat,this._type,(null==e?void 0:e.mapping)||x.UVMapping,(null==e?void 0:e.wrapS)||x.ClampToEdgeWrapping,(null==e?void 0:e.wrapT)||x.ClampToEdgeWrapping,(null==e?void 0:e.magFilter)||x.LinearFilter,(null==e?void 0:e.minFilter)||x.LinearFilter,(null==e?void 0:e.anisotropy)||1,x.LinearSRGBColorSpace);return t.generateMipmaps=(null==e?void 0:e.generateMipmaps)!==void 0&&(null==e?void 0:e.generateMipmaps),t}disposeOnDemandRenderer(){this._renderer.setRenderTarget(null),this._rendererIsDisposable&&(this._renderer.dispose(),this._renderer.forceContextLoss())}dispose(e){this.disposeOnDemandRenderer(),e&&this.renderTarget.dispose(),this.material instanceof x.ShaderMaterial&&Object.values(this.material.uniforms).forEach(e=>{e.value instanceof x.Texture&&e.value.dispose()}),Object.values(this.material).forEach(e=>{e instanceof x.Texture&&e.dispose()}),this.material.dispose(),this._quad.geometry.dispose()}get width(){return this._width}set width(e){this._width=e,this._renderTarget.setSize(this._width,this._height)}get height(){return this._height}set height(e){this._height=e,this._renderTarget.setSize(this._width,this._height)}get renderer(){return this._renderer}get renderTarget(){return this._renderTarget}set renderTarget(e){this._renderTarget=e,this._width=e.width,this._height=e.height}get material(){return this._material}get type(){return this._type}get colorSpace(){return this._colorSpace}constructor(e){var n,r,i,o,a,s,l,u,d,c,h,f,m,p,g,v;this._rendererIsDisposable=!1,this._supportsReadPixels=!0,this.render=()=>{this._renderer.setRenderTarget(this._renderTarget);try{this._renderer.render(this._scene,this._camera)}catch(e){throw this._renderer.setRenderTarget(null),e}this._renderer.setRenderTarget(null)},this._width=e.width,this._height=e.height,this._type=e.type,this._colorSpace=e.colorSpace;const y={format:x.RGBAFormat,depthBuffer:!1,stencilBuffer:!1,type:this._type,colorSpace:this._colorSpace,anisotropy:(null==(n=e.renderTargetOptions)?void 0:n.anisotropy)!==void 0?null==(r=e.renderTargetOptions)?void 0:r.anisotropy:1,generateMipmaps:(null==(i=e.renderTargetOptions)?void 0:i.generateMipmaps)!==void 0&&(null==(o=e.renderTargetOptions)?void 0:o.generateMipmaps),magFilter:(null==(a=e.renderTargetOptions)?void 0:a.magFilter)!==void 0?null==(s=e.renderTargetOptions)?void 0:s.magFilter:x.LinearFilter,minFilter:(null==(l=e.renderTargetOptions)?void 0:l.minFilter)!==void 0?null==(u=e.renderTargetOptions)?void 0:u.minFilter:x.LinearFilter,samples:(null==(d=e.renderTargetOptions)?void 0:d.samples)!==void 0?null==(c=e.renderTargetOptions)?void 0:c.samples:void 0,wrapS:(null==(h=e.renderTargetOptions)?void 0:h.wrapS)!==void 0?null==(f=e.renderTargetOptions)?void 0:f.wrapS:x.ClampToEdgeWrapping,wrapT:(null==(m=e.renderTargetOptions)?void 0:m.wrapT)!==void 0?null==(p=e.renderTargetOptions)?void 0:p.wrapT:x.ClampToEdgeWrapping};if(this._material=e.material,e.renderer?this._renderer=e.renderer:(this._renderer=tm.instantiateRenderer(),this._rendererIsDisposable=!0),this._scene=new x.Scene,this._camera=new x.OrthographicCamera,this._camera.position.set(0,0,10),this._camera.left=-.5,this._camera.right=.5,this._camera.top=.5,this._camera.bottom=-.5,this._camera.updateProjectionMatrix(),!((e,n,r,i)=>{if(void 0!==t)return t;let o=new x.WebGLRenderTarget(1,1,i);n.setRenderTarget(o);let a=new x.Mesh(new x.PlaneGeometry,new x.MeshBasicMaterial({color:0xffffff}));n.render(a,r),n.setRenderTarget(null);let s=tf(e,o.width,o.height);return n.readRenderTargetPixels(o,0,0,o.width,o.height,s),o.dispose(),a.geometry.dispose(),a.material.dispose(),t=0!==s[0]})(this._type,this._renderer,this._camera,y)){let e;this._type===x.HalfFloatType&&(e=this._renderer.extensions.has("EXT_color_buffer_float")?x.FloatType:void 0),void 0!==e?(console.warn("This browser does not support reading pixels from ".concat(this._type," RenderTargets, switching to ").concat(x.FloatType)),this._type=e):(this._supportsReadPixels=!1,console.warn("This browser dos not support toArray or toDataTexture, calls to those methods will result in an error thrown"))}this._quad=new x.Mesh(new x.PlaneGeometry,this._material),this._quad.geometry.computeBoundingBox(),this._scene.add(this._quad),this._renderTarget=new x.WebGLRenderTarget(this.width,this.height,y),this._renderTarget.texture.mapping=(null==(g=e.renderTargetOptions)?void 0:g.mapping)!==void 0?null==(v=e.renderTargetOptions)?void 0:v.mapping:x.UVMapping}}var tp=x;class tg extends tp.ShaderMaterial{get sdr(){return this.uniforms.sdr.value}set sdr(e){this.uniforms.sdr.value=e}get gainMap(){return this.uniforms.gainMap.value}set gainMap(e){this.uniforms.gainMap.value=e}get offsetHdr(){return this.uniforms.offsetHdr.value.toArray()}set offsetHdr(e){this.uniforms.offsetHdr.value.fromArray(e)}get offsetSdr(){return this.uniforms.offsetSdr.value.toArray()}set offsetSdr(e){this.uniforms.offsetSdr.value.fromArray(e)}get gainMapMin(){return this.uniforms.gainMapMin.value.toArray()}set gainMapMin(e){this.uniforms.gainMapMin.value.fromArray(e)}get gainMapMax(){return this.uniforms.gainMapMax.value.toArray()}set gainMapMax(e){this.uniforms.gainMapMax.value.fromArray(e)}get gamma(){let e=this.uniforms.gamma.value;return[1/e.x,1/e.y,1/e.z]}set gamma(e){let t=this.uniforms.gamma.value;t.x=1/e[0],t.y=1/e[1],t.z=1/e[2]}get hdrCapacityMin(){return this._hdrCapacityMin}set hdrCapacityMin(e){this._hdrCapacityMin=e,this.calculateWeight()}get hdrCapacityMax(){return this._hdrCapacityMax}set hdrCapacityMax(e){this._hdrCapacityMax=e,this.calculateWeight()}get maxDisplayBoost(){return this._maxDisplayBoost}set maxDisplayBoost(e){this._maxDisplayBoost=Math.max(1,Math.min(65504,e)),this.calculateWeight()}calculateWeight(){let e=(Math.log2(this._maxDisplayBoost)-this._hdrCapacityMin)/(this._hdrCapacityMax-this._hdrCapacityMin);this.uniforms.weightFactor.value=Math.max(0,Math.min(1,e))}constructor({gamma:e,offsetHdr:t,offsetSdr:n,gainMapMin:r,gainMapMax:i,maxDisplayBoost:o,hdrCapacityMin:a,hdrCapacityMax:s,sdr:l,gainMap:u}){super({name:"GainMapDecoderMaterial",vertexShader:"\nvarying vec2 vUv;\n\nvoid main() {\n  vUv = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n",fragmentShader:"\n// min half float value\n#define HALF_FLOAT_MIN vec3( -65504, -65504, -65504 )\n// max half float value\n#define HALF_FLOAT_MAX vec3( 65504, 65504, 65504 )\n\nuniform sampler2D sdr;\nuniform sampler2D gainMap;\nuniform vec3 gamma;\nuniform vec3 offsetHdr;\nuniform vec3 offsetSdr;\nuniform vec3 gainMapMin;\nuniform vec3 gainMapMax;\nuniform float weightFactor;\n\nvarying vec2 vUv;\n\nvoid main() {\n  vec3 rgb = texture2D( sdr, vUv ).rgb;\n  vec3 recovery = texture2D( gainMap, vUv ).rgb;\n  vec3 logRecovery = pow( recovery, gamma );\n  vec3 logBoost = gainMapMin * ( 1.0 - logRecovery ) + gainMapMax * logRecovery;\n  vec3 hdrColor = (rgb + offsetSdr) * exp2( logBoost * weightFactor ) - offsetHdr;\n  vec3 clampedHdrColor = max( HALF_FLOAT_MIN, min( HALF_FLOAT_MAX, hdrColor ));\n  gl_FragColor = vec4( clampedHdrColor , 1.0 );\n}\n",uniforms:{sdr:{value:l},gainMap:{value:u},gamma:{value:new tp.Vector3(1/e[0],1/e[1],1/e[2])},offsetHdr:{value:new tp.Vector3().fromArray(t)},offsetSdr:{value:new tp.Vector3().fromArray(n)},gainMapMin:{value:new tp.Vector3().fromArray(r)},gainMapMax:{value:new tp.Vector3().fromArray(i)},weightFactor:{value:(Math.log2(o)-a)/(s-a)}},blending:tp.NoBlending,depthTest:!1,depthWrite:!1}),this._maxDisplayBoost=o,this._hdrCapacityMin=a,this._hdrCapacityMax=s,this.needsUpdate=!0,this.uniformsNeedUpdate=!0}}class tv extends Error{}class ty extends Error{}let tx=(e,t,n)=>{let r=RegExp("".concat(t,'="([^"]*)"'),"i").exec(e);if(r)return r[1];let i=RegExp("<".concat(t,"[^>]*>([\\s\\S]*?)</").concat(t,">"),"i").exec(e);if(i){let e=i[1].match(/<rdf:li>([^<]*)<\/rdf:li>/g);return e&&3===e.length?e.map(e=>e.replace(/<\/?rdf:li>/g,"")):i[1].trim()}if(void 0!==n)return n;throw Error("Can't find ".concat(t," in gainmap metadata"))};class tw{extract(e){return new Promise((t,n)=>{let r,i=this.options.debug,o=new DataView(e.buffer);if(65496!==o.getUint16(0))return void n(Error("Not a valid jpeg"));let a=o.byteLength,s=2,l=0;for(;s<a;){if(++l>250)return void n(Error("Found no marker after ".concat(l," loops ")));if(255!==o.getUint8(s))return void n(Error("Not a valid marker at offset 0x".concat(s.toString(16),", found: 0x").concat(o.getUint8(s).toString(16))));if(r=o.getUint8(s+1),i&&console.log("Marker: ".concat(r.toString(16))),226===r){i&&console.log("Found APP2 marker (0xffe2)");let e=s+4;if(0x4d504600===o.getUint32(e)){let r,i=e+4;if(18761===o.getUint16(i))r=!1;else{if(19789!==o.getUint16(i))return void n(Error("No valid endianness marker found in TIFF header"));r=!0}if(42!==o.getUint16(i+2,!r))return void n(Error("Not valid TIFF data! (no 0x002A marker)"));let a=o.getUint32(i+4,!r);if(a<8)return void n(Error("Not valid TIFF data! (First offset less than 8)"));let s=i+a,l=o.getUint16(s,!r),u=s+2,d=0;for(let e=u;e<u+12*l;e+=12)45057===o.getUint16(e,!r)&&(d=o.getUint32(e+8,!r));let c=s+2+12*l+4,h=[];for(let e=c;e<c+16*d;e+=16){let t={MPType:o.getUint32(e,!r),size:o.getUint32(e+4,!r),dataOffset:o.getUint32(e+8,!r),dependantImages:o.getUint32(e+12,!r),start:-1,end:-1,isFII:!1};t.dataOffset?(t.start=i+t.dataOffset,t.isFII=!1):(t.start=0,t.isFII=!0),t.end=t.start+t.size,h.push(t)}if(this.options.extractNonFII&&h.length){let e=new Blob([o]),n=[];for(let t of h){if(t.isFII&&!this.options.extractFII)continue;let r=e.slice(t.start,t.end+1,"image/jpeg");n.push(r)}t(n)}}}s+=2+o.getUint16(s+2)}})}constructor(e){this.options={debug:!!e&&void 0!==e.debug&&e.debug,extractFII:!e||void 0===e.extractFII||e.extractFII,extractNonFII:!e||void 0===e.extractNonFII||e.extractNonFII}}}let t_=async e=>{let t=(e=>{let t,n=(t="undefined"!=typeof TextDecoder?new TextDecoder().decode(e):e.toString()).indexOf("<x:xmpmeta");for(;-1!==n;){let e=t.indexOf("x:xmpmeta>",n),r=t.slice(n,e+10);try{let e=tx(r,"hdrgm:GainMapMin","0"),t=tx(r,"hdrgm:GainMapMax"),n=tx(r,"hdrgm:Gamma","1"),i=tx(r,"hdrgm:OffsetSDR","0.015625"),o=tx(r,"hdrgm:OffsetHDR","0.015625"),a=/hdrgm:HDRCapacityMin="([^"]*)"/.exec(r),s=a?a[1]:"0",l=/hdrgm:HDRCapacityMax="([^"]*)"/.exec(r);if(!l)throw Error("Incomplete gainmap metadata");let u=l[1];return{gainMapMin:Array.isArray(e)?e.map(e=>parseFloat(e)):[parseFloat(e),parseFloat(e),parseFloat(e)],gainMapMax:Array.isArray(t)?t.map(e=>parseFloat(e)):[parseFloat(t),parseFloat(t),parseFloat(t)],gamma:Array.isArray(n)?n.map(e=>parseFloat(e)):[parseFloat(n),parseFloat(n),parseFloat(n)],offsetSdr:Array.isArray(i)?i.map(e=>parseFloat(e)):[parseFloat(i),parseFloat(i),parseFloat(i)],offsetHdr:Array.isArray(o)?o.map(e=>parseFloat(e)):[parseFloat(o),parseFloat(o),parseFloat(o)],hdrCapacityMin:parseFloat(s),hdrCapacityMax:parseFloat(u)}}catch(e){}n=t.indexOf("<x:xmpmeta",e)}})(e);if(!t)throw new ty("Gain map XMP metadata not found");let n=new tw({extractFII:!0,extractNonFII:!0}),r=await n.extract(e);if(2!==r.length)throw new tv("Gain map recovery image not found");return{sdr:new Uint8Array(await r[0].arrayBuffer()),gainMap:new Uint8Array(await r[1].arrayBuffer()),metadata:t}},tA=e=>new Promise((t,n)=>{let r=document.createElement("img");r.onload=()=>{t(r)},r.onerror=e=>{n(e)},r.src=URL.createObjectURL(e)});class tS extends tp.Loader{setRenderer(e){return this._renderer=e,this}setRenderTargetOptions(e){return this._renderTargetOptions=e,this}prepareQuadRenderer(){this._renderer||console.warn("WARNING: An existing WebGL Renderer was not passed to this Loader constructor or in setRenderer, the result of this Loader will need to be converted to a Data Texture with toDataTexture() before you can use it in your renderer.");let e=new tg({gainMapMax:[1,1,1],gainMapMin:[0,0,0],gamma:[1,1,1],offsetHdr:[1,1,1],offsetSdr:[1,1,1],hdrCapacityMax:1,hdrCapacityMin:0,maxDisplayBoost:1,gainMap:new tp.Texture,sdr:new tp.Texture});return new tm({width:16,height:16,type:tp.HalfFloatType,colorSpace:tp.LinearSRGBColorSpace,material:e,renderer:this._renderer,renderTargetOptions:this._renderTargetOptions})}async render(e,t,n,r){let i,o,a=r?new Blob([r],{type:"image/jpeg"}):void 0,s=new Blob([n],{type:"image/jpeg"}),l=!1;if("undefined"==typeof createImageBitmap){let e=await Promise.all([a?tA(a):Promise.resolve(void 0),tA(s)]);o=e[0],i=e[1],l=!0}else{let e=await Promise.all([a?createImageBitmap(a,{imageOrientation:"flipY"}):Promise.resolve(void 0),createImageBitmap(s,{imageOrientation:"flipY"})]);o=e[0],i=e[1]}let u=new tp.Texture(o||new ImageData(2,2),tp.UVMapping,tp.ClampToEdgeWrapping,tp.ClampToEdgeWrapping,tp.LinearFilter,tp.LinearMipMapLinearFilter,tp.RGBAFormat,tp.UnsignedByteType,1,tp.LinearSRGBColorSpace);u.flipY=l,u.needsUpdate=!0;let d=new tp.Texture(i,tp.UVMapping,tp.ClampToEdgeWrapping,tp.ClampToEdgeWrapping,tp.LinearFilter,tp.LinearMipMapLinearFilter,tp.RGBAFormat,tp.UnsignedByteType,1,tp.SRGBColorSpace);d.flipY=l,d.needsUpdate=!0,e.width=i.width,e.height=i.height,e.material.gainMap=u,e.material.sdr=d,e.material.gainMapMin=t.gainMapMin,e.material.gainMapMax=t.gainMapMax,e.material.offsetHdr=t.offsetHdr,e.material.offsetSdr=t.offsetSdr,e.material.gamma=t.gamma,e.material.hdrCapacityMin=t.hdrCapacityMin,e.material.hdrCapacityMax=t.hdrCapacityMax,e.material.maxDisplayBoost=Math.pow(2,t.hdrCapacityMax),e.material.needsUpdate=!0,e.render()}constructor(e,t){super(t),e&&(this._renderer=e),this._internalLoadingManager=new tp.LoadingManager}}class tb extends tS{load(e,t,n,r){let i,o,a,[s,l,u]=e,d=this.prepareQuadRenderer(),c=async()=>{if(i&&o&&a){try{await this.render(d,a,i,o)}catch(e){this.manager.itemError(s),this.manager.itemError(l),this.manager.itemError(u),"function"==typeof r&&r(e),d.disposeOnDemandRenderer();return}"function"==typeof t&&t(d),this.manager.itemEnd(s),this.manager.itemEnd(l),this.manager.itemEnd(u),d.disposeOnDemandRenderer()}},h=!0,f=0,m=0,p=!0,g=0,v=0,y=!0,x=0,w=0,_=()=>{"function"==typeof n&&n(new ProgressEvent("progress",{lengthComputable:h&&p&&y,loaded:m+v+w,total:f+g+x}))};this.manager.itemStart(s),this.manager.itemStart(l),this.manager.itemStart(u);let A=new tp.FileLoader(this._internalLoadingManager);A.setResponseType("arraybuffer"),A.setRequestHeader(this.requestHeader),A.setPath(this.path),A.setWithCredentials(this.withCredentials),A.load(s,async e=>{if("string"==typeof e)throw Error("Invalid sdr buffer");i=e,await c()},e=>{h=e.lengthComputable,m=e.loaded,f=e.total,_()},e=>{this.manager.itemError(s),"function"==typeof r&&r(e)});let S=new tp.FileLoader(this._internalLoadingManager);S.setResponseType("arraybuffer"),S.setRequestHeader(this.requestHeader),S.setPath(this.path),S.setWithCredentials(this.withCredentials),S.load(l,async e=>{if("string"==typeof e)throw Error("Invalid gainmap buffer");o=e,await c()},e=>{p=e.lengthComputable,v=e.loaded,g=e.total,_()},e=>{this.manager.itemError(l),"function"==typeof r&&r(e)});let b=new tp.FileLoader(this._internalLoadingManager);return b.setRequestHeader(this.requestHeader),b.setPath(this.path),b.setWithCredentials(this.withCredentials),b.load(u,async e=>{if("string"!=typeof e)throw Error("Invalid metadata string");a=JSON.parse(e),await c()},e=>{y=e.lengthComputable,w=e.loaded,x=e.total,_()},e=>{this.manager.itemError(u),"function"==typeof r&&r(e)}),d}}class tM extends tS{load(e,t,n,r){let i=this.prepareQuadRenderer(),o=new tp.FileLoader(this._internalLoadingManager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(this.withCredentials),this.manager.itemStart(e),o.load(e,async n=>{let o,a,s;if("string"==typeof n)throw Error("Invalid buffer, received [string], was expecting [ArrayBuffer]");let l=new Uint8Array(n);try{let e=await t_(l);o=e.sdr,a=e.gainMap,s=e.metadata}catch(t){if(t instanceof ty||t instanceof tv)console.warn("Failure to reconstruct an HDR image from ".concat(e,": Gain map metadata not found in the file, HDRJPGLoader will render the SDR jpeg")),s={gainMapMin:[0,0,0],gainMapMax:[1,1,1],gamma:[1,1,1],hdrCapacityMin:0,hdrCapacityMax:1,offsetHdr:[0,0,0],offsetSdr:[0,0,0]},o=l;else throw t}try{await this.render(i,s,o,a)}catch(t){this.manager.itemError(e),"function"==typeof r&&r(t),i.disposeOnDemandRenderer();return}"function"==typeof t&&t(i),this.manager.itemEnd(e),i.disposeOnDemandRenderer()},n,t=>{this.manager.itemError(e),"function"==typeof r&&r(t)}),i}}let tE={apartment:"lebombo_1k.hdr",city:"potsdamer_platz_1k.hdr",dawn:"kiara_1_dawn_1k.hdr",forest:"forest_slope_1k.hdr",lobby:"st_fagans_interior_1k.hdr",night:"dikhololo_night_1k.hdr",park:"rooitou_park_1k.hdr",studio:"studio_small_03_1k.hdr",sunset:"venice_sunset_1k.hdr",warehouse:"empty_warehouse_01_1k.hdr"},tj="https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/",tC=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"];function tT(){let{files:e=tC,path:t="",preset:n,colorSpace:r,extensions:i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n&&(tR(n),e=tE[n],t=tj);let o=Array.isArray(e),{extension:a,isCubemap:s}=tF(e),l=tz(a);if(!l)throw Error("useEnvironment: Unrecognized file extension: "+e);let u=(0,m.useThree)(e=>e.gl);(0,f.useLayoutEffect)(()=>{("webp"===a||"jpg"===a||"jpeg"===a)&&u.domElement.addEventListener("webglcontextlost",function(){S.useLoader.clear(l,o?[e]:e)},{once:!0})},[e,u.domElement]);let d=(0,S.useLoader)(l,o?[e]:e,e=>{("webp"===a||"jpg"===a||"jpeg"===a)&&e.setRenderer(u),null==e.setPath||e.setPath(t),i&&i(e)}),c=o?d[0]:d;if("jpg"===a||"jpeg"===a||"webp"===a){var h;c=null==(h=c.renderTarget)?void 0:h.texture}return c.mapping=s?x.CubeReflectionMapping:x.EquirectangularReflectionMapping,c.colorSpace=null!=r?r:s?"srgb":"srgb-linear",c}let tN={files:tC,path:"",preset:void 0,extensions:void 0};tT.preload=e=>{let t=(0,u._)({},tN,e),{files:n,path:r=""}=t,{preset:i,extensions:o}=t;i&&(tR(i),n=tE[i],r=tj);let{extension:a}=tF(n);if("webp"===a||"jpg"===a||"jpeg"===a)throw Error("useEnvironment: Preloading gainmaps is not supported");let s=tz(a);if(!s)throw Error("useEnvironment: Unrecognized file extension: "+n);S.useLoader.preload(s,Array.isArray(n)?[n]:n,e=>{null==e.setPath||e.setPath(r),o&&o(e)})};let tk={files:tC,preset:void 0};function tR(e){if(!(e in tE))throw Error("Preset must be one of: "+Object.keys(tE).join(", "))}function tF(e){var t;let n=Array.isArray(e)&&6===e.length,r=Array.isArray(e)&&3===e.length&&e.some(e=>e.endsWith("json")),i=Array.isArray(e)?e[0]:e;return{extension:n?"cube":r?"webp":i.startsWith("data:application/exr")?"exr":i.startsWith("data:application/hdr")?"hdr":i.startsWith("data:image/jpeg")?"jpg":null==(t=i.split(".").pop())||null==(t=t.split("?"))||null==(t=t.shift())?void 0:t.toLowerCase(),isCubemap:n,isGainmap:r}}function tz(e){return"cube"===e?x.CubeTextureLoader:"hdr"===e?M:"exr"===e?td:"jpg"===e||"jpeg"===e?tM:"webp"===e?tb:null}function tL(e,t,n,r){var i,o,a,s,l;let d,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};c=(0,u._)({backgroundBlurriness:0,backgroundIntensity:1,backgroundRotation:[0,0,0],environmentIntensity:1,environmentRotation:[0,0,0]},c);let h=(d=l=t||n).current&&d.current.isScene?l.current:l,f=h.background,m=h.environment,p={backgroundBlurriness:h.backgroundBlurriness,backgroundIntensity:h.backgroundIntensity,backgroundRotation:null!=(i=null==(o=h.backgroundRotation)||null==o.clone?void 0:o.clone())?i:[0,0,0],environmentIntensity:h.environmentIntensity,environmentRotation:null!=(a=null==(s=h.environmentRotation)||null==s.clone?void 0:s.clone())?a:[0,0,0]};return"only"!==e&&(h.environment=r),e&&(h.background=r),(0,v.applyProps)(h,c),()=>{"only"!==e&&(h.environment=m),e&&(h.background=f),(0,v.applyProps)(h,p)}}function tG(e){var{scene:t,background:n=!1,map:r}=e,i=(0,c._)(e,["scene","background","map"]);let o=(0,m.useThree)(e=>e.scene);return f.useLayoutEffect(()=>{if(r)return tL(n,t,o,r,i)}),null}function tU(e){var{background:t=!1,scene:n,blur:r,backgroundBlurriness:i,backgroundIntensity:o,backgroundRotation:a,environmentIntensity:s,environmentRotation:l}=e;let u=tT((0,c._)(e,["background","scene","blur","backgroundBlurriness","backgroundIntensity","backgroundRotation","environmentIntensity","environmentRotation"])),d=(0,m.useThree)(e=>e.scene);return f.useLayoutEffect(()=>tL(t,n,d,u,{backgroundBlurriness:null!=r?r:i,backgroundIntensity:o,backgroundRotation:a,environmentIntensity:s,environmentRotation:l})),f.useEffect(()=>()=>{u.dispose()},[u]),null}function tI(e){let{children:t,near:n=.1,far:r=1e3,resolution:i=256,frames:o=1,map:a,background:s=!1,blur:l,backgroundBlurriness:u,backgroundIntensity:d,backgroundRotation:c,environmentIntensity:h,environmentRotation:v,scene:y,files:w,path:_,preset:A,extensions:S}=e,b=(0,m.useThree)(e=>e.gl),M=(0,m.useThree)(e=>e.scene),E=f.useRef(null),[j]=f.useState(()=>new x.Scene),C=f.useMemo(()=>{let e=new x.WebGLCubeRenderTarget(i);return e.texture.type=x.HalfFloatType,e},[i]);f.useEffect(()=>()=>{C.dispose()},[C]),f.useLayoutEffect(()=>{if(1===o){let e=b.autoClear;b.autoClear=!0,E.current.update(b,j),b.autoClear=e}return tL(s,y,M,C.texture,{backgroundBlurriness:null!=l?l:u,backgroundIntensity:d,backgroundRotation:c,environmentIntensity:h,environmentRotation:v})},[t,j,C.texture,y,M,s,o,b]);let T=1;return(0,p.useFrame)(()=>{if(o===1/0||T<o){let e=b.autoClear;b.autoClear=!0,E.current.update(b,j),b.autoClear=e,T++}}),f.createElement(f.Fragment,null,(0,g.o)(f.createElement(f.Fragment,null,t,f.createElement("cubeCamera",{ref:E,args:[n,r,C]}),w||A?f.createElement(tU,{background:!0,files:w,preset:A,path:_,extensions:S}):a?f.createElement(tG,{background:!0,map:a,extensions:S}):null),j))}function tO(e){var t,n,r,i;let o=tT(e),a=e.map||o;f.useMemo(()=>(0,y.e)({GroundProjectedEnvImpl:A}),[]),f.useEffect(()=>()=>{o.dispose()},[o]);let s=f.useMemo(()=>[a],[a]),l=null==(t=e.ground)?void 0:t.height,u=null==(n=e.ground)?void 0:n.radius,d=null!=(r=null==(i=e.ground)?void 0:i.scale)?r:1e3;return f.createElement(f.Fragment,null,f.createElement(tG,(0,h.default)({},e,{map:a})),f.createElement("groundProjectedEnvImpl",{args:s,scale:d,height:l,radius:u}))}function tP(e){return e.ground?f.createElement(tO,e):e.map?f.createElement(tG,e):e.children?f.createElement(tI,e):f.createElement(tU,e)}tT.clear=e=>{let t=(0,u._)({},tk,e),{files:n}=t,{preset:r}=t;r&&(tR(r),n=tE[r]);let{extension:i}=tF(n),o=tz(i);if(!o)throw Error("useEnvironment: Unrecognized file extension: "+n);S.useLoader.clear(o,Array.isArray(n)?[n]:n)};var tB=e.i(7365),tD=e.i(75056);let tW=e=>{if(!e||"object"!=typeof e||Array.isArray(e))return{};let t={};try{for(let n in e)if(e.hasOwnProperty(n)){let r=e[n];null!=r&&("object"!=typeof r||Array.isArray(r)?"object"!=typeof r&&(t[n]=r):t[n]=tW(r))}}catch(e){console.warn("[OptimizedCanvas] Error creating clean object:",e)}return t};function tH(e){let{children:t,frameloop:n,style:r,camera:i,orthographic:o}=e,a=(0,f.useMemo)(()=>{try{return{antialias:!0,alpha:!1,powerPreference:"high-performance",stencil:!1,depth:!0,logarithmicDepthBuffer:!1,preserveDrawingBuffer:!1,failIfMajorPerformanceCaveat:!1}}catch(e){return console.error("[OptimizedCanvas] Error creating glConfig:",e),{antialias:!0,alpha:!1,powerPreference:"high-performance"}}},[]),s=(0,f.useMemo)(()=>{let e={dpr:[1,1.5],frameloop:n||"demand",gl:a&&"object"==typeof a&&!Array.isArray(a)?a:{antialias:!0,alpha:!1,powerPreference:"high-performance"}};void 0!==o&&(e.orthographic=o);try{null==r||"object"!=typeof r||Array.isArray(r)||(e.style=tW(r)),null==i||"object"!=typeof i||Array.isArray(i)||(e.camera=tW(i))}catch(e){console.error("[OptimizedCanvas] Error building canvasProps:",e)}return e},[n,r,i,a,o]);if(!s||"object"!=typeof s||Array.isArray(s))return console.error("[OptimizedCanvas] Invalid canvasProps, using defaults:",s),(0,d.jsx)(tD.Canvas,{dpr:[1,1.5],frameloop:"demand",children:t});if(!tD.Canvas)return console.error("[OptimizedCanvas] Canvas component not available"),null;let l=(0,f.useMemo)(()=>{let e=tW(s);return e.dpr&&Array.isArray(e.dpr)||(e.dpr=[1,1.5]),e.frameloop&&"string"==typeof e.frameloop||(e.frameloop="demand"),(!e.gl||"object"!=typeof e.gl||Array.isArray(e.gl))&&(e.gl=a),e},[s,a]);try{return(0,d.jsx)(tD.Canvas,(0,tc._)((0,u._)({},l),{children:t}))}catch(e){return console.error("[OptimizedCanvas] Error rendering Canvas:",e,"safeCanvasProps:",l),(0,d.jsx)(tD.Canvas,{dpr:[1,1.5],frameloop:"demand",children:t})}}e.i(47167);var tV=x,tq=x;let tX=new tq.Box3,tY=new tq.Vector3;class tJ extends tq.InstancedBufferGeometry{applyMatrix4(e){let t=this.attributes.instanceStart,n=this.attributes.instanceEnd;return void 0!==t&&(t.applyMatrix4(e),n.applyMatrix4(e),t.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}setPositions(e){let t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));let n=new tq.InstancedInterleavedBuffer(t,6,1);return this.setAttribute("instanceStart",new tq.InterleavedBufferAttribute(n,3,0)),this.setAttribute("instanceEnd",new tq.InterleavedBufferAttribute(n,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this}setColors(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));let r=new tq.InstancedInterleavedBuffer(t,2*n,1);return this.setAttribute("instanceColorStart",new tq.InterleavedBufferAttribute(r,n,0)),this.setAttribute("instanceColorEnd",new tq.InterleavedBufferAttribute(r,n,n)),this}fromWireframeGeometry(e){return this.setPositions(e.attributes.position.array),this}fromEdgesGeometry(e){return this.setPositions(e.attributes.position.array),this}fromMesh(e){return this.fromWireframeGeometry(new tq.WireframeGeometry(e.geometry)),this}fromLineSegments(e){let t=e.geometry;return this.setPositions(t.attributes.position.array),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new tq.Box3);let e=this.attributes.instanceStart,t=this.attributes.instanceEnd;void 0!==e&&void 0!==t&&(this.boundingBox.setFromBufferAttribute(e),tX.setFromBufferAttribute(t),this.boundingBox.union(tX))}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new tq.Sphere),null===this.boundingBox&&this.computeBoundingBox();let e=this.attributes.instanceStart,t=this.attributes.instanceEnd;if(void 0!==e&&void 0!==t){let n=this.boundingSphere.center;this.boundingBox.getCenter(n);let r=0;for(let i=0,o=e.count;i<o;i++)tY.fromBufferAttribute(e,i),r=Math.max(r,n.distanceToSquared(tY)),tY.fromBufferAttribute(t,i),r=Math.max(r,n.distanceToSquared(tY));this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}toJSON(){}applyMatrix(e){return console.warn("THREE.LineSegmentsGeometry: applyMatrix() has been renamed to applyMatrix4()."),this.applyMatrix4(e)}constructor(){super(),this.isLineSegmentsGeometry=!0,this.type="LineSegmentsGeometry",this.setIndex([0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5]),this.setAttribute("position",new tq.Float32BufferAttribute([-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],3)),this.setAttribute("uv",new tq.Float32BufferAttribute([-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],2))}}var tZ=x;class tQ extends tZ.ShaderMaterial{constructor(e){super({type:"LineMaterial",uniforms:tZ.UniformsUtils.clone(tZ.UniformsUtils.merge([th.UniformsLib.common,th.UniformsLib.fog,{worldUnits:{value:1},linewidth:{value:1},resolution:{value:new tZ.Vector2(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}}])),vertexShader:"\n				#include <common>\n				#include <fog_pars_vertex>\n				#include <logdepthbuf_pars_vertex>\n				#include <clipping_planes_pars_vertex>\n\n				uniform float linewidth;\n				uniform vec2 resolution;\n\n				attribute vec3 instanceStart;\n				attribute vec3 instanceEnd;\n\n				#ifdef USE_COLOR\n					#ifdef USE_LINE_COLOR_ALPHA\n						varying vec4 vLineColor;\n						attribute vec4 instanceColorStart;\n						attribute vec4 instanceColorEnd;\n					#else\n						varying vec3 vLineColor;\n						attribute vec3 instanceColorStart;\n						attribute vec3 instanceColorEnd;\n					#endif\n				#endif\n\n				#ifdef WORLD_UNITS\n\n					varying vec4 worldPos;\n					varying vec3 worldStart;\n					varying vec3 worldEnd;\n\n					#ifdef USE_DASH\n\n						varying vec2 vUv;\n\n					#endif\n\n				#else\n\n					varying vec2 vUv;\n\n				#endif\n\n				#ifdef USE_DASH\n\n					uniform float dashScale;\n					attribute float instanceDistanceStart;\n					attribute float instanceDistanceEnd;\n					varying float vLineDistance;\n\n				#endif\n\n				void trimSegment( const in vec4 start, inout vec4 end ) {\n\n					// trim end segment so it terminates between the camera plane and the near plane\n\n					// conservative estimate of the near plane\n					float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column\n					float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column\n					float nearEstimate = - 0.5 * b / a;\n\n					float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );\n\n					end.xyz = mix( start.xyz, end.xyz, alpha );\n\n				}\n\n				void main() {\n\n					#ifdef USE_COLOR\n\n						vLineColor = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;\n\n					#endif\n\n					#ifdef USE_DASH\n\n						vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;\n						vUv = uv;\n\n					#endif\n\n					float aspect = resolution.x / resolution.y;\n\n					// camera space\n					vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );\n					vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );\n\n					#ifdef WORLD_UNITS\n\n						worldStart = start.xyz;\n						worldEnd = end.xyz;\n\n					#else\n\n						vUv = uv;\n\n					#endif\n\n					// special case for perspective projection, and segments that terminate either in, or behind, the camera plane\n					// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space\n					// but we need to perform ndc-space calculations in the shader, so we must address this issue directly\n					// perhaps there is a more elegant solution -- WestLangley\n\n					bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column\n\n					if ( perspective ) {\n\n						if ( start.z < 0.0 && end.z >= 0.0 ) {\n\n							trimSegment( start, end );\n\n						} else if ( end.z < 0.0 && start.z >= 0.0 ) {\n\n							trimSegment( end, start );\n\n						}\n\n					}\n\n					// clip space\n					vec4 clipStart = projectionMatrix * start;\n					vec4 clipEnd = projectionMatrix * end;\n\n					// ndc space\n					vec3 ndcStart = clipStart.xyz / clipStart.w;\n					vec3 ndcEnd = clipEnd.xyz / clipEnd.w;\n\n					// direction\n					vec2 dir = ndcEnd.xy - ndcStart.xy;\n\n					// account for clip-space aspect ratio\n					dir.x *= aspect;\n					dir = normalize( dir );\n\n					#ifdef WORLD_UNITS\n\n						// get the offset direction as perpendicular to the view vector\n						vec3 worldDir = normalize( end.xyz - start.xyz );\n						vec3 offset;\n						if ( position.y < 0.5 ) {\n\n							offset = normalize( cross( start.xyz, worldDir ) );\n\n						} else {\n\n							offset = normalize( cross( end.xyz, worldDir ) );\n\n						}\n\n						// sign flip\n						if ( position.x < 0.0 ) offset *= - 1.0;\n\n						float forwardOffset = dot( worldDir, vec3( 0.0, 0.0, 1.0 ) );\n\n						// don't extend the line if we're rendering dashes because we\n						// won't be rendering the endcaps\n						#ifndef USE_DASH\n\n							// extend the line bounds to encompass  endcaps\n							start.xyz += - worldDir * linewidth * 0.5;\n							end.xyz += worldDir * linewidth * 0.5;\n\n							// shift the position of the quad so it hugs the forward edge of the line\n							offset.xy -= dir * forwardOffset;\n							offset.z += 0.5;\n\n						#endif\n\n						// endcaps\n						if ( position.y > 1.0 || position.y < 0.0 ) {\n\n							offset.xy += dir * 2.0 * forwardOffset;\n\n						}\n\n						// adjust for linewidth\n						offset *= linewidth * 0.5;\n\n						// set the world position\n						worldPos = ( position.y < 0.5 ) ? start : end;\n						worldPos.xyz += offset;\n\n						// project the worldpos\n						vec4 clip = projectionMatrix * worldPos;\n\n						// shift the depth of the projected points so the line\n						// segments overlap neatly\n						vec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;\n						clip.z = clipPose.z * clip.w;\n\n					#else\n\n						vec2 offset = vec2( dir.y, - dir.x );\n						// undo aspect ratio adjustment\n						dir.x /= aspect;\n						offset.x /= aspect;\n\n						// sign flip\n						if ( position.x < 0.0 ) offset *= - 1.0;\n\n						// endcaps\n						if ( position.y < 0.0 ) {\n\n							offset += - dir;\n\n						} else if ( position.y > 1.0 ) {\n\n							offset += dir;\n\n						}\n\n						// adjust for linewidth\n						offset *= linewidth;\n\n						// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...\n						offset /= resolution.y;\n\n						// select end\n						vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;\n\n						// back to clip space\n						offset *= clip.w;\n\n						clip.xy += offset;\n\n					#endif\n\n					gl_Position = clip;\n\n					vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation\n\n					#include <logdepthbuf_vertex>\n					#include <clipping_planes_vertex>\n					#include <fog_vertex>\n\n				}\n			",fragmentShader:"\n				uniform vec3 diffuse;\n				uniform float opacity;\n				uniform float linewidth;\n\n				#ifdef USE_DASH\n\n					uniform float dashOffset;\n					uniform float dashSize;\n					uniform float gapSize;\n\n				#endif\n\n				varying float vLineDistance;\n\n				#ifdef WORLD_UNITS\n\n					varying vec4 worldPos;\n					varying vec3 worldStart;\n					varying vec3 worldEnd;\n\n					#ifdef USE_DASH\n\n						varying vec2 vUv;\n\n					#endif\n\n				#else\n\n					varying vec2 vUv;\n\n				#endif\n\n				#include <common>\n				#include <fog_pars_fragment>\n				#include <logdepthbuf_pars_fragment>\n				#include <clipping_planes_pars_fragment>\n\n				#ifdef USE_COLOR\n					#ifdef USE_LINE_COLOR_ALPHA\n						varying vec4 vLineColor;\n					#else\n						varying vec3 vLineColor;\n					#endif\n				#endif\n\n				vec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {\n\n					float mua;\n					float mub;\n\n					vec3 p13 = p1 - p3;\n					vec3 p43 = p4 - p3;\n\n					vec3 p21 = p2 - p1;\n\n					float d1343 = dot( p13, p43 );\n					float d4321 = dot( p43, p21 );\n					float d1321 = dot( p13, p21 );\n					float d4343 = dot( p43, p43 );\n					float d2121 = dot( p21, p21 );\n\n					float denom = d2121 * d4343 - d4321 * d4321;\n\n					float numer = d1343 * d4321 - d1321 * d4343;\n\n					mua = numer / denom;\n					mua = clamp( mua, 0.0, 1.0 );\n					mub = ( d1343 + d4321 * ( mua ) ) / d4343;\n					mub = clamp( mub, 0.0, 1.0 );\n\n					return vec2( mua, mub );\n\n				}\n\n				void main() {\n\n					#include <clipping_planes_fragment>\n\n					#ifdef USE_DASH\n\n						if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps\n\n						if ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX\n\n					#endif\n\n					float alpha = opacity;\n\n					#ifdef WORLD_UNITS\n\n						// Find the closest points on the view ray and the line segment\n						vec3 rayEnd = normalize( worldPos.xyz ) * 1e5;\n						vec3 lineDir = worldEnd - worldStart;\n						vec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );\n\n						vec3 p1 = worldStart + lineDir * params.x;\n						vec3 p2 = rayEnd * params.y;\n						vec3 delta = p1 - p2;\n						float len = length( delta );\n						float norm = len / linewidth;\n\n						#ifndef USE_DASH\n\n							#ifdef USE_ALPHA_TO_COVERAGE\n\n								float dnorm = fwidth( norm );\n								alpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );\n\n							#else\n\n								if ( norm > 0.5 ) {\n\n									discard;\n\n								}\n\n							#endif\n\n						#endif\n\n					#else\n\n						#ifdef USE_ALPHA_TO_COVERAGE\n\n							// artifacts appear on some hardware if a derivative is taken within a conditional\n							float a = vUv.x;\n							float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n							float len2 = a * a + b * b;\n							float dlen = fwidth( len2 );\n\n							if ( abs( vUv.y ) > 1.0 ) {\n\n								alpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );\n\n							}\n\n						#else\n\n							if ( abs( vUv.y ) > 1.0 ) {\n\n								float a = vUv.x;\n								float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n								float len2 = a * a + b * b;\n\n								if ( len2 > 1.0 ) discard;\n\n							}\n\n						#endif\n\n					#endif\n\n					vec4 diffuseColor = vec4( diffuse, alpha );\n					#ifdef USE_COLOR\n						#ifdef USE_LINE_COLOR_ALPHA\n							diffuseColor *= vLineColor;\n						#else\n							diffuseColor.rgb *= vLineColor;\n						#endif\n					#endif\n\n					#include <logdepthbuf_fragment>\n\n					gl_FragColor = diffuseColor;\n\n					#include <tonemapping_fragment>\n					#include <".concat(_.version>=154?"colorspace_fragment":"encodings_fragment",">\n					#include <fog_fragment>\n					#include <premultiplied_alpha_fragment>\n\n				}\n			"),clipping:!0}),this.isLineMaterial=!0,this.onBeforeCompile=function(){this.transparent?this.defines.USE_LINE_COLOR_ALPHA="1":delete this.defines.USE_LINE_COLOR_ALPHA},Object.defineProperties(this,{color:{enumerable:!0,get:function(){return this.uniforms.diffuse.value},set:function(e){this.uniforms.diffuse.value=e}},worldUnits:{enumerable:!0,get:function(){return"WORLD_UNITS"in this.defines},set:function(e){!0===e?this.defines.WORLD_UNITS="":delete this.defines.WORLD_UNITS}},linewidth:{enumerable:!0,get:function(){return this.uniforms.linewidth.value},set:function(e){this.uniforms.linewidth.value=e}},dashed:{enumerable:!0,get:function(){return"USE_DASH"in this.defines},set(e){!!e!="USE_DASH"in this.defines&&(this.needsUpdate=!0),!0===e?this.defines.USE_DASH="":delete this.defines.USE_DASH}},dashScale:{enumerable:!0,get:function(){return this.uniforms.dashScale.value},set:function(e){this.uniforms.dashScale.value=e}},dashSize:{enumerable:!0,get:function(){return this.uniforms.dashSize.value},set:function(e){this.uniforms.dashSize.value=e}},dashOffset:{enumerable:!0,get:function(){return this.uniforms.dashOffset.value},set:function(e){this.uniforms.dashOffset.value=e}},gapSize:{enumerable:!0,get:function(){return this.uniforms.gapSize.value},set:function(e){this.uniforms.gapSize.value=e}},opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(e){this.uniforms.opacity.value=e}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(e){this.uniforms.resolution.value.copy(e)}},alphaToCoverage:{enumerable:!0,get:function(){return"USE_ALPHA_TO_COVERAGE"in this.defines},set:function(e){!!e!="USE_ALPHA_TO_COVERAGE"in this.defines&&(this.needsUpdate=!0),!0===e?(this.defines.USE_ALPHA_TO_COVERAGE="",this.extensions.derivatives=!0):(delete this.defines.USE_ALPHA_TO_COVERAGE,this.extensions.derivatives=!1)}}}),this.setValues(e)}}let t$=_.version>=125?"uv1":"uv2",tK=new tV.Vector4,t0=new tV.Vector3,t1=new tV.Vector3,t2=new tV.Vector4,t3=new tV.Vector4,t5=new tV.Vector4,t4=new tV.Vector3,t8=new tV.Matrix4,t6=new tV.Line3,t7=new tV.Vector3,t9=new tV.Box3,ne=new tV.Sphere,nt=new tV.Vector4;function nn(e,t,n){return nt.set(0,0,-t,1).applyMatrix4(e.projectionMatrix),nt.multiplyScalar(1/nt.w),nt.x=r/n.width,nt.y=r/n.height,nt.applyMatrix4(e.projectionMatrixInverse),nt.multiplyScalar(1/nt.w),Math.abs(Math.max(nt.x,nt.y))}class nr extends tV.Mesh{computeLineDistances(){let e=this.geometry,t=e.attributes.instanceStart,n=e.attributes.instanceEnd,r=new Float32Array(2*t.count);for(let e=0,i=0,o=t.count;e<o;e++,i+=2)t0.fromBufferAttribute(t,e),t1.fromBufferAttribute(n,e),r[i]=0===i?0:r[i-1],r[i+1]=r[i]+t0.distanceTo(t1);let i=new tV.InstancedInterleavedBuffer(r,2,1);return e.setAttribute("instanceDistanceStart",new tV.InterleavedBufferAttribute(i,1,0)),e.setAttribute("instanceDistanceEnd",new tV.InterleavedBufferAttribute(i,1,1)),this}raycast(e,t){let i,o,a=this.material.worldUnits,s=e.camera;null!==s||a||console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2 while worldUnits is set to false.');let l=void 0!==e.params.Line2&&e.params.Line2.threshold||0;n=e.ray;let u=this.matrixWorld,d=this.geometry,c=this.material;if(r=c.linewidth+l,null===d.boundingSphere&&d.computeBoundingSphere(),ne.copy(d.boundingSphere).applyMatrix4(u),a)i=.5*r;else{let e=Math.max(s.near,ne.distanceToPoint(n.origin));i=nn(s,e,c.resolution)}if(ne.radius+=i,!1!==n.intersectsSphere(ne)){if(null===d.boundingBox&&d.computeBoundingBox(),t9.copy(d.boundingBox).applyMatrix4(u),a)o=.5*r;else{let e=Math.max(s.near,t9.distanceToPoint(n.origin));o=nn(s,e,c.resolution)}t9.expandByScalar(o),!1!==n.intersectsBox(t9)&&(a?function(e,t){let i=e.matrixWorld,o=e.geometry,a=o.attributes.instanceStart,s=o.attributes.instanceEnd,l=Math.min(o.instanceCount,a.count);for(let o=0;o<l;o++){t6.start.fromBufferAttribute(a,o),t6.end.fromBufferAttribute(s,o),t6.applyMatrix4(i);let l=new tV.Vector3,u=new tV.Vector3;n.distanceSqToSegment(t6.start,t6.end,u,l),u.distanceTo(l)<.5*r&&t.push({point:u,pointOnLine:l,distance:n.origin.distanceTo(u),object:e,face:null,faceIndex:o,uv:null,[t$]:null})}}(this,t):function(e,t,i){let o=t.projectionMatrix,a=e.material.resolution,s=e.matrixWorld,l=e.geometry,u=l.attributes.instanceStart,d=l.attributes.instanceEnd,c=Math.min(l.instanceCount,u.count),h=-t.near;n.at(1,t5),t5.w=1,t5.applyMatrix4(t.matrixWorldInverse),t5.applyMatrix4(o),t5.multiplyScalar(1/t5.w),t5.x*=a.x/2,t5.y*=a.y/2,t5.z=0,t4.copy(t5),t8.multiplyMatrices(t.matrixWorldInverse,s);for(let t=0;t<c;t++){if(t2.fromBufferAttribute(u,t),t3.fromBufferAttribute(d,t),t2.w=1,t3.w=1,t2.applyMatrix4(t8),t3.applyMatrix4(t8),t2.z>h&&t3.z>h)continue;if(t2.z>h){let e=t2.z-t3.z,t=(t2.z-h)/e;t2.lerp(t3,t)}else if(t3.z>h){let e=t3.z-t2.z,t=(t3.z-h)/e;t3.lerp(t2,t)}t2.applyMatrix4(o),t3.applyMatrix4(o),t2.multiplyScalar(1/t2.w),t3.multiplyScalar(1/t3.w),t2.x*=a.x/2,t2.y*=a.y/2,t3.x*=a.x/2,t3.y*=a.y/2,t6.start.copy(t2),t6.start.z=0,t6.end.copy(t3),t6.end.z=0;let l=t6.closestPointToPointParameter(t4,!0);t6.at(l,t7);let c=tV.MathUtils.lerp(t2.z,t3.z,l),f=c>=-1&&c<=1,m=t4.distanceTo(t7)<.5*r;if(f&&m){t6.start.fromBufferAttribute(u,t),t6.end.fromBufferAttribute(d,t),t6.start.applyMatrix4(s),t6.end.applyMatrix4(s);let r=new tV.Vector3,o=new tV.Vector3;n.distanceSqToSegment(t6.start,t6.end,o,r),i.push({point:o,pointOnLine:r,distance:n.origin.distanceTo(o),object:e,face:null,faceIndex:t,uv:null,[t$]:null})}}}(this,s,t))}}onBeforeRender(e){let t=this.material.uniforms;t&&t.resolution&&(e.getViewport(tK),this.material.uniforms.resolution.value.set(tK.z,tK.w))}constructor(e=new tJ,t=new tQ({color:0xffffff*Math.random()})){super(e,t),this.isLineSegments2=!0,this.type="LineSegments2"}}class ni extends tJ{setPositions(e){let t=e.length-3,n=new Float32Array(2*t);for(let r=0;r<t;r+=3)n[2*r]=e[r],n[2*r+1]=e[r+1],n[2*r+2]=e[r+2],n[2*r+3]=e[r+3],n[2*r+4]=e[r+4],n[2*r+5]=e[r+5];return super.setPositions(n),this}setColors(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=e.length-t,r=new Float32Array(2*n);if(3===t)for(let i=0;i<n;i+=t)r[2*i]=e[i],r[2*i+1]=e[i+1],r[2*i+2]=e[i+2],r[2*i+3]=e[i+3],r[2*i+4]=e[i+4],r[2*i+5]=e[i+5];else for(let i=0;i<n;i+=t)r[2*i]=e[i],r[2*i+1]=e[i+1],r[2*i+2]=e[i+2],r[2*i+3]=e[i+3],r[2*i+4]=e[i+4],r[2*i+5]=e[i+5],r[2*i+6]=e[i+6],r[2*i+7]=e[i+7];return super.setColors(r,t),this}fromLine(e){let t=e.geometry;return this.setPositions(t.attributes.position.array),this}constructor(){super(),this.isLineGeometry=!0,this.type="LineGeometry"}}class no extends nr{constructor(e=new ni,t=new tQ({color:0xffffff*Math.random()})){super(e,t),this.isLine2=!0,this.type="Line2"}}let na=f.forwardRef(function(e,t){var n,r,{points:i,color:o=0xffffff,vertexColors:a,linewidth:s,lineWidth:l,segments:u,dashed:d}=e,p=(0,c._)(e,["points","color","vertexColors","linewidth","lineWidth","segments","dashed"]);let g=(0,m.useThree)(e=>e.size),v=f.useMemo(()=>u?new nr:new no,[u]),[y]=f.useState(()=>new tQ),w=(null==a||null==(n=a[0])?void 0:n.length)===4?4:3,_=f.useMemo(()=>{let e=u?new tJ:new ni,t=i.map(e=>{let t=Array.isArray(e);return e instanceof x.Vector3||e instanceof x.Vector4?[e.x,e.y,e.z]:e instanceof x.Vector2?[e.x,e.y,0]:t&&3===e.length?[e[0],e[1],e[2]]:t&&2===e.length?[e[0],e[1],0]:e});if(e.setPositions(t.flat()),a){o=0xffffff;let t=a.map(e=>e instanceof x.Color?e.toArray():e);e.setColors(t.flat(),w)}return e},[i,u,a,w]);return f.useLayoutEffect(()=>{v.computeLineDistances()},[i,v]),f.useLayoutEffect(()=>{d?y.defines.USE_DASH="":delete y.defines.USE_DASH,y.needsUpdate=!0},[d,y]),f.useEffect(()=>()=>{_.dispose(),y.dispose()},[_]),f.createElement("primitive",(0,h.default)({object:v,ref:t},p),f.createElement("primitive",{object:_,attach:"geometry"}),f.createElement("primitive",(0,h.default)({object:y,attach:"material",color:o,vertexColors:!!a,resolution:[g.width,g.height],linewidth:null!=(r=null!=s?s:l)?r:1,dashed:d,transparent:4===w},p)))}),ns=f.forwardRef(function(e,t){var{start:n,end:r,midA:i,midB:o,segments:a=20}=e,s=(0,c._)(e,["start","end","midA","midB","segments"]);let l=f.useMemo(()=>{let e=n instanceof x.Vector3?n:new x.Vector3(...n),t=r instanceof x.Vector3?r:new x.Vector3(...r),s=i instanceof x.Vector3?i:new x.Vector3(...i),l=o instanceof x.Vector3?o:new x.Vector3(...o);return new x.CubicBezierCurve3(e,s,l,t).getPoints(a)},[n,r,i,o,a]);return f.createElement(na,(0,h.default)({ref:t,points:l},s))});var nl=e.i(77741);let nu={A1:["G10","G12","G13","G14","G16","G19","G20","G5"],A2:["G16","G19","G4"],A3:["G14","G16","G22","G5","G6"],A4:["G10","G14","G16","G5"],A5:["G13","G19","G2"],A6:["G19","G6","G8"],A7:[],A8:[],A9:["G24"],A10:["G2","G22"],A11:[],A12:["G16","G19","G7"],A13:["G14","G16","G22","G25","G27"],A14:["G13","G14","G16","G26","G6"],A15:["G14","G15","G20","G21"],A16:["G16","G17"],A17:["G14","G16","G25","G8"],A18:["G4"],A19:["G13","G16","G21","G25","G9"],A20:["G12","G13","G16","G25","G27","G8"],A21:["G11","G14","G16"],A22:["G16","G26"],A23:["G12","G16","G27","G29","G31","G5"],A24:["G11","G12","G13","G16","G19","G21","G22"],A25:["G14","G16","G17","G18","G22","G25","G27"],A26:["G12","G13","G14","G4","G8"]},nd={G2:["A10","A5"],G4:["A18","A2","A26"],G5:["A1","A23","A3","A4"],G6:["A14","A3","A6"],G7:["A12"],G8:["A17","A20","A26","A6"],G9:["A19"],G10:["A1","A4"],G11:["A21","A24"],G12:["A1","A20","A23","A24","A26"],G13:["A1","A14","A19","A20","A24","A26","A5"],G14:["A1","A13","A14","A15","A17","A21","A25","A26","A3","A4"],G15:["A15"],G16:["A1","A12","A13","A14","A16","A17","A19","A2","A20","A21","A22","A23","A24","A25","A3","A4"],G17:["A16","A25"],G18:["A25"],G19:["A1","A12","A2","A24","A5","A6"],G20:["A1","A15"],G21:["A15","A19","A24"],G22:["A10","A13","A24","A25","A3"],G24:["A9"],G25:["A13","A17","A19","A20","A25"],G26:["A14","A22"],G27:["A13","A20","A23","A25"],G29:["A23"],G31:["A23"]};function nc(e){return e?nu[e]?nu[e]:nd[e]?nd[e]:[]:[]}let nh=Math.PI*(3-Math.sqrt(5));function nf(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(t<=1)return[0,0,0];if(r){let r=Math.max(-.9,Math.min(.9,1-e/(t-1)*2)),i=Math.sqrt(Math.max(0,1-r*r))*n,o=nh*e;return[Math.cos(o)*i,r*n,Math.sin(o)*i]}{let r=Math.max(-.85,Math.min(.85,1-e/(t-1)*2)),i=Math.sqrt(Math.max(0,1-r*r))*n,o=nh*e;return[Math.cos(o)*i,r*n*.8,Math.sin(o)*i]}}function nm(e,t,n){return t+(.5*Math.sin(.7*e)+.3*Math.cos(1.3*e))*n}function np(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:15,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(null!==r&&null!==i&&t===r+i){if(e<r){let t=nm(e,22,6);return nf(e,r,t,!1)}let t=e-r,n=nm(t,12,3);return nf(t,i,n,!0)}return nf(e,t,n)}let ng=new Map,nv=new Map,ny=new x.Vector3;function nx(e,t){t?ng.set(e,t):ng.delete(e),nv.delete(e)}function nw(e){ng.delete(e),nv.delete(e)}function n_(e){let t=ng.get(e);if(!t||!t.current)return null;try{t.current.getWorldPosition(ny);let n=[ny.x,ny.y,ny.z];return nv.set(e,n),n}catch(e){return null}}function nA(e){return nv.get(e)||null}function nS(e,t,n){if(!e||!e.startsWith("A"))return[];let r=n||nd,i=(t||nu)[e]||[];if(0===i.length)return[];let o=new Set;return i.forEach(t=>{(r[t]||[]).forEach(t=>{t!==e&&o.add(t)})}),Array.from(o)}e.i(22862);let nb=Array.from({length:29},(e,t)=>"A".concat(t+1)),nM=Array.from({length:54},(e,t)=>"G".concat(t+1)),nE=nb.length+nM.length;function nj(e){let{start:t,end:n,v0:r,v1:i,index:o,totalConnections:a,color:s="#e9ff00",shouldHide:l=!1}=e,[u,c]=(0,f.useState)(0),[h,m]=(0,f.useState)(.5),p=(0,f.useRef)(null),g=(0,f.useRef)(!1),v=(0,f.useRef)(!1),y=(0,f.useRef)(!0),x=(0,f.useRef)("".concat(t[0],"-").concat(t[1],"-").concat(n[0],"-").concat(n[1],"-").concat(null==r?void 0:r[0],"-").concat(null==i?void 0:i[0]));(0,f.useEffect)(()=>{var e,o;let a="".concat(t[0].toFixed(1),"-").concat(t[1].toFixed(1),"-").concat(n[0].toFixed(1),"-").concat(n[1].toFixed(1),"-").concat(null==r||null==(e=r[0])?void 0:e.toFixed(1),"-").concat(null==i||null==(o=i[0])?void 0:o.toFixed(1));a!==x.current&&(x.current=a,y.current&&(c(0),p.current=Date.now(),v.current=!1,y.current=!1))},[t,n,r,i]),(0,f.useEffect)(()=>{if(l){c(0),v.current=!1;return}if(!v.current){p.current=Date.now();let e=setTimeout(()=>{let e=Date.now(),t=()=>{let n=Math.min((Date.now()-e)/300,1),r=1-Math.pow(1-n,3);c(r),m(.5+.5*r),n<1?requestAnimationFrame(t):(g.current=!0,v.current=!0)};t()},20*o);return()=>clearTimeout(e)}},[o,l]),(0,f.useEffect)(()=>{v.current&&!l&&u<.9&&(c(1),m(1))},[t,n,r,i,l,u]);let w=e=>e&&Array.isArray(e)&&3===e.length&&e.every(e=>"number"==typeof e&&!isNaN(e)&&isFinite(e)),_=e=>e&&Array.isArray(e)&&3===e.length&&e.every(e=>"number"==typeof e&&!isNaN(e)&&isFinite(e));return _(t)&&_(n)&&w(r)&&w(i)&&(0!==u||!l)?(0,d.jsx)("group",{renderOrder:4,frustumCulled:!1,children:(0,d.jsx)(ns,{start:t,end:n,midA:r,midB:i,color:s,lineWidth:h,opacity:u,transparent:!0,depthWrite:!1,depthTest:!0})}):null}let nC=function(e){let{processedData:t}=e,{camera:n}=(0,m.useThree)(),[r]=(0,nl.useStore)("selectedNodeStore",null),[i]=(0,nl.useStore)("highlightedNodesStore",[]),[o]=(0,nl.useStore)("connectionLinesVisibilityStore",!0),a=(0,f.useMemo)(()=>(function(e){var t;if(!(null==e||null==(t=e.links)?void 0:t.length))return null;let n={},r={};return e.links.forEach(e=>{var t,i;let o="string"==typeof e.source?e.source:null==(t=e.source)?void 0:t.id,a="string"==typeof e.target?e.target:null==(i=e.target)?void 0:i.id;o&&a&&(o.startsWith("A")&&(n[o]||(n[o]=[]),n[o].includes(a)||n[o].push(a)),a.startsWith("G")&&(r[a]||(r[a]=[]),r[a].includes(o)||r[a].push(o)))}),{articleConnections:n,keywordConnections:r,getConnectedNodes:e=>e?n[e]?n[e]:r[e]?r[e]:[]:[]}})(t),[t]),s=a?a.getConnectedNodes:nc,l=a?a.articleConnections:nu,u=a?a.keywordConnections:nd,c=()=>{let e;if(t&&t.nodeMap){let e={};return t.nodeMap.forEach((t,n)=>{e[n]=t.position||[0,0,0]}),e}return e={},nb.forEach((t,n)=>{e[t]=np(n,nE,15)}),nM.forEach((t,n)=>{e[t]=np(nb.length+n,nE,15)}),e};(0,f.useEffect)(()=>{let e=(0,nl.getStore)("highlightedNodesStore"),t=(0,nl.getStore)("secondaryHighlightedArticlesStore"),n=new Set,i=new Set;(null==r?void 0:r.id)&&(n.add(r.id),s(r.id).forEach(e=>{e&&n.add(e)}),r.id.startsWith("A")&&nS(r.id,l,u).forEach(e=>{i.add(e)})),requestAnimationFrame(()=>{e.setState(Array.from(n)),t.setState(Array.from(i))}),L.current.clear(),nv.clear()},[r]);let h=(0,f.useRef)(0),g=(0,f.useRef)({}),v=(0,f.useRef)(null),[y,w]=(0,f.useState)(0);(0,p.useFrame)(e=>{let n=Date.now();if(n-h.current<16||(h.current=n,!t||!t.nodeMap||!(null==r?void 0:r.id)))return;let i=e.camera.position,o=!v.current||Math.abs(i.x-v.current.x)>.01||Math.abs(i.y-v.current.y)>.01||Math.abs(i.z-v.current.z)>.01;o&&(v.current=i.clone());let a=c(),l=s(r.id),u=[r.id,...l],d=!1;u.forEach(e=>{let t=a[e];if(!t)return;let n=g.current[e];n?(Math.abs(t[0]-n[0])>.05||Math.abs(t[1]-n[1])>.05||Math.abs(t[2]-n[2])>.05)&&(d=!0,g.current[e]=[...t]):(d=!0,g.current[e]=[...t])}),(d||o)&&requestAnimationFrame(()=>{w(e=>e+1)})});let _=(0,f.useRef)(new x.Vector3),A=(0,f.useRef)(new x.Vector3),S=(0,f.useRef)(new x.Vector3),b=(0,f.useRef)(new x.Vector3),M=(0,f.useRef)(new x.Vector3(0,1,0)),E=(0,f.useRef)(new x.Vector3(1,0,0)),j=function(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!e||!t||!Array.isArray(e)||!Array.isArray(t)||3!==e.length||3!==t.length||e.some(e=>"number"!=typeof e||isNaN(e)||!isFinite(e))||t.some(e=>"number"!=typeof e||isNaN(e)||!isFinite(e))){let n=[(((null==e?void 0:e[0])||0)+((null==t?void 0:t[0])||0))/2,(((null==e?void 0:e[1])||0)+((null==t?void 0:t[1])||0))/2,(((null==e?void 0:e[2])||0)+((null==t?void 0:t[2])||0))/2];return{v0:n,v1:n}}let o=t[0]-e[0],a=t[1]-e[1],s=t[2]-e[2],l=Math.sqrt(o*o+a*a+s*s);if(l<.001||!isFinite(l)){let n=[(e[0]+t[0])/2,(e[1]+t[1])/2,(e[2]+t[2])/2];return{v0:n,v1:n}}let u=_.current.set(o,a,s);.001>u.length()||!isFinite(u.length())?u.set(1,0,0):u.normalize();let d=M.current,c=A.current.crossVectors(d,u);.001>c.length()&&c.crossVectors(E.current,u),c.normalize();let h=S.current.crossVectors(u,c).normalize(),f=30*n%360*Math.PI/180,m=.08*l*Math.cos(f),p=.08*l*Math.sin(f),g=i?12:8,v=b.current.set(e[0]-d.x*g+c.x*m*.1+h.x*p*.1,e[1]-d.y*g,e[2]-d.z*g+c.z*m*.1+h.z*p*.1),y=.7*l,x=_.current.set(e[0]+u.x*y+c.x*m*.2+h.x*p*.2,e[1]+u.y*y+(i?-(.15*l):-(.1*l))+c.y*m*.2+h.y*p*.2,e[2]+u.z*y+c.z*m*.2+h.z*p*.2),w=e=>"number"==typeof e&&isFinite(e)&&!isNaN(e)?e:0;return{v0:[w(v.x),w(v.y),w(v.z)],v1:[w(x.x),w(x.y),w(x.z)]}},C=(0,f.useRef)(new x.Vector3(0,0,0)),T=(0,f.useRef)(new x.Vector3(0,1,0)),N=(0,f.useRef)(new x.Vector3),k=(0,f.useRef)(new x.Vector3),R=(0,f.useRef)(new x.Vector3),F=(0,f.useRef)(new x.Vector3),z=(0,f.useRef)(new x.Vector3),L=(0,f.useRef)(new Map),G=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=nA(e);if(r)return r;let i=null,o=[];try{i=(0,nl.getStore)("selectedNodeStore",null);let e=(0,nl.getStore)("highlightedNodesStore",[]);o=Array.isArray(e)?e:[]}catch(e){}let a=(null==i?void 0:i.id)===e||o.includes(e),s=[];try{let e=(0,nl.getStore)("secondaryHighlightedArticlesStore",[]);s=Array.isArray(e)?e:[]}catch(e){}let l=s.includes(e),u=i&&i.id!==e&&!o.includes(e)&&!l,d=n?"".concat(n.position.x.toFixed(3),"-").concat(n.position.y.toFixed(3),"-").concat(n.position.z.toFixed(3)):"no-camera",c="".concat(e,"-").concat(t[0].toFixed(3),"-").concat(t[1].toFixed(3),"-").concat(t[2].toFixed(3),"-").concat(a?"1.3":u?"0.6":"1.0","-").concat(l?"secondary":"normal","-").concat(d),h=L.current.get(c);if(h&&!a&&!l)return h;let f=C.current,m=N.current.set(t[0],t[1],t[2]),p=k.current;(a||l)&&n?p.subVectors(n.position,m).normalize():p.subVectors(f,m).normalize();let g=T.current,v=R.current.crossVectors(g,p);.001>v.length()&&v.set(1,0,0),v.normalize();let y=F.current.crossVectors(p,v).normalize();Math.abs(p.dot(g))>.99&&(y.set(1,0,0),v.set(0,0,1));let x=e&&e.startsWith("A"),w=z.current;if(x){let t=nA(e);if(t)return t;let r=null,i=[],o=[];try{r=(0,nl.getStore)("selectedNodeStore",null);let e=(0,nl.getStore)("highlightedNodesStore",[]);i=Array.isArray(e)?e:[];let t=(0,nl.getStore)("secondaryHighlightedArticlesStore",[]);o=Array.isArray(t)?t:[]}catch(e){}Array.isArray(i)||(i=[]),Array.isArray(o)||(o=[]);let a=(null==r?void 0:r.id)===e||i.includes(e),s=o.includes(e),l=r&&r.id!==e&&!i.includes(e)&&!s,u=1;a?u=1.3:l&&(u=.6);let d=14.64*u;if((a||s)&&n){let t,r=k.current.subVectors(n.position,m).normalize(),i=T.current,o=R.current.crossVectors(i,r);.001>o.length()&&o.set(1,0,0),o.normalize();let l=F.current.crossVectors(r,o).normalize(),u=D.current.makeBasis(o,l,r),c=B.current.setFromRotationMatrix(u),h=b.current.set(0,0,1);h.applyQuaternion(c);let f=Math.acos(Math.max(-1,Math.min(1,h.dot(i))))*(180/Math.PI),p=Math.acos(Math.max(-1,Math.min(1,r.dot(i))))*(180/Math.PI);t=s?-(.5*(d/2+.1))/Math.max(.1,Math.cos(f*Math.PI/180)):-(.5*(d/1.2+.1));let g=O.current.set(0,t,0),v=P.current.copy(g).applyQuaternion(c),y=v.y-g.y,x=Math.sqrt(v.x*v.x+v.z*v.z);s&&console.log("%c[SECONDARY] Node: "+e,"color: orange; font-weight: bold; font-size: 14px;",{scaledTotalHeight:d.toFixed(3),bottomCenterOffset:t.toFixed(3),localBottom:"(".concat(g.x.toFixed(3),", ").concat(g.y.toFixed(3),", ").concat(g.z.toFixed(3),")"),rotatedBottom:"(".concat(v.x.toFixed(3),", ").concat(v.y.toFixed(3),", ").concat(v.z.toFixed(3),")"),offsetDiff:y.toFixed(3),horizontalOffset:x.toFixed(3),tiltAngle:f.toFixed(2)+"",tiltFromCamera:p.toFixed(2)+"",cameraPos:"(".concat(n.position.x.toFixed(2),", ").concat(n.position.y.toFixed(2),", ").concat(n.position.z.toFixed(2),")"),nodePos:"(".concat(m.x.toFixed(2),", ").concat(m.y.toFixed(2),", ").concat(m.z.toFixed(2),")"),directionToCamera:"(".concat(r.x.toFixed(3),", ").concat(r.y.toFixed(3),", ").concat(r.z.toFixed(3),")")}),a&&console.log("%c[HIGHLIGHTED] Node: "+e,"color: green; font-weight: bold; font-size: 14px;",{scaledTotalHeight:d.toFixed(3),bottomCenterOffset:t.toFixed(3),localBottom:"(".concat(g.x.toFixed(3),", ").concat(g.y.toFixed(3),", ").concat(g.z.toFixed(3),")"),rotatedBottom:"(".concat(v.x.toFixed(3),", ").concat(v.y.toFixed(3),", ").concat(v.z.toFixed(3),")"),offsetDiff:y.toFixed(3),horizontalOffset:x.toFixed(3),tiltAngle:f.toFixed(2)+"",tiltFromCamera:p.toFixed(2)+"",cameraPos:"(".concat(n.position.x.toFixed(2),", ").concat(n.position.y.toFixed(2),", ").concat(n.position.z.toFixed(2),")"),nodePos:"(".concat(m.x.toFixed(2),", ").concat(m.y.toFixed(2),", ").concat(m.z.toFixed(2),")"),directionToCamera:"(".concat(r.x.toFixed(3),", ").concat(r.y.toFixed(3),", ").concat(r.z.toFixed(3),")")}),w.copy(m),w.add(v)}else{let e;e=s?-(.5*(d/1.8+.15)):-(.5*(d/1.2+.1)),w.copy(m),w.addScaledVector(y,e)}}else w.copy(m).addScaledVector(y,-.2);let _=[w.x,w.y,w.z];return L.current.set(c,_),L.current.size>200&&L.current.clear(),_},U=(0,f.useRef)(new x.Vector3),I=(0,f.useRef)(new x.Vector3),O=(0,f.useRef)(new x.Vector3),P=(0,f.useRef)(new x.Vector3),B=(0,f.useRef)(new x.Quaternion),D=(0,f.useRef)(new x.Matrix4),W=(e,t,n,r,i,a,s,l)=>{let u=s&&s.startsWith("G");if(!e||!t||!Array.isArray(e)||!Array.isArray(t)||3!==e.length||3!==t.length||e.some(e=>"number"!=typeof e||isNaN(e)||!isFinite(e))||t.some(e=>"number"!=typeof e||isNaN(e)||!isFinite(e)))return null;let c=U.current.set(e[0],e[1],e[2]),h=I.current.set(t[0],t[1],t[2]),f=h.x-c.x,m=h.y-c.y,p=h.z-c.z,g=Math.sqrt(f*f+m*m+p*p);if(g<.01||!isFinite(g))return null;let v=j(e,t,n,a,u);if(!v||!v.v0||!v.v1||!Array.isArray(v.v0)||!Array.isArray(v.v1)||3!==v.v0.length||3!==v.v1.length||v.v0.some(e=>"number"!=typeof e||isNaN(e)||!isFinite(e))||v.v1.some(e=>"number"!=typeof e||isNaN(e)||!isFinite(e)))return null;let y="".concat(s,"-").concat(l,"-").concat(n);return(0,d.jsx)(nj,{start:e,end:t,v0:v.v0,v1:v.v1,index:n,totalConnections:r,color:i,shouldHide:!o},y)},H=(0,f.useMemo)(()=>{if(!(null==r?void 0:r.id)||!o)return[];let e=c(),t=e[r.id];if(!t||!Array.isArray(t)||3!==t.length)return[];let i=G(r.id,t,n);if(!i||!Array.isArray(i)||3!==i.length||i.some(e=>"number"!=typeof e||isNaN(e)||!isFinite(e)))return[];let a=[],d=r.id.startsWith("A"),h=s(r.id)||[],f=h.length;if(f>0)for(let t=0;t<f;t++){let o=h[t],s=e[o];if(!s)continue;let l=W(i,G(o,s,n),t,f,"#e9ff00",d&&o.startsWith("G"),r.id,o);l&&a.push(l)}if(d){let t=nS(r.id,l,u),i=new Set(l[r.id]||[]),o=0,s=0;for(let e=0;e<t.length;e++)s+=(l[t[e]]||[]).filter(e=>i.has(e)).length;for(let r=0;r<t.length;r++){let u=t[r],d=e[u];if(!d)continue;let c=(l[u]||[]).filter(e=>i.has(e));for(let t=0;t<c.length;t++){let r=c[t],i=e[r];if(!i)continue;let l=W(G(u,d,n),G(r,i,n),f+o,f+s,"#444444",!0,u,r);l&&(a.push(l),o++)}}}return a},[null==r?void 0:r.id,y,o,t,l,u]);return((0,f.useEffect)(()=>{(null==r?void 0:r.id)&&o&&0===H.length&&requestAnimationFrame(()=>{w(e=>e+1)})},[r,o,H.length]),H.length)?(0,d.jsx)("group",{frustumCulled:!1,children:H}):null},nT=function(){let{camera:t,gl:n}=(0,m.useThree)(),[r]=(0,nl.useStore)("selectedNodeStore",null),[i]=(0,nl.useStore)("highlightedNodesStore",[]),[o]=(0,nl.useStore)("secondaryHighlightedArticlesStore",[]),a=(0,f.useRef)(!1),s=(0,f.useRef)(null),l=(0,f.useRef)(!1);return(0,f.useEffect)(()=>{if(s.current=(0,nl.getStore)("elementOpacityStore"),!s.current){let{createStore:t}=e.r(77741);s.current=t("elementOpacityStore",{})}},[]),(0,f.useEffect)(()=>{var e,t,r;let i=()=>{a.current=!0,l.current=!1},o=()=>{},s=null==(r=n.domElement.parentElement)||null==(t=r.querySelector("canvas"))||null==(e=t.__r3f)?void 0:e.controls;if(s)return s.addEventListener("start",i),s.addEventListener("change",o),()=>{s.removeEventListener("start",i),s.removeEventListener("change",o)};let u=n.domElement,d=()=>{a.current=!0,l.current=!1};return u.addEventListener("mousedown",d),u.addEventListener("touchstart",d,{passive:!0}),()=>{u.removeEventListener("mousedown",d),u.removeEventListener("touchstart",d)}},[n]),(0,f.useEffect)(()=>{if(!s.current)return;if(!(null==r?void 0:r.id)||!Array.isArray(i)||0===i.length)return void s.current.setState({});let e=new Set(Array.isArray(o)?o:[]),t={},n=new Set(i),a=null==r?void 0:r.id,l=Array.from({length:29},(e,t)=>"A".concat(t+1)),u=Array.from({length:54},(e,t)=>"G".concat(t+1)),d=a?new Set(nc(a)):new Set;d.add(a),[...l,...u].forEach(r=>{let i=r.startsWith("G");r===a?t[r]=1:n.has(r)?(d.has(r),t[r]=1):(e.has(r),t[r]=i?.3:.15)}),s.current.setState(t)},[r,i,o]),(0,f.useEffect)(()=>{l.current||(a.current=!1)},[r]),null};var nN=e.i(19507),nk=e.i(50144),nR=e.i(22016),nF=e.i(18566),nz=e.i(25547);function nL(e){let{close:t}=e,n=(0,nF.usePathname)(),[r,i]=f.useState(null),[o,a]=f.useState(!0);f.useEffect(()=>{(async()=>{try{let e=await fetch("/data/info.json");if(!e.ok)throw Error("Failed to load info data");let t=await e.json(),r=t["/"===n?"/":n]||t["/living-continuity"];i(r)}catch(e){console.error("Error loading info data:",e),i({title:"Welcome",content:"To navigate in the digital exhibition, depending on the device you are currently browsing this space on you can use both your fingers or mouse. Zoom in or out, drag or pan to interact with the scene."})}finally{a(!1)}})()},[n]);let s=e=>e?e.split(/(\*[^*]+\*)/g).map((e,t)=>e.startsWith("*")&&e.endsWith("*")?(0,d.jsx)("em",{children:e.slice(1,-1)},t):(0,d.jsx)(f.Fragment,{children:e},t)):null;return o?(0,d.jsx)("div",{className:nz.default.modal_wrapper,children:(0,d.jsx)("div",{className:nz.default.content,children:(0,d.jsx)("p",{children:"Loading..."})})}):r?(0,d.jsx)(d.Fragment,{children:(0,d.jsxs)("div",{className:nz.default.modal_wrapper,children:[t&&(0,d.jsx)("div",{className:nz.default.close_button,onClick:t,children:(0,d.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,d.jsx)("line",{x1:"3",y1:"3",x2:"21",y2:"21",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round"}),(0,d.jsx)("line",{x1:"21",y1:"3",x2:"3",y2:"21",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round"})]})}),(0,d.jsx)("div",{className:nz.default.content,children:r.content&&("string"==typeof r.content?(0,d.jsx)("p",{children:s(r.content)}):Array.isArray(r.content)?r.content.map((e,t)=>(0,d.jsx)("div",{children:e.text&&(0,d.jsx)("p",{children:s(e.text)})},t)):null)})]})}):null}var nG=e.i(60796);function nU(){return(0,d.jsx)(d.Fragment,{children:(0,d.jsx)("div",{className:nG.default.camera_wrapper,children:(0,d.jsxs)("div",{className:"".concat(nG.default.camera_modal," button"),children:[(0,d.jsx)("a",{href:"https://livingcontinuity.publicdisplay.site/",className:nG.default.link,children:(0,d.jsx)("div",{className:nG.default.item,children:"Digital Exhibition"})}),(0,d.jsx)("a",{href:"https://glossary.publicdisplay.site/",className:nG.default.link,children:(0,d.jsx)("div",{className:nG.default.item,children:"Glossary"})}),(0,d.jsx)("a",{href:"https://kitofparts.publicdisplay.site/",className:nG.default.link,children:(0,d.jsx)("div",{className:nG.default.item,children:"Kit of Parts - Blended Home"})}),(0,d.jsx)("a",{href:"#",className:nG.default.link,children:(0,d.jsx)("div",{className:nG.default.item,children:"Kit of Parts - Blended Park (soon)"})}),(0,d.jsx)("a",{href:"https://supplement.publicdisplay.site/",className:nG.default.link,children:(0,d.jsx)("div",{className:nG.default.item,children:"Supplement"})}),(0,d.jsx)("a",{href:"http://toolkit.publicdisplay.site/",className:nG.default.link,children:(0,d.jsx)("div",{className:nG.default.item,children:"Toolkit"})})]})})})}function nI(e){let{title:t}=e,[n,r]=f.useState(!1);f.useEffect(()=>{"Title Of The Entry"==t||""==t?r(!1):r(!0)},[t]);let[i,o]=f.useState(!1);function a(){o(!i)}let[s,l]=f.useState(!1);return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:"isDesktop",children:(0,d.jsxs)("div",{className:nk.default.topbar_wrapper,children:[(0,d.jsx)(nR.default,{href:"/living-continuity",children:(0,d.jsx)("div",{className:"".concat(nk.default.button," button"),children:"living continuity"})}),(0,d.jsx)("div",{className:"".concat(nk.default.title," button"),children:"Title Of The Entry"!=t&&""!=t&&(0,d.jsx)("span",{children:t})}),(0,d.jsx)("div",{className:"".concat(nk.default.button," button"),children:"Living Continuity"})]})}),(0,d.jsx)("div",{className:"isMobile",children:(0,d.jsxs)("div",{className:"".concat(nk.default.topbar_wrapper," ").concat(nk.default.topbar_wrapper_mobile),children:[(0,d.jsxs)("div",{className:nk.default.wrapper,onClick:()=>l(!s),role:"button",tabIndex:0,"aria-label":"Toggle scene modal",onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&l(!s)},children:[(0,d.jsx)("div",{className:"".concat(nk.default.full," ").concat(nk.default.button," button full_button"),children:"living continuity"}),(0,d.jsx)("div",{className:"".concat(s?"closed":"open"),children:(0,d.jsx)(nU,{})}),(0,d.jsx)("div",{className:"".concat(nk.default.full," ").concat(nk.default.button," button full_button"),children:"Living Continuity"}),(0,d.jsx)("button",{className:"".concat(nk.default.half," ").concat(nk.default.button," button"),onClick:()=>{a()},"aria-label":"Open info modal",children:"info"})]}),(0,d.jsx)("div",{className:"".concat(nk.default.title," button"),children:"Title Of The Entry"!=t&&""!=t&&(0,d.jsx)("span",{children:t})})]})}),(0,d.jsx)(nN.default,{isOpen:i,contentLabel:"Example Modal",closeTimeoutMS:150,shouldCloseOnOverlayClick:!0,children:(0,d.jsx)(nL,{close:a})})]})}let nO=f.memo(e=>{let{onClick:t}=e;return(0,d.jsxs)("div",{className:"living_continuity_button",onClick:t,children:[(0,d.jsx)("div",{className:"black_box",children:(0,d.jsx)("h1",{className:"main_text",children:"LIVING CONTINUITY"})}),(0,d.jsx)("span",{className:"enter_text",children:"enter"})]})});nO.displayName="LivingContinuityButton";var nP={value:()=>{}};function nB(){for(var e,t=0,n=arguments.length,r={};t<n;++t){if(!(e=arguments[t]+"")||e in r||/[\s.]/.test(e))throw Error("illegal type: "+e);r[e]=[]}return new nD(r)}function nD(e){this._=e}function nW(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=nP,e=e.slice(0,r).concat(e.slice(r+1));break}return null!=n&&e.push({name:t,value:n}),e}function nH(){}function nV(e){return null==e?nH:function(){return this.querySelector(e)}}function nq(){return[]}function nX(e){return null==e?nq:function(){return this.querySelectorAll(e)}}function nY(e){return function(){return this.matches(e)}}function nJ(e){return function(t){return t.matches(e)}}nD.prototype=nB.prototype={constructor:nD,on:function(e,t){var n,r=this._,i=(e+"").trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");if(n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),e&&!r.hasOwnProperty(e))throw Error("unknown type: "+e);return{type:e,name:t}}),o=-1,a=i.length;if(arguments.length<2){for(;++o<a;)if((n=(e=i[o]).type)&&(n=function(e,t){for(var n,r=0,i=e.length;r<i;++r)if((n=e[r]).name===t)return n.value}(r[n],e.name)))return n;return}if(null!=t&&"function"!=typeof t)throw Error("invalid callback: "+t);for(;++o<a;)if(n=(e=i[o]).type)r[n]=nW(r[n],e.name,t);else if(null==t)for(n in r)r[n]=nW(r[n],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new nD(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,r,i=Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw Error("unknown type: "+e);for(r=this._[e],o=0,n=r.length;o<n;++o)r[o].value.apply(t,i)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw Error("unknown type: "+e);for(var r=this._[e],i=0,o=r.length;i<o;++i)r[i].value.apply(t,n)}};var nZ=Array.prototype.find;function nQ(){return this.firstElementChild}var n$=Array.prototype.filter;function nK(){return Array.from(this.children)}function n0(e){return Array(e.length)}function n1(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}function n2(e,t,n,r,i,o){for(var a,s=0,l=t.length,u=o.length;s<u;++s)(a=t[s])?(a.__data__=o[s],r[s]=a):n[s]=new n1(e,o[s]);for(;s<l;++s)(a=t[s])&&(i[s]=a)}function n3(e,t,n,r,i,o,a){var s,l,u,d=new Map,c=t.length,h=o.length,f=Array(c);for(s=0;s<c;++s)(l=t[s])&&(f[s]=u=a.call(l,l.__data__,s,t)+"",d.has(u)?i[s]=l:d.set(u,l));for(s=0;s<h;++s)u=a.call(e,o[s],s,o)+"",(l=d.get(u))?(r[s]=l,l.__data__=o[s],d.delete(u)):n[s]=new n1(e,o[s]);for(s=0;s<c;++s)(l=t[s])&&d.get(f[s])===l&&(i[s]=l)}function n5(e){return e.__data__}function n4(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}n1.prototype={constructor:n1,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};var n8="http://www.w3.org/1999/xhtml";let n6={svg:"http://www.w3.org/2000/svg",xhtml:n8,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function n7(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),n6.hasOwnProperty(t)?{space:n6[t],local:e}:e}function n9(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function re(e,t){return e.style.getPropertyValue(t)||n9(e).getComputedStyle(e,null).getPropertyValue(t)}function rt(e){return e.trim().split(/^|\s+/)}function rn(e){return e.classList||new rr(e)}function rr(e){this._node=e,this._names=rt(e.getAttribute("class")||"")}function ri(e,t){for(var n=rn(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function ro(e,t){for(var n=rn(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function ra(){this.textContent=""}function rs(){this.innerHTML=""}function rl(){this.nextSibling&&this.parentNode.appendChild(this)}function ru(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function rd(e){var t=n7(e);return(t.local?function(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}:function(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===n8&&t.documentElement.namespaceURI===n8?t.createElement(e):t.createElementNS(n,e)}})(t)}function rc(){return null}function rh(){var e=this.parentNode;e&&e.removeChild(this)}function rf(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function rm(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function rp(e){return function(){var t=this.__on;if(t){for(var n,r=0,i=-1,o=t.length;r<o;++r)(n=t[r],e.type&&n.type!==e.type||n.name!==e.name)?t[++i]=n:this.removeEventListener(n.type,n.listener,n.options);++i?t.length=i:delete this.__on}}}function rg(e,t,n){return function(){var r,i=this.__on,o=function(e){t.call(this,e,this.__data__)};if(i){for(var a=0,s=i.length;a<s;++a)if((r=i[a]).type===e.type&&r.name===e.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=o,r.options=n),r.value=t;return}}this.addEventListener(e.type,o,n),r={type:e.type,name:e.name,value:t,listener:o,options:n},i?i.push(r):this.__on=[r]}}function rv(e,t,n){var r=n9(e),i=r.CustomEvent;"function"==typeof i?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}rr.prototype={add:function(e){0>this._names.indexOf(e)&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var ry=[null];function rx(e,t){this._groups=e,this._parents=t}function rw(){return new rx([[document.documentElement]],ry)}function r_(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function rA(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function rS(){}rx.prototype=rw.prototype={constructor:rx,select:function(e){"function"!=typeof e&&(e=nV(e));for(var t=this._groups,n=t.length,r=Array(n),i=0;i<n;++i)for(var o,a,s=t[i],l=s.length,u=r[i]=Array(l),d=0;d<l;++d)(o=s[d])&&(a=e.call(o,o.__data__,d,s))&&("__data__"in o&&(a.__data__=o.__data__),u[d]=a);return new rx(r,this._parents)},selectAll:function(e){if("function"==typeof e){var t;t=e,e=function(){var e;return e=t.apply(this,arguments),null==e?[]:Array.isArray(e)?e:Array.from(e)}}else e=nX(e);for(var n=this._groups,r=n.length,i=[],o=[],a=0;a<r;++a)for(var s,l=n[a],u=l.length,d=0;d<u;++d)(s=l[d])&&(i.push(e.call(s,s.__data__,d,l)),o.push(s));return new rx(i,o)},selectChild:function(e){var t;return this.select(null==e?nQ:(t="function"==typeof e?e:nJ(e),function(){return nZ.call(this.children,t)}))},selectChildren:function(e){var t;return this.selectAll(null==e?nK:(t="function"==typeof e?e:nJ(e),function(){return n$.call(this.children,t)}))},filter:function(e){"function"!=typeof e&&(e=nY(e));for(var t=this._groups,n=t.length,r=Array(n),i=0;i<n;++i)for(var o,a=t[i],s=a.length,l=r[i]=[],u=0;u<s;++u)(o=a[u])&&e.call(o,o.__data__,u,a)&&l.push(o);return new rx(r,this._parents)},data:function(e,t){if(!arguments.length)return Array.from(this,n5);var n=t?n3:n2,r=this._parents,i=this._groups;"function"!=typeof e&&(y=e,e=function(){return y});for(var o=i.length,a=Array(o),s=Array(o),l=Array(o),u=0;u<o;++u){var d=r[u],c=i[u],h=c.length,f="object"==typeof(v=e.call(d,d&&d.__data__,u,r))&&"length"in v?v:Array.from(v),m=f.length,p=s[u]=Array(m),g=a[u]=Array(m);n(d,c,p,g,l[u]=Array(h),f,t);for(var v,y,x,w,_=0,A=0;_<m;++_)if(x=p[_]){for(_>=A&&(A=_+1);!(w=g[A])&&++A<m;);x._next=w||null}}return(a=new rx(a,r))._enter=s,a._exit=l,a},enter:function(){return new rx(this._enter||this._groups.map(n0),this._parents)},exit:function(){return new rx(this._exit||this._groups.map(n0),this._parents)},join:function(e,t,n){var r=this.enter(),i=this,o=this.exit();return"function"==typeof e?(r=e(r))&&(r=r.selection()):r=r.append(e+""),null!=t&&(i=t(i))&&(i=i.selection()),null==n?o.remove():n(o),r&&i?r.merge(i).order():i},merge:function(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,o=r.length,a=Math.min(i,o),s=Array(i),l=0;l<a;++l)for(var u,d=n[l],c=r[l],h=d.length,f=s[l]=Array(h),m=0;m<h;++m)(u=d[m]||c[m])&&(f[m]=u);for(;l<i;++l)s[l]=n[l];return new rx(s,this._parents)},selection:function(){return this},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r,i=e[t],o=i.length-1,a=i[o];--o>=0;)(r=i[o])&&(a&&4^r.compareDocumentPosition(a)&&a.parentNode.insertBefore(r,a),a=r);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=n4);for(var n=this._groups,r=n.length,i=Array(r),o=0;o<r;++o){for(var a,s=n[o],l=s.length,u=i[o]=Array(l),d=0;d<l;++d)(a=s[d])&&(u[d]=a);u.sort(t)}return new rx(i,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null},size:function(){let e=0;for(let t of this)++e;return e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i,o=t[n],a=0,s=o.length;a<s;++a)(i=o[a])&&e.call(i,i.__data__,a,o);return this},attr:function(e,t){var n=n7(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==t?n.local?function(e){return function(){this.removeAttributeNS(e.space,e.local)}}:function(e){return function(){this.removeAttribute(e)}}:"function"==typeof t?n.local?function(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}:function(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}:n.local?function(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}:function(e,t){return function(){this.setAttribute(e,t)}})(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?function(e){return function(){this.style.removeProperty(e)}}:"function"==typeof t?function(e,t,n){return function(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}:function(e,t,n){return function(){this.style.setProperty(e,t,n)}})(e,t,null==n?"":n)):re(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?function(e){return function(){delete this[e]}}:"function"==typeof t?function(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}:function(e,t){return function(){this[e]=t}})(e,t)):this.node()[e]},classed:function(e,t){var n=rt(e+"");if(arguments.length<2){for(var r=rn(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof t?function(e,t){return function(){(t.apply(this,arguments)?ri:ro)(this,e)}}:t?function(e){return function(){ri(this,e)}}:function(e){return function(){ro(this,e)}})(n,t))},text:function(e){return arguments.length?this.each(null==e?ra:("function"==typeof e?function(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}:function(e){return function(){this.textContent=e}})(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?rs:("function"==typeof e?function(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}:function(e){return function(){this.innerHTML=e}})(e)):this.node().innerHTML},raise:function(){return this.each(rl)},lower:function(){return this.each(ru)},append:function(e){var t="function"==typeof e?e:rd(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})},insert:function(e,t){var n="function"==typeof e?e:rd(e),r=null==t?rc:"function"==typeof t?t:nV(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})},remove:function(){return this.each(rh)},clone:function(e){return this.select(e?rm:rf)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var r,i,o=(e+"").trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}}),a=o.length;if(arguments.length<2){var s=this.node().__on;if(s){for(var l,u=0,d=s.length;u<d;++u)for(r=0,l=s[u];r<a;++r)if((i=o[r]).type===l.type&&i.name===l.name)return l.value}return}for(r=0,s=t?rg:rp;r<a;++r)this.each(s(o[r],t,n));return this},dispatch:function(e,t){return this.each(("function"==typeof t?function(e,t){return function(){return rv(this,e,t.apply(this,arguments))}}:function(e,t){return function(){return rv(this,e,t)}})(e,t))},[Symbol.iterator]:function*(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r,i=e[t],o=0,a=i.length;o<a;++o)(r=i[o])&&(yield r)}};var rb="\\s*([+-]?\\d+)\\s*",rM="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",rE="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",rj=/^#([0-9a-f]{3,8})$/,rC=new RegExp("^rgb\\(".concat(rb,",").concat(rb,",").concat(rb,"\\)$")),rT=new RegExp("^rgb\\(".concat(rE,",").concat(rE,",").concat(rE,"\\)$")),rN=new RegExp("^rgba\\(".concat(rb,",").concat(rb,",").concat(rb,",").concat(rM,"\\)$")),rk=new RegExp("^rgba\\(".concat(rE,",").concat(rE,",").concat(rE,",").concat(rM,"\\)$")),rR=new RegExp("^hsl\\(".concat(rM,",").concat(rE,",").concat(rE,"\\)$")),rF=new RegExp("^hsla\\(".concat(rM,",").concat(rE,",").concat(rE,",").concat(rM,"\\)$")),rz={aliceblue:0xf0f8ff,antiquewhite:0xfaebd7,aqua:65535,aquamarine:8388564,azure:0xf0ffff,beige:0xf5f5dc,bisque:0xffe4c4,black:0,blanchedalmond:0xffebcd,blue:255,blueviolet:9055202,brown:0xa52a2a,burlywood:0xdeb887,cadetblue:6266528,chartreuse:8388352,chocolate:0xd2691e,coral:0xff7f50,cornflowerblue:6591981,cornsilk:0xfff8dc,crimson:0xdc143c,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:0xb8860b,darkgray:0xa9a9a9,darkgreen:25600,darkgrey:0xa9a9a9,darkkhaki:0xbdb76b,darkmagenta:9109643,darkolivegreen:5597999,darkorange:0xff8c00,darkorchid:0x9932cc,darkred:9109504,darksalmon:0xe9967a,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:0xff1493,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:0xb22222,floralwhite:0xfffaf0,forestgreen:2263842,fuchsia:0xff00ff,gainsboro:0xdcdcdc,ghostwhite:0xf8f8ff,gold:0xffd700,goldenrod:0xdaa520,gray:8421504,green:32768,greenyellow:0xadff2f,grey:8421504,honeydew:0xf0fff0,hotpink:0xff69b4,indianred:0xcd5c5c,indigo:4915330,ivory:0xfffff0,khaki:0xf0e68c,lavender:0xe6e6fa,lavenderblush:0xfff0f5,lawngreen:8190976,lemonchiffon:0xfffacd,lightblue:0xadd8e6,lightcoral:0xf08080,lightcyan:0xe0ffff,lightgoldenrodyellow:0xfafad2,lightgray:0xd3d3d3,lightgreen:9498256,lightgrey:0xd3d3d3,lightpink:0xffb6c1,lightsalmon:0xffa07a,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:0xb0c4de,lightyellow:0xffffe0,lime:65280,limegreen:3329330,linen:0xfaf0e6,magenta:0xff00ff,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:0xba55d3,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:0xc71585,midnightblue:1644912,mintcream:0xf5fffa,mistyrose:0xffe4e1,moccasin:0xffe4b5,navajowhite:0xffdead,navy:128,oldlace:0xfdf5e6,olive:8421376,olivedrab:7048739,orange:0xffa500,orangered:0xff4500,orchid:0xda70d6,palegoldenrod:0xeee8aa,palegreen:0x98fb98,paleturquoise:0xafeeee,palevioletred:0xdb7093,papayawhip:0xffefd5,peachpuff:0xffdab9,peru:0xcd853f,pink:0xffc0cb,plum:0xdda0dd,powderblue:0xb0e0e6,purple:8388736,rebeccapurple:6697881,red:0xff0000,rosybrown:0xbc8f8f,royalblue:4286945,saddlebrown:9127187,salmon:0xfa8072,sandybrown:0xf4a460,seagreen:3050327,seashell:0xfff5ee,sienna:0xa0522d,silver:0xc0c0c0,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:0xfffafa,springgreen:65407,steelblue:4620980,tan:0xd2b48c,teal:32896,thistle:0xd8bfd8,tomato:0xff6347,turquoise:4251856,violet:0xee82ee,wheat:0xf5deb3,white:0xffffff,whitesmoke:0xf5f5f5,yellow:0xffff00,yellowgreen:0x9acd32};function rL(){return this.rgb().formatHex()}function rG(){return this.rgb().formatRgb()}function rU(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=rj.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?rI(t):3===n?new rB(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?rO(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?rO(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=rC.exec(e))?new rB(t[1],t[2],t[3],1):(t=rT.exec(e))?new rB(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=rN.exec(e))?rO(t[1],t[2],t[3],t[4]):(t=rk.exec(e))?rO(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=rR.exec(e))?rX(t[1],t[2]/100,t[3]/100,1):(t=rF.exec(e))?rX(t[1],t[2]/100,t[3]/100,t[4]):rz.hasOwnProperty(e)?rI(rz[e]):"transparent"===e?new rB(NaN,NaN,NaN,0):null}function rI(e){return new rB(e>>16&255,e>>8&255,255&e,1)}function rO(e,t,n,r){return r<=0&&(e=t=n=NaN),new rB(e,t,n,r)}function rP(e,t,n,r){var i;return 1==arguments.length?((i=e)instanceof rS||(i=rU(i)),i)?new rB((i=i.rgb()).r,i.g,i.b,i.opacity):new rB:new rB(e,t,n,null==r?1:r)}function rB(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function rD(){return"#".concat(rq(this.r)).concat(rq(this.g)).concat(rq(this.b))}function rW(){let e=rH(this.opacity);return"".concat(1===e?"rgb(":"rgba(").concat(rV(this.r),", ").concat(rV(this.g),", ").concat(rV(this.b)).concat(1===e?")":", ".concat(e,")"))}function rH(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function rV(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function rq(e){return((e=rV(e))<16?"0":"")+e.toString(16)}function rX(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new rJ(e,t,n,r)}function rY(e){if(e instanceof rJ)return new rJ(e.h,e.s,e.l,e.opacity);if(e instanceof rS||(e=rU(e)),!e)return new rJ;if(e instanceof rJ)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),a=NaN,s=o-i,l=(o+i)/2;return s?(a=t===o?(n-r)/s+(n<r)*6:n===o?(r-t)/s+2:(t-n)/s+4,s/=l<.5?o+i:2-o-i,a*=60):s=l>0&&l<1?0:a,new rJ(a,s,l,e.opacity)}function rJ(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function rZ(e){return(e=(e||0)%360)<0?e+360:e}function rQ(e){return Math.max(0,Math.min(1,e||0))}function r$(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}function rK(e,t,n,r,i){var o=e*e,a=o*e;return((1-3*e+3*o-a)*t+(4-6*o+3*a)*n+(1+3*e+3*o-3*a)*r+a*i)/6}r_(rS,rU,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:rL,formatHex:rL,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return rY(this).formatHsl()},formatRgb:rG,toString:rG}),r_(rB,rP,rA(rS,{brighter(e){return e=null==e?1.4285714285714286:Math.pow(1.4285714285714286,e),new rB(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?.7:Math.pow(.7,e),new rB(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new rB(rV(this.r),rV(this.g),rV(this.b),rH(this.opacity))},displayable(){return -.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:rD,formatHex:rD,formatHex8:function(){return"#".concat(rq(this.r)).concat(rq(this.g)).concat(rq(this.b)).concat(rq((isNaN(this.opacity)?1:this.opacity)*255))},formatRgb:rW,toString:rW})),r_(rJ,function(e,t,n,r){return 1==arguments.length?rY(e):new rJ(e,t,n,null==r?1:r)},rA(rS,{brighter(e){return e=null==e?1.4285714285714286:Math.pow(1.4285714285714286,e),new rJ(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?.7:Math.pow(.7,e),new rJ(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new rB(r$(e>=240?e-240:e+120,i,r),r$(e,i,r),r$(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new rJ(rZ(this.h),rQ(this.s),rQ(this.l),rH(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let e=rH(this.opacity);return"".concat(1===e?"hsl(":"hsla(").concat(rZ(this.h),", ").concat(100*rQ(this.s),"%, ").concat(100*rQ(this.l),"%").concat(1===e?")":", ".concat(e,")"))}}));let r0=e=>()=>e;function r1(e,t){var n=t-e;return n?function(t){return e+t*n}:r0(isNaN(e)?t:e)}let r2=function e(t){var n,r=1==(n=+t)?r1:function(e,t){var r,i,o;return t-e?(r=e,i=t,r=Math.pow(r,o=n),i=Math.pow(i,o)-r,o=1/o,function(e){return Math.pow(r+e*i,o)}):r0(isNaN(e)?t:e)};function i(e,t){var n=r((e=rP(e)).r,(t=rP(t)).r),i=r(e.g,t.g),o=r(e.b,t.b),a=r1(e.opacity,t.opacity);return function(t){return e.r=n(t),e.g=i(t),e.b=o(t),e.opacity=a(t),e+""}}return i.gamma=e,i}(1);function r3(e){return function(t){var n,r,i=t.length,o=Array(i),a=Array(i),s=Array(i);for(n=0;n<i;++n)r=rP(t[n]),o[n]=r.r||0,a[n]=r.g||0,s[n]=r.b||0;return o=e(o),a=e(a),s=e(s),r.opacity=1,function(e){return r.r=o(e),r.g=a(e),r.b=s(e),r+""}}}function r5(e,t){return e*=1,t*=1,function(n){return e*(1-n)+t*n}}r3(function(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],o=e[r+1],a=r>0?e[r-1]:2*i-o,s=r<t-1?e[r+2]:2*o-i;return rK((n-r/t)*t,a,i,o,s)}}),r3(function(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],o=e[r%t],a=e[(r+1)%t],s=e[(r+2)%t];return rK((n-r/t)*t,i,o,a,s)}});var r4,r8,r6=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,r7=RegExp(r6.source,"g"),r9=0,ie=0,it=0,ir=0,ii=0,io=0,ia="object"==typeof performance&&performance.now?performance:Date,is="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function il(){return ii||(is(iu),ii=ia.now()+io)}function iu(){ii=0}function id(){this._call=this._time=this._next=null}function ic(e,t,n){var r=new id;return r.restart(e,t,n),r}function ih(){ii=(ir=ia.now())+io,r9=ie=0;try{il(),++r9;for(var e,t=r4;t;)(e=ii-t._time)>=0&&t._call.call(void 0,e),t=t._next;--r9}finally{r9=0,function(){for(var e,t,n=r4,r=1/0;n;)n._call?(r>n._time&&(r=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:r4=t);r8=e,ip(r)}(),ii=0}}function im(){var e=ia.now(),t=e-ir;t>1e3&&(io-=t,ir=e)}function ip(e){!r9&&(ie&&(ie=clearTimeout(ie)),e-ii>24?(e<1/0&&(ie=setTimeout(ih,e-ia.now()-io)),it&&(it=clearInterval(it))):(it||(ir=ia.now(),it=setInterval(im,1e3)),r9=1,is(ih)))}function ig(e,t,n){var r=new id;return t=null==t?0:+t,r.restart(n=>{r.stop(),e(n+t)},t,n),r}id.prototype=ic.prototype={constructor:id,restart:function(e,t,n){if("function"!=typeof e)throw TypeError("callback is not a function");n=(null==n?il():+n)+(null==t?0:+t),this._next||r8===this||(r8?r8._next=this:r4=this,r8=this),this._call=e,this._time=n,ip()},stop:function(){this._call&&(this._call=null,this._time=1/0,ip())}};var iv=nB("start","end","cancel","interrupt"),iy=[];function ix(e,t,n,r,i,o){var a=e.__transition;if(a){if(n in a)return}else e.__transition={};!function(e,t,n){var r,i=e.__transition;function o(l){var u,d,c,h;if(1!==n.state)return s();for(u in i)if((h=i[u]).name===n.name){if(3===h.state)return ig(o);4===h.state?(h.state=6,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete i[u]):+u<t&&(h.state=6,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete i[u])}if(ig(function(){3===n.state&&(n.state=4,n.timer.restart(a,n.delay,n.time),a(l))}),n.state=2,n.on.call("start",e,e.__data__,n.index,n.group),2===n.state){for(u=0,n.state=3,r=Array(c=n.tween.length),d=-1;u<c;++u)(h=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(r[++d]=h);r.length=d+1}}function a(t){for(var i=t<n.duration?n.ease.call(null,t/n.duration):(n.timer.restart(s),n.state=5,1),o=-1,a=r.length;++o<a;)r[o].call(e,i);5===n.state&&(n.on.call("end",e,e.__data__,n.index,n.group),s())}function s(){for(var r in n.state=6,n.timer.stop(),delete i[t],i)return;delete e.__transition}i[t]=n,n.timer=ic(function(e){n.state=1,n.timer.restart(o,n.delay,n.time),n.delay<=e&&o(e-n.delay)},0,n.time)}(e,n,{name:t,index:r,group:i,on:iv,tween:iy,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:0})}function iw(e,t){var n=iA(e,t);if(n.state>0)throw Error("too late; already scheduled");return n}function i_(e,t){var n=iA(e,t);if(n.state>3)throw Error("too late; already running");return n}function iA(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw Error("transition not found");return n}var iS=180/Math.PI,ib={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function iM(e,t,n,r,i,o){var a,s,l;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,l/=s),e*r<t*n&&(e=-e,t=-t,l=-l,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(t,e)*iS,skewX:Math.atan(l)*iS,scaleX:a,scaleY:s}}function iE(e,t,n,r){function i(e){return e.length?e.pop()+" ":""}return function(o,a){var s,l,u,d,c=[],h=[];return o=e(o),a=e(a),!function(e,r,i,o,a,s){if(e!==i||r!==o){var l=a.push("translate(",null,t,null,n);s.push({i:l-4,x:r5(e,i)},{i:l-2,x:r5(r,o)})}else(i||o)&&a.push("translate("+i+t+o+n)}(o.translateX,o.translateY,a.translateX,a.translateY,c,h),s=o.rotate,l=a.rotate,s!==l?(s-l>180?l+=360:l-s>180&&(s+=360),h.push({i:c.push(i(c)+"rotate(",null,r)-2,x:r5(s,l)})):l&&c.push(i(c)+"rotate("+l+r),u=o.skewX,d=a.skewX,u!==d?h.push({i:c.push(i(c)+"skewX(",null,r)-2,x:r5(u,d)}):d&&c.push(i(c)+"skewX("+d+r),!function(e,t,n,r,o,a){if(e!==n||t!==r){var s=o.push(i(o)+"scale(",null,",",null,")");a.push({i:s-4,x:r5(e,n)},{i:s-2,x:r5(t,r)})}else(1!==n||1!==r)&&o.push(i(o)+"scale("+n+","+r+")")}(o.scaleX,o.scaleY,a.scaleX,a.scaleY,c,h),o=a=null,function(e){for(var t,n=-1,r=h.length;++n<r;)c[(t=h[n]).i]=t.x(e);return c.join("")}}}var ij=iE(function(e){let t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?ib:iM(t.a,t.b,t.c,t.d,t.e,t.f)},"px, ","px)","deg)"),iC=iE(function(e){return null==e?ib:(l||(l=document.createElementNS("http://www.w3.org/2000/svg","g")),l.setAttribute("transform",e),e=l.transform.baseVal.consolidate())?iM((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):ib},", ",")",")");function iT(e,t,n){var r=e._id;return e.each(function(){var e=i_(this,r);(e.value||(e.value={}))[t]=n.apply(this,arguments)}),function(e){return iA(e,r).value[t]}}function iN(e,t){var n;return("number"==typeof t?r5:t instanceof rU?r2:(n=rU(t))?(t=n,r2):function(e,t){var n,r,i,o,a,s=r6.lastIndex=r7.lastIndex=0,l=-1,u=[],d=[];for(e+="",t+="";(i=r6.exec(e))&&(o=r7.exec(t));)(a=o.index)>s&&(a=t.slice(s,a),u[l]?u[l]+=a:u[++l]=a),(i=i[0])===(o=o[0])?u[l]?u[l]+=o:u[++l]=o:(u[++l]=null,d.push({i:l,x:r5(i,o)})),s=r7.lastIndex;return s<t.length&&(a=t.slice(s),u[l]?u[l]+=a:u[++l]=a),u.length<2?d[0]?(n=d[0].x,function(e){return n(e)+""}):(r=t,function(){return r}):(t=d.length,function(e){for(var n,r=0;r<t;++r)u[(n=d[r]).i]=n.x(e);return u.join("")})})(e,t)}var ik=rw.prototype.constructor;function iR(e){return function(){this.style.removeProperty(e)}}var iF=0;function iz(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}var iL=rw.prototype;iz.prototype=(function(e){return rw().transition(e)}).prototype={constructor:iz,select:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=nV(e));for(var r=this._groups,i=r.length,o=Array(i),a=0;a<i;++a)for(var s,l,u=r[a],d=u.length,c=o[a]=Array(d),h=0;h<d;++h)(s=u[h])&&(l=e.call(s,s.__data__,h,u))&&("__data__"in s&&(l.__data__=s.__data__),c[h]=l,ix(c[h],t,n,h,c,iA(s,n)));return new iz(o,this._parents,t,n)},selectAll:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=nX(e));for(var r=this._groups,i=r.length,o=[],a=[],s=0;s<i;++s)for(var l,u=r[s],d=u.length,c=0;c<d;++c)if(l=u[c]){for(var h,f=e.call(l,l.__data__,c,u),m=iA(l,n),p=0,g=f.length;p<g;++p)(h=f[p])&&ix(h,t,n,p,f,m);o.push(f),a.push(l)}return new iz(o,a,t,n)},selectChild:iL.selectChild,selectChildren:iL.selectChildren,filter:function(e){"function"!=typeof e&&(e=nY(e));for(var t=this._groups,n=t.length,r=Array(n),i=0;i<n;++i)for(var o,a=t[i],s=a.length,l=r[i]=[],u=0;u<s;++u)(o=a[u])&&e.call(o,o.__data__,u,a)&&l.push(o);return new iz(r,this._parents,this._name,this._id)},merge:function(e){if(e._id!==this._id)throw Error();for(var t=this._groups,n=e._groups,r=t.length,i=n.length,o=Math.min(r,i),a=Array(r),s=0;s<o;++s)for(var l,u=t[s],d=n[s],c=u.length,h=a[s]=Array(c),f=0;f<c;++f)(l=u[f]||d[f])&&(h[f]=l);for(;s<r;++s)a[s]=t[s];return new iz(a,this._parents,this._name,this._id)},selection:function(){return new ik(this._groups,this._parents)},transition:function(){for(var e=this._name,t=this._id,n=++iF,r=this._groups,i=r.length,o=0;o<i;++o)for(var a,s=r[o],l=s.length,u=0;u<l;++u)if(a=s[u]){var d=iA(a,t);ix(a,e,n,u,s,{time:d.time+d.delay+d.duration,delay:0,duration:d.duration,ease:d.ease})}return new iz(r,this._parents,e,n)},call:iL.call,nodes:iL.nodes,node:iL.node,size:iL.size,empty:iL.empty,each:iL.each,on:function(e,t){var n,r,i,o,a,s,l=this._id;return arguments.length<2?iA(this.node(),l).on.on(e):this.each((n=l,r=e,i=t,s=(r+"").trim().split(/^|\s+/).every(function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||"start"===e})?iw:i_,function(){var e=s(this,n),t=e.on;t!==o&&(a=(o=t).copy()).on(r,i),e.on=a}))},attr:function(e,t){var n=n7(e),r="transform"===n?iC:iN;return this.attrTween(e,"function"==typeof t?(n.local?function(e,t,n){var r,i,o;return function(){var a,s,l=n(this);return null==l?void this.removeAttributeNS(e.space,e.local):(a=this.getAttributeNS(e.space,e.local))===(s=l+"")?null:a===r&&s===i?o:(i=s,o=t(r=a,l))}}:function(e,t,n){var r,i,o;return function(){var a,s,l=n(this);return null==l?void this.removeAttribute(e):(a=this.getAttribute(e))===(s=l+"")?null:a===r&&s===i?o:(i=s,o=t(r=a,l))}})(n,r,iT(this,"attr."+e,t)):null==t?(n.local?function(e){return function(){this.removeAttributeNS(e.space,e.local)}}:function(e){return function(){this.removeAttribute(e)}})(n):(n.local?function(e,t,n){var r,i,o=n+"";return function(){var a=this.getAttributeNS(e.space,e.local);return a===o?null:a===r?i:i=t(r=a,n)}}:function(e,t,n){var r,i,o=n+"";return function(){var a=this.getAttribute(e);return a===o?null:a===r?i:i=t(r=a,n)}})(n,r,t))},attrTween:function(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!=typeof t)throw Error();var r=n7(e);return this.tween(n,(r.local?function(e,t){var n,r;function i(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&function(t){this.setAttributeNS(e.space,e.local,i.call(this,t))}),n}return i._value=t,i}:function(e,t){var n,r;function i(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&function(t){this.setAttribute(e,i.call(this,t))}),n}return i._value=t,i})(r,t))},style:function(e,t,n){var r,i,o,a,s,l,u,d,c,h,f,m,p,g,v,y,x,w,_,A,S,b="transform"==(e+="")?ij:iN;return null==t?this.styleTween(e,(r=e,function(){var e=re(this,r),t=(this.style.removeProperty(r),re(this,r));return e===t?null:e===i&&t===o?a:a=b(i=e,o=t)})).on("end.style."+e,iR(e)):"function"==typeof t?this.styleTween(e,(s=e,l=iT(this,"style."+e,t),function(){var e=re(this,s),t=l(this),n=t+"";return null==t&&(this.style.removeProperty(s),n=t=re(this,s)),e===n?null:e===u&&n===d?c:(d=n,c=b(u=e,t))})).each((h=this._id,x="end."+(y="style."+(f=e)),function(){var e=i_(this,h),t=e.on,n=null==e.value[y]?v||(v=iR(f)):void 0;(t!==m||g!==n)&&(p=(m=t).copy()).on(x,g=n),e.on=p})):this.styleTween(e,(w=e,S=t+"",function(){var e=re(this,w);return e===S?null:e===_?A:A=b(_=e,t)}),n).on("end.style."+e,null)},styleTween:function(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==t)return this.tween(r,null);if("function"!=typeof t)throw Error();return this.tween(r,function(e,t,n){var r,i;function o(){var o=t.apply(this,arguments);return o!==i&&(r=(i=o)&&function(t){this.style.setProperty(e,o.call(this,t),n)}),r}return o._value=t,o}(e,t,null==n?"":n))},text:function(e){var t,n;return this.tween("text","function"==typeof e?(t=iT(this,"text",e),function(){var e=t(this);this.textContent=null==e?"":e}):(n=null==e?"":e+"",function(){this.textContent=n}))},textTween:function(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(null==e)return this.tween(t,null);if("function"!=typeof e)throw Error();return this.tween(t,function(e){var t,n;function r(){var r=e.apply(this,arguments);return r!==n&&(t=(n=r)&&function(e){this.textContent=r.call(this,e)}),t}return r._value=e,r}(e))},remove:function(){var e;return this.on("end.remove",(e=this._id,function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}))},tween:function(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r,i=iA(this.node(),n).tween,o=0,a=i.length;o<a;++o)if((r=i[o]).name===e)return r.value;return null}return this.each((null==t?function(e,t){var n,r;return function(){var i=i_(this,e),o=i.tween;if(o!==n){r=n=o;for(var a=0,s=r.length;a<s;++a)if(r[a].name===t){(r=r.slice()).splice(a,1);break}}i.tween=r}}:function(e,t,n){var r,i;if("function"!=typeof n)throw Error();return function(){var o=i_(this,e),a=o.tween;if(a!==r){i=(r=a).slice();for(var s={name:t,value:n},l=0,u=i.length;l<u;++l)if(i[l].name===t){i[l]=s;break}l===u&&i.push(s)}o.tween=i}})(n,e,t))},delay:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?function(e,t){return function(){iw(this,e).delay=+t.apply(this,arguments)}}:function(e,t){return t*=1,function(){iw(this,e).delay=t}})(t,e)):iA(this.node(),t).delay},duration:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?function(e,t){return function(){i_(this,e).duration=+t.apply(this,arguments)}}:function(e,t){return t*=1,function(){i_(this,e).duration=t}})(t,e)):iA(this.node(),t).duration},ease:function(e){var t=this._id;return arguments.length?this.each(function(e,t){if("function"!=typeof t)throw Error();return function(){i_(this,e).ease=t}}(t,e)):iA(this.node(),t).ease},easeVarying:function(e){var t;if("function"!=typeof e)throw Error();return this.each((t=this._id,function(){var n=e.apply(this,arguments);if("function"!=typeof n)throw Error();i_(this,t).ease=n}))},end:function(){var e,t,n=this,r=n._id,i=n.size();return new Promise(function(o,a){var s={value:a},l={value:function(){0==--i&&o()}};n.each(function(){var n=i_(this,r),i=n.on;i!==e&&((t=(e=i).copy())._.cancel.push(s),t._.interrupt.push(s),t._.end.push(l)),n.on=t}),0===i&&o()})},[Symbol.iterator]:iL[Symbol.iterator]};var iG={time:null,delay:0,duration:250,ease:function(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}};rw.prototype.interrupt=function(e){return this.each(function(){!function(e,t){var n,r,i,o=e.__transition,a=!0;if(o){for(i in t=null==t?null:t+"",o){if((n=o[i]).name!==t){a=!1;continue}r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete o[i]}a&&delete e.__transition}}(this,e)})},rw.prototype.transition=function(e){var t,n;e instanceof iz?(t=e._id,e=e._name):(t=++iF,(n=iG).time=il(),e=null==e?null:e+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var a,s=r[o],l=s.length,u=0;u<l;++u)(a=s[u])&&ix(a,e,t,u,s,n||function(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw Error("transition ".concat(t," not found"));return n}(a,t));return new iz(r,this._parents,e,t)},e.s([],30239);let{abs:iU,max:iI,min:iO}=Math;function iP(e){return{type:e}}function iB(e){return((e=Math.exp(e))+1/e)/2}function iD(e,t,n){this.k=e,this.x=t,this.y=n}["w","e"].map(iP),["n","s"].map(iP),["n","w","e","s","nw","ne","sw","se"].map(iP),!function e(t,n,r){function i(e,i){var o,a,s=e[0],l=e[1],u=e[2],d=i[0],c=i[1],h=i[2],f=d-s,m=c-l,p=f*f+m*m;if(p<1e-12)a=Math.log(h/u)/t,o=function(e){return[s+e*f,l+e*m,u*Math.exp(t*e*a)]};else{var g=Math.sqrt(p),v=(h*h-u*u+r*p)/(2*u*n*g),y=(h*h-u*u-r*p)/(2*h*n*g),x=Math.log(Math.sqrt(v*v+1)-v);a=(Math.log(Math.sqrt(y*y+1)-y)-x)/t,o=function(e){var r,i,o=e*a,d=iB(x),c=u/(n*g)*(d*(((r=Math.exp(2*(r=t*o+x)))-1)/(r+1))-((i=Math.exp(i=x))-1/i)/2);return[s+c*f,l+c*m,u*d/iB(t*o+x)]}}return o.duration=1e3*a*t/Math.SQRT2,o}return i.rho=function(t){var n=Math.max(.001,+t),r=n*n;return e(n,r,r*r)},i}(Math.SQRT2,2,4),iD.prototype={constructor:iD,scale:function(e){return 1===e?this:new iD(this.k*e,this.x,this.y)},translate:function(e,t){return 0===e&0===t?this:new iD(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};new iD(1,0,0);function iW(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,o,a,s,l,u,d,c,h,f=e._root,m={data:r},p=e._x0,g=e._y0,v=e._x1,y=e._y1;if(!f)return e._root=m,e;for(;f.length;)if((u=t>=(o=(p+v)/2))?p=o:v=o,(d=n>=(a=(g+y)/2))?g=a:y=a,i=f,!(f=f[c=d<<1|u]))return i[c]=m,e;if(s=+e._x.call(null,f.data),l=+e._y.call(null,f.data),t===s&&n===l)return m.next=f,i?i[c]=m:e._root=m,e;do i=i?i[c]=[,,,,]:e._root=[,,,,],(u=t>=(o=(p+v)/2))?p=o:v=o,(d=n>=(a=(g+y)/2))?g=a:y=a;while((c=d<<1|u)==(h=(l>=a)<<1|s>=o))return i[h]=f,i[c]=m,e}function iH(e,t,n,r,i){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=i}function iV(e){return e[0]}function iq(e){return e[1]}function iX(e,t,n,r,i,o){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function iY(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}iD.prototype;var iJ=(function(e,t,n){var r=new iX(null==t?iV:t,null==n?iq:n,NaN,NaN,NaN,NaN);return null==e?r:r.addAll(e)}).prototype=iX.prototype;iJ.copy=function(){var e,t,n=new iX(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=iY(r),n;for(e=[{source:r,target:n._root=[,,,,]}];r=e.pop();)for(var i=0;i<4;++i)(t=r.source[i])&&(t.length?e.push({source:t,target:r.target[i]=[,,,,]}):r.target[i]=iY(t));return n},iJ.add=function(e){let t=+this._x.call(null,e),n=+this._y.call(null,e);return iW(this.cover(t,n),t,n,e)},iJ.addAll=function(e){var t,n,r,i,o=e.length,a=Array(o),s=Array(o),l=1/0,u=1/0,d=-1/0,c=-1/0;for(n=0;n<o;++n)!(isNaN(r=+this._x.call(null,t=e[n]))||isNaN(i=+this._y.call(null,t)))&&(a[n]=r,s[n]=i,r<l&&(l=r),r>d&&(d=r),i<u&&(u=i),i>c&&(c=i));if(l>d||u>c)return this;for(this.cover(l,u).cover(d,c),n=0;n<o;++n)iW(this,a[n],s[n],e[n]);return this},iJ.cover=function(e,t){if(isNaN(e*=1)||isNaN(t*=1))return this;var n=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,o=(r=Math.floor(t))+1;else{for(var a,s,l=i-n||1,u=this._root;n>e||e>=i||r>t||t>=o;)switch(s=(t<r)<<1|e<n,(a=[,,,,])[s]=u,u=a,l*=2,s){case 0:i=n+l,o=r+l;break;case 1:n=i-l,o=r+l;break;case 2:i=n+l,r=o-l;break;case 3:n=i-l,r=o-l}this._root&&this._root.length&&(this._root=u)}return this._x0=n,this._y0=r,this._x1=i,this._y1=o,this},iJ.data=function(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e},iJ.extent=function(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},iJ.find=function(e,t,n){var r,i,o,a,s,l,u,d=this._x0,c=this._y0,h=this._x1,f=this._y1,m=[],p=this._root;for(p&&m.push(new iH(p,d,c,h,f)),null==n?n=1/0:(d=e-n,c=t-n,h=e+n,f=t+n,n*=n);l=m.pop();)if((p=l.node)&&!((i=l.x0)>h)&&!((o=l.y0)>f)&&!((a=l.x1)<d)&&!((s=l.y1)<c))if(p.length){var g=(i+a)/2,v=(o+s)/2;m.push(new iH(p[3],g,v,a,s),new iH(p[2],i,v,g,s),new iH(p[1],g,o,a,v),new iH(p[0],i,o,g,v)),(u=(t>=v)<<1|e>=g)&&(l=m[m.length-1],m[m.length-1]=m[m.length-1-u],m[m.length-1-u]=l)}else{var y=e-this._x.call(null,p.data),x=t-this._y.call(null,p.data),w=y*y+x*x;if(w<n){var _=Math.sqrt(n=w);d=e-_,c=t-_,h=e+_,f=t+_,r=p.data}}return r},iJ.remove=function(e){if(isNaN(o=+this._x.call(null,e))||isNaN(a=+this._y.call(null,e)))return this;var t,n,r,i,o,a,s,l,u,d,c,h,f=this._root,m=this._x0,p=this._y0,g=this._x1,v=this._y1;if(!f)return this;if(f.length)for(;;){if((u=o>=(s=(m+g)/2))?m=s:g=s,(d=a>=(l=(p+v)/2))?p=l:v=l,t=f,!(f=f[c=d<<1|u]))return this;if(!f.length)break;(t[c+1&3]||t[c+2&3]||t[c+3&3])&&(n=t,h=c)}for(;f.data!==e;)if(r=f,!(f=f.next))return this;return((i=f.next)&&delete f.next,r)?i?r.next=i:delete r.next:t?(i?t[c]=i:delete t[c],(f=t[0]||t[1]||t[2]||t[3])&&f===(t[3]||t[2]||t[1]||t[0])&&!f.length&&(n?n[h]=f:this._root=f)):this._root=i,this},iJ.removeAll=function(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this},iJ.root=function(){return this._root},iJ.size=function(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e},iJ.visit=function(e){var t,n,r,i,o,a,s=[],l=this._root;for(l&&s.push(new iH(l,this._x0,this._y0,this._x1,this._y1));t=s.pop();)if(!e(l=t.node,r=t.x0,i=t.y0,o=t.x1,a=t.y1)&&l.length){var u=(r+o)/2,d=(i+a)/2;(n=l[3])&&s.push(new iH(n,u,d,o,a)),(n=l[2])&&s.push(new iH(n,r,d,u,a)),(n=l[1])&&s.push(new iH(n,u,i,o,d)),(n=l[0])&&s.push(new iH(n,r,i,u,d))}return this},iJ.visitAfter=function(e){var t,n=[],r=[];for(this._root&&n.push(new iH(this._root,this._x0,this._y0,this._x1,this._y1));t=n.pop();){var i=t.node;if(i.length){var o,a=t.x0,s=t.y0,l=t.x1,u=t.y1,d=(a+l)/2,c=(s+u)/2;(o=i[0])&&n.push(new iH(o,a,s,d,c)),(o=i[1])&&n.push(new iH(o,d,s,l,c)),(o=i[2])&&n.push(new iH(o,a,c,d,u)),(o=i[3])&&n.push(new iH(o,d,c,l,u))}r.push(t)}for(;t=r.pop();)e(t.node,t.x0,t.y0,t.x1,t.y1);return this},iJ.x=function(e){return arguments.length?(this._x=e,this):this._x},iJ.y=function(e){return arguments.length?(this._y=e,this):this._y},e.i(30239);var iZ=e.i(78140),iQ=e.i(60099),i$=e.i(90675);function iK(){return new x.MeshStandardMaterial({color:0xffffff,transparent:!0,opacity:.9,metalness:.1,roughness:.8})}function i0(e,t){let[,n]=(0,nl.useStore)("selectedNodeStore",null);nc(e).length;let r=(0,f.useRef)(!1),i=(0,f.useRef)(e);(0,f.useEffect)(()=>{i.current=e},[e]),(0,f.useEffect)(()=>{if(e)return t&&!r.current&&requestAnimationFrame(()=>{n({id:e,ts:Date.now()})}),!t&&r.current&&requestAnimationFrame(()=>{n(e=>(null==e?void 0:e.id)===i.current?null:e)}),r.current=t,()=>{r.current&&i.current===e&&requestAnimationFrame(()=>{n(e=>(null==e?void 0:e.id)===i.current?null:e)})}},[t,e,n])}function i1(e){let[t]=(0,nl.useStore)("highlightedNodesStore",[]);return(0,f.useMemo)(()=>!!e&&!!Array.isArray(t)&&t.includes(e),[e,t])}var y=g,i2=x;let i3=e=>e===Object(e)&&!Array.isArray(e)&&"function"!=typeof e;function i5(e,t){let n=(0,m.useThree)(e=>e.gl),r=(0,S.useLoader)(x.TextureLoader,i3(e)?Object.values(e):e);return(0,f.useLayoutEffect)(()=>{null==t||t(r)},[t]),(0,f.useEffect)(()=>{if("initTexture"in n){let e=[];Array.isArray(r)?e=r:r instanceof x.Texture?e=[r]:i3(r)&&(e=Object.values(r)),e.forEach(e=>{e instanceof x.Texture&&n.initTexture(e)})}},[n,r]),(0,f.useMemo)(()=>{if(!i3(e))return r;{let t={},n=0;for(let i in e)t[i]=r[n++];return t}},[e,r])}i5.preload=e=>S.useLoader.preload(x.TextureLoader,e),i5.clear=e=>S.useLoader.clear(x.TextureLoader,e);let i4=parseInt(x.REVISION.replace(/\D+/g,"")),i8=(i={color:new x.Color("white"),scale:new x.Vector2(1,1),imageBounds:new x.Vector2(1,1),resolution:1024,map:null,zoom:1,radius:0,grayscale:0,opacity:1},o="\n  varying vec2 vUv;\n  varying vec2 vPos;\n  void main() {\n    gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(position, 1.);\n    vUv = uv;\n    vPos = position.xy;\n  }\n",a="\n  // mostly from https://gist.github.com/statico/df64c5d167362ecf7b34fca0b1459a44\n  varying vec2 vUv;\n  varying vec2 vPos;\n  uniform vec2 scale;\n  uniform vec2 imageBounds;\n  uniform float resolution;\n  uniform vec3 color;\n  uniform sampler2D map;\n  uniform float radius;\n  uniform float zoom;\n  uniform float grayscale;\n  uniform float opacity;\n  const vec3 luma = vec3(.299, 0.587, 0.114);\n  vec4 toGrayscale(vec4 color, float intensity) {\n    return vec4(mix(color.rgb, vec3(dot(color.rgb, luma)), intensity), color.a);\n  }\n  vec2 aspect(vec2 size) {\n    return size / min(size.x, size.y);\n  }\n  \n  const float PI = 3.14159265;\n    \n  // from https://iquilezles.org/articles/distfunctions\n  float udRoundBox( vec2 p, vec2 b, float r ) {\n    return length(max(abs(p)-b+r,0.0))-r;\n  }\n\n  void main() {\n    vec2 s = aspect(scale);\n    vec2 i = aspect(imageBounds);\n    float rs = s.x / s.y;\n    float ri = i.x / i.y;\n    vec2 new = rs < ri ? vec2(i.x * s.y / i.y, s.y) : vec2(s.x, i.y * s.x / i.x);\n    vec2 offset = (rs < ri ? vec2((new.x - s.x) / 2.0, 0.0) : vec2(0.0, (new.y - s.y) / 2.0)) / new;\n    vec2 uv = vUv * s / new + offset;\n    vec2 zUv = (uv - vec2(0.5, 0.5)) / zoom + vec2(0.5, 0.5);\n\n    vec2 res = vec2(scale * resolution);\n    vec2 halfRes = 0.5 * res;\n    float b = udRoundBox(vUv.xy * res - halfRes, halfRes, resolution * radius);    \n	  vec3 a = mix(vec3(1.0,0.0,0.0), vec3(0.0,0.0,0.0), smoothstep(0.0, 1.0, b));\n    gl_FragColor = toGrayscale(texture2D(map, zUv) * vec4(color, opacity * a), grayscale);\n    \n    #include <tonemapping_fragment>\n    #include <".concat(i4>=154?"colorspace_fragment":"encodings_fragment",">\n  }\n"),(s=class extends i2.ShaderMaterial{constructor(e){for(const t in super((0,u._)({vertexShader:o,fragmentShader:a},e)),i)this.uniforms[t]=new i2.Uniform(i[t]),Object.defineProperty(this,t,{get(){return this.uniforms[t].value},set(e){this.uniforms[t].value=e}});this.uniforms=i2.UniformsUtils.clone(this.uniforms)}}).key=i2.MathUtils.generateUUID(),s),i6=f.forwardRef((e,t)=>{var{children:n,color:r,segments:i=1,scale:o=1,zoom:a=1,grayscale:s=0,opacity:l=1,radius:u=0,texture:d,toneMapped:p,transparent:g,side:v}=e,x=(0,c._)(e,["children","color","segments","scale","zoom","grayscale","opacity","radius","texture","toneMapped","transparent","side"]);(0,y.e)({ImageMaterial:i8});let w=f.useRef(null),_=(0,m.useThree)(e=>e.size),A=Array.isArray(o)?[o[0],o[1]]:[o,o],S=[d.image.width,d.image.height],b=Math.max(_.width,_.height);return f.useImperativeHandle(t,()=>w.current,[]),f.useLayoutEffect(()=>{w.current.geometry.parameters&&w.current.material.scale.set(A[0]*w.current.geometry.parameters.width,A[1]*w.current.geometry.parameters.height)},[A[0],A[1]]),f.createElement("mesh",(0,h.default)({ref:w,scale:Array.isArray(o)?[...o,1]:o},x),f.createElement("planeGeometry",{args:[1,1,i,i]}),f.createElement("imageMaterial",{color:r,map:d,zoom:a,grayscale:s,opacity:l,scale:A,imageBounds:S,resolution:b,radius:u,toneMapped:p,transparent:g,side:v,key:i8.key}),n)}),i7=f.forwardRef((e,t)=>{var{url:n}=e,r=(0,c._)(e,["url"]);let i=i5(n);return f.createElement(i6,(0,h.default)({},r,{texture:i,ref:t}))}),i9=f.forwardRef((e,t)=>{var{url:n}=e,r=(0,c._)(e,["url"]);return f.createElement(i6,(0,h.default)({},r,{ref:t}))}),oe=f.forwardRef((e,t)=>{if(e.url)return f.createElement(i7,(0,h.default)({},e,{ref:t}));if(e.texture)return f.createElement(i9,(0,h.default)({},e,{ref:t}));throw Error("<Image /> requires a url or texture")});var ot=e.i(97647);function on(e){let{imageUrl:t,position:n,scale:r=[10.8,10.8,1],tiltAmount:i=.15,opacity:o=1,faceCamera:a=!1,showCross:s=!1,title:l="",showTitle:c=!1,showReadButton:h=!1,onReadClick:m=null,onCloseCross:g=null,onClick:v=null,highlightState:y={isSelected:!1,isHighlighted:!1,isSecondaryHighlighted:!1,hasSelection:!1},nodeId:w=null}=e,_=(0,f.useRef)(),A=(0,f.useRef)(),S=(0,f.useRef)(),b=(0,f.useRef)(),M=(0,f.useRef)(),E=(0,f.useRef)(),j=(0,f.useRef)(null),C=(0,f.useRef)(null),[T,N]=(0,f.useState)(!1),[k,R]=(0,f.useState)(t),[F,z]=(0,f.useState)(!0),[L,G]=(0,f.useState)(!1),[U,I]=(0,f.useState)(!0),[O,P]=(0,f.useState)(0),[B,D]=(0,f.useState)(0),[W,H]=(0,f.useState)(!1),[V,q]=(0,f.useState)(!1),[X]=(0,nl.useStore)("selectedNodeStore",null),[Y]=(0,nl.useStore)("highlightedNodesStore",[]),[J]=(0,nl.useStore)("secondaryHighlightedArticlesStore",[]),Z=(null==y?void 0:y.isSelected)||w&&(null==X?void 0:X.id)===w,Q=(null==y?void 0:y.isHighlighted)||w&&Y.includes(w),$=(null==y?void 0:y.isSecondaryHighlighted)||w&&J.includes(w),K=(null==y?void 0:y.hasSelection)||null!==X,ee=!K||Z||Q||$?o:.2*o,et=Z||Q?ot.COLOR_ACCENT:"#ffffff",en=$?2:Z||Q?13:7,er=(0,f.useMemo)(()=>new x.Vector3(0,0,0),[]);(0,f.useEffect)(()=>{if(!t)return void N(!0);let e=t.includes(" ")?t.split("/").map(e=>encodeURIComponent(e)).join("/"):t,n=new window.Image;n.onload=()=>{N(!1),R(e)},n.onerror=e=>{if(console.warn("Failed to load image: ".concat(t),e),t&&(t.startsWith("http://")||t.startsWith("https://"))){let e="/entriesImages/placeholder.svg",n=new window.Image;n.onload=()=>{N(!1),R(e),console.warn("Using placeholder for external image: ".concat(t))},n.onerror=()=>{N(!0),R(null)},n.src=e;return}if(t.endsWith(".jpg")){let e=t.replace(".jpg",".png"),n=e.includes(" ")?e.split("/").map(e=>encodeURIComponent(e)).join("/"):e,r=new window.Image;r.onload=()=>{N(!1),R(n)},r.onerror=()=>{let n="/entriesImages/placeholder.svg",r=new window.Image;r.onload=()=>{N(!1),R(n),console.warn("Using placeholder for missing image: ".concat(t))},r.onerror=()=>{console.warn("Could not load image: ".concat(t," or ").concat(e," or placeholder")),N(!0)},r.src=n},r.src=n}else if(t.endsWith(".png")){let e=t.replace(".png",".jpg"),n=e.includes(" ")?e.split("/").map(e=>encodeURIComponent(e)).join("/"):e,r=new window.Image;r.onload=()=>{N(!1),R(n)},r.onerror=()=>{let n="/entriesImages/placeholder.svg",r=new window.Image;r.onload=()=>{N(!1),R(n),console.warn("Using placeholder for missing image: ".concat(t))},r.onerror=()=>{console.warn("Could not load image: ".concat(t," or ").concat(e," or placeholder")),N(!0)},r.src=n},r.src=n}else{let e="/entriesImages/placeholder.svg",n=new window.Image;n.onload=()=>{N(!1),R(e),console.warn("Using placeholder for missing image: ".concat(t))},n.onerror=()=>{console.warn("Could not load image: ".concat(t," or placeholder")),N(!0)},n.src=e}},n.src=e},[t]);let ei=(0,f.useRef)(new x.Vector3),eo=(0,f.useRef)(new x.Vector3),ea=(0,f.useRef)(new x.Vector3),es=(0,f.useRef)(new x.Vector3),el=(0,f.useRef)(new x.Vector3),eu=(0,f.useRef)(new x.Quaternion),ed=(0,f.useRef)(new x.Quaternion),ec=(0,f.useRef)(new x.Matrix4),eh=(0,f.useRef)(new x.Vector3(0,1,0));(0,p.useFrame)((e,t)=>{if(!b.current||!S.current)return;let n=eu.current;if(a){let t,r,i=e.camera,o=ei.current;b.current.getWorldPosition(o);let a=eo.current.subVectors(i.position,o).normalize();Math.abs(i.position.y-o.y)>8?(el.current.set(1,0,0),el.current.applyQuaternion(i.quaternion),t=.001>ea.current.set(el.current.x,0,el.current.z).length()?ea.current.set(1,0,0):ea.current.normalize()):(.001>(t=ea.current.crossVectors(eh.current,a)).length()&&t.set(1,0,0),t.normalize()),r=es.current.crossVectors(a,t).normalize();let s=ec.current.makeBasis(t,r,a);n.setFromRotationMatrix(s)}else{let e=ei.current;b.current.getWorldPosition(e);let t=eo.current.subVectors(er,e);if(.001>t.length())return;t.normalize();let r=ea.current.crossVectors(eh.current,t);.001>r.length()&&r.set(1,0,0),r.normalize();let o=es.current.crossVectors(t,r).normalize(),a=ec.current.makeBasis(r,o,t);if(n.setFromRotationMatrix(a),0!==i){let e=ed.current.setFromAxisAngle(r,i);n.multiply(e)}}let r=S.current.quaternion,o=Math.min(1,8*t);r.slerp(n,o);let s=e.camera,l=ei.current;b.current.getWorldPosition(l);let u=eo.current.set(0,0,1);u.applyQuaternion(r);let d=ea.current.subVectors(s.position,l).normalize(),c=u.dot(d);z(c>0),G(c<=0),I(c>0)});let ef=(0,f.useMemo)(()=>[r[0]+.4,r[1]+.4,r[2]],[r]),em=!t||T&&!k,ep=r[0],eg=r[1],ev=ep+.4,ey=eg+.4;(0,f.useMemo)(()=>new x.Vector3(-ev/2,ey/2,0),[ev,ey]),(0,f.useMemo)(()=>new x.Vector3(ev/2,ey/2,0),[ev,ey]),(0,f.useMemo)(()=>new x.Vector3(-ev/2,-ey/2,0),[ev,ey]),(0,f.useMemo)(()=>new x.Vector3(ev/2,-ey/2,0),[ev,ey]),(0,f.useMemo)(()=>new x.Vector3(0,ey/2,0),[ey]),(0,f.useMemo)(()=>new x.Vector3(0,-ey/2,0),[ey]),(0,f.useMemo)(()=>new x.Vector3(-ev/2,0,0),[ev]),(0,f.useMemo)(()=>new x.Vector3(ev/2,0,0),[ev]);let ex=-ey/2-.1,ew=(0,f.useMemo)(()=>2.14*r[0],[r]),e_=(0,f.useMemo)(()=>2.07*r[1],[r]),eA=(0,f.useMemo)(()=>Math.round(20*ew),[ew]),eS=(0,f.useMemo)(()=>Math.round(20*e_),[e_]),eb=(0,f.useMemo)(()=>Math.round(.95*eA),[eA]),eM=(0,f.useMemo)(()=>{if(!l||l.length<=96)return l;let e=l.substring(0,96),t=e.lastIndexOf(" ");return t>0?e.substring(0,t)+"...":e+"..."},[l]),eE=(0,f.useMemo)(()=>Math.round(41*r[1]),[r]),ej=e=>{if(!e)return null;let t=e.querySelector(".titleContainer")||e,n=window.getComputedStyle(t),r=t.offsetHeight||t.scrollHeight||t.clientHeight;if(0===r&&(r=t.getBoundingClientRect().height),0===r)return null;let i=parseFloat(n.marginTop)||0,o=parseFloat(n.marginBottom)||0,a=window.getComputedStyle(e),s=r+i+o+(parseFloat(a.marginTop)||0)+(parseFloat(a.marginBottom)||0);return s>0?Math.round(s):null};(0,f.useEffect)(()=>{if(!c||!l){P(0),D(0),h?(H(!0),q(!0)):(H(!1),q(!1));return}H(!1),q(!1);let e=()=>{let e=!1,t=!1;if(j.current){let t=ej(j.current);null!==t&&t>0&&(P(t),e=!0,setTimeout(()=>{H(!0)},150))}if(C.current){let e=ej(C.current);null!==e&&e>0&&(D(e),t=!0,setTimeout(()=>{q(!0)},150))}return e&&t},t=new ResizeObserver(()=>{requestAnimationFrame(()=>{e()})}),n=()=>{let e=[];return j.current&&e.push(j.current),C.current&&e.push(C.current),e.length>0&&(e.forEach(e=>{t.observe(e)}),!0)};if(n()){let n=0,r=()=>{let t=e();n++,!t&&n<30?setTimeout(r,100):n>=30&&h&&(H(!0),q(!0))};setTimeout(()=>{r()},200);let i=setInterval(()=>{e()},300),o=setTimeout(()=>{clearInterval(i),h&&(H(!0),q(!0))},2e3);return()=>{clearTimeout(o),clearInterval(i),t.disconnect()}}{let r=0,i=setInterval(()=>{if(n()){clearInterval(i),setTimeout(()=>{e()},100);let n=setInterval(()=>{e()},200),r=setTimeout(()=>{clearInterval(n),h&&(H(!0),q(!0))},1500);return()=>{clearTimeout(r),clearInterval(n),t.disconnect()}}++r>40&&(clearInterval(i),h&&(H(!0),q(!0)))},50),o=setTimeout(()=>{clearInterval(i),h&&(H(!0),q(!0))},2e3);return()=>{clearTimeout(o),clearInterval(i),t.disconnect()}}},[c,l,eM,eb,h]);let eC=(0,f.useMemo)(()=>{let e=O||0;return c&&l&&0===e&&(e=Math.min(.3*eE,120)),Math.max(0,eE-e)},[eE,O,c,l]),eT=(0,f.useMemo)(()=>{let e=B||0;return c&&l&&0===e&&(e=Math.min(.3*eE,120)),Math.max(0,eE-e)},[eE,B,c,l]);return(0,f.useEffect)(()=>{if(w)return s&&U&&M.current?nx(w,M):$&&!s&&E.current?nx(w,E):nw(w),()=>{nw(w)}},[w,s,U,$]),(0,p.useFrame)(()=>{w&&s&&U&&M.current?n_(w):w&&$&&!s&&E.current&&n_(w)}),(0,d.jsx)("group",{ref:b,position:n,children:(0,d.jsxs)("group",{ref:S,children:[(0,d.jsxs)("mesh",{position:[0,0,-.15],renderOrder:$?en:Z||Q||$?11:1,frustumCulled:!1,children:[(0,d.jsx)("planeGeometry",{args:[ef[0],ef[1]]}),(0,d.jsx)("meshBasicMaterial",{color:"#000000",transparent:!0,opacity:+ee,side:x.DoubleSide,depthWrite:$||!(Z||Q||$),depthTest:$||!(Z||Q||$)})]}),(0,d.jsxs)("mesh",{position:[0,0,-.1],renderOrder:$?en:Z||Q||$?12:2,frustumCulled:!1,children:[(0,d.jsx)("planeGeometry",{args:[ef[0],ef[1]]}),(0,d.jsx)("meshBasicMaterial",{color:et,transparent:!0,opacity:+ee,side:x.DoubleSide,depthWrite:$||!(Z||Q||$),depthTest:$||!(Z||Q||$)})]}),Z&&(0,d.jsxs)("mesh",{position:[0,0,-.05],renderOrder:$?en:Z||Q||$?12.5:2.5,frustumCulled:!1,children:[(0,d.jsx)("planeGeometry",{args:[ef[0],ef[1]]}),(0,d.jsx)("meshBasicMaterial",{color:ot.COLOR_ACCENT,transparent:!0,opacity:.18*ee,side:x.DoubleSide,depthWrite:$||!(Z||Q||$),depthTest:$||!(Z||Q||$)})]}),em?(0,d.jsxs)("mesh",(0,tc._)((0,u._)({ref:_,position:[0,0,0],renderOrder:$?en:Z||Q||$?10:3,frustumCulled:!1},v?{onClick:v}:{}),{children:[(0,d.jsx)("planeGeometry",{args:[r[0],r[1]]}),(0,d.jsx)("meshBasicMaterial",{color:ot.COLOR_ACCENT,transparent:!0,opacity:Z||Q||$?+ee:.98*ee,side:x.DoubleSide,depthWrite:$||!(Z||Q||$),depthTest:$||!(Z||Q||$)})]})):k&&!T&&(0,d.jsxs)("group",{ref:A,position:[0,0,0],renderOrder:$?en:Z||Q||$?10:3,children:[(0,d.jsxs)("mesh",(0,tc._)((0,u._)({position:[0,0,0]},v?{onClick:v}:{}),{children:[(0,d.jsx)("planeGeometry",{args:[r[0],r[1]]}),(0,d.jsx)("meshBasicMaterial",{transparent:!0,opacity:0,side:x.DoubleSide,depthWrite:!1,depthTest:!1})]})),k&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(oe,{url:k,scale:r,transparent:!0,opacity:Z||Q||$?+ee:.98*ee,depthWrite:$||!(Z||Q||$),depthTest:$||!(Z||Q||$),frustumCulled:!1,onError:e=>{console.warn("Image component failed to load: ".concat(k),e),N(!0),R(null)}}),(0,d.jsx)(oe,{url:k,scale:r,transparent:!0,opacity:Z||Q||$?+ee:.98*ee,depthWrite:$||!(Z||Q||$),depthTest:$||!(Z||Q||$),frustumCulled:!1,rotation:[0,Math.PI,0],onError:e=>{console.warn("Image component failed to load (back): ".concat(k),e),N(!0),R(null)}})]})]}),(c&&l||h)&&F&&(0,d.jsxs)("group",{position:[0,0,-.08],renderOrder:en,children:[(0,d.jsxs)("mesh",(0,tc._)((0,u._)({renderOrder:en,frustumCulled:!1},v?{onClick:v}:{}),{children:[(0,d.jsx)("planeGeometry",{args:[ew,e_]}),(0,d.jsx)("meshBasicMaterial",{color:"#000000",transparent:!0,opacity:0,side:x.FrontSide,depthWrite:$,depthTest:$})]})),(0,d.jsx)(iQ.Html,{center:!1,className:"titleAndReadWrapper",style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -30%)",width:"".concat(eA,"px"),height:"".concat(eS,"px"),minWidth:"".concat(eA,"px"),minHeight:"".concat(eS,"px"),maxWidth:"none",maxHeight:"none",margin:0,padding:0,pointerEvents:"none"},transform:!0,occlude:!!$||!!K&&!Z&&!Q,children:(0,d.jsxs)("div",{className:"titleAndReadContainer",style:{width:"".concat(eA,"px"),height:"".concat(eE,"px"),minWidth:"".concat(eA,"px"),minHeight:"".concat(eE,"px"),maxWidth:"none",maxHeight:"none",opacity:ee,margin:0,padding:0,position:"relative",pointerEvents:"none",transform:"translateY(-20%)"},children:[h&&(0,d.jsx)("div",{className:"readWrapper",style:{position:"absolute",top:"0",left:"50%",transform:"translateX(-50%)",width:"100%",height:"".concat(eC,"px"),opacity:+!!W,transition:"opacity 0.3s ease-in-out",pointerEvents:W?"auto":"none"},children:(0,d.jsx)("div",{className:"readButton",onClick:m,style:{pointerEvents:"auto"},children:(0,d.jsx)("span",{className:"readButtonText",children:"READ"})})}),c&&l&&(0,d.jsx)("div",{ref:j,className:"titleWrapper",style:{position:"absolute",bottom:"0",left:"50%",transform:"translateX(-50%)",width:"100%"},children:(0,d.jsx)("div",{className:"titleContainer",style:{width:"".concat(eb,"px")},children:eM})})]})})]}),(c&&l||h)&&L&&(0,d.jsxs)("group",{position:[0,0,-.08],rotation:[0,Math.PI,0],renderOrder:en,children:[(0,d.jsxs)("mesh",(0,tc._)((0,u._)({renderOrder:en,frustumCulled:!1},v?{onClick:v}:{}),{children:[(0,d.jsx)("planeGeometry",{args:[ew,e_]}),(0,d.jsx)("meshBasicMaterial",{color:"#000000",transparent:!0,opacity:0,side:x.FrontSide,depthWrite:$,depthTest:$})]})),(0,d.jsx)(iQ.Html,{center:!1,className:"titleAndReadWrapper",style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -30%)",width:"".concat(eA,"px"),height:"".concat(eS,"px"),minWidth:"".concat(eA,"px"),minHeight:"".concat(eS,"px"),maxWidth:"none",maxHeight:"none",margin:0,padding:0,pointerEvents:"none"},transform:!0,occlude:!!$||!!K&&!Z&&!Q,children:(0,d.jsxs)("div",{className:"titleAndReadContainer",style:{width:"".concat(eA,"px"),height:"".concat(eE,"px"),minWidth:"".concat(eA,"px"),minHeight:"".concat(eE,"px"),maxWidth:"none",maxHeight:"none",opacity:ee,margin:0,padding:0,position:"relative",pointerEvents:"none",transform:"translateY(-20%)"},children:[h&&(0,d.jsx)("div",{className:"readWrapper",style:{position:"absolute",top:"0",left:"50%",transform:"translateX(-50%)",width:"100%",height:"".concat(eT,"px"),opacity:+!!V,transition:"opacity 0.3s ease-in-out",pointerEvents:V?"auto":"none"},children:(0,d.jsx)("div",{className:"readButton",onClick:m,style:{pointerEvents:"auto"},children:(0,d.jsx)("span",{className:"readButtonText",children:"READ"})})}),c&&l&&(0,d.jsx)("div",{ref:C,className:"titleWrapper",style:{position:"absolute",bottom:"0",left:"50%",transform:"translateX(-50%)",width:"100%"},children:(0,d.jsx)("div",{className:"titleContainer",style:{width:"".concat(eb,"px")},children:eM})})]})})]}),s&&U&&(0,d.jsx)("group",{ref:M,position:[0,ex,.001],renderOrder:1e3,children:(0,d.jsx)(iQ.Html,{center:!0,className:"crossHtml",transform:!0,occlude:!1,children:(0,d.jsxs)("div",{className:"crossContainer",style:{opacity:$?0:ee},onClick:g||void 0,children:[(0,d.jsx)("div",{className:"crossBackground"}),(0,d.jsx)("div",{className:"crossBorder"}),(0,d.jsxs)("div",{className:"crossLines",children:[(0,d.jsx)("div",{className:"crossLine line1"}),(0,d.jsx)("div",{className:"crossLine line2"})]})]})})}),$&&!s&&(0,d.jsx)("group",{ref:E,position:[0,ex,.001],renderOrder:1e3,children:U&&(0,d.jsxs)("mesh",{children:[(0,d.jsx)("planeGeometry",{args:[.01,.01]}),(0,d.jsx)("meshBasicMaterial",{color:"#ff0000",transparent:!0,opacity:1,side:x.DoubleSide,depthWrite:!1,depthTest:!0})]})})]})})}function or(e,t,n){let[r,i]=(0,f.useState)(!1),[o,a]=(0,f.useState)(0),[s]=(0,nl.useStore)("loadingState",{nodesLoaded:0,totalNodes:0,isLoading:!0,nodesVisible:[]});return(0,f.useEffect)(()=>{let e=50*t;if(!s.isLoading&&s.totalNodes>0){let t=setTimeout(()=>{i(!0);let e=Date.now(),t=()=>{let n=Math.min((Date.now()-e)/800,1);a(1-Math.pow(1-n,3)),n<1&&requestAnimationFrame(t)};t()},e);return()=>clearTimeout(t)}},[s.isLoading,s.totalNodes,t,n]),{isVisible:r,opacity:Math.max(o,.1)}}function oi(){let e=(0,nl.getStore)("loadingState");e&&e.setState(e=>(0,tc._)((0,u._)({},e),{isLoading:!1}))}function oo(e){var{nodeData:t}=e,n=(0,c._)(e,["nodeData"]);let{nodes:r,materials:i}=(0,iZ.useGLTF)(t.modelPath);return(0,d.jsx)(os,(0,u._)({nodeData:t,nodes:r,materials:i},n))}function oa(e){var{nodeData:t}=e,n=(0,c._)(e,["nodeData"]);return(0,d.jsx)(os,(0,u._)({nodeData:t,nodes:{},materials:{}},n))}function os(t){var n,r,i,o,a,s;let{nodeData:l,nodes:c,materials:h,showAllLines:m,props:p,setTitle:g,setDefault:v,selectedComponent:y}=t,x=(0,f.useRef)(),[w,_]=(0,f.useState)(!1),[A,S]=(0,f.useState)(!1),[b,M]=(0,f.useState)(0),[E,j]=(0,f.useState)(!1),[C,T]=(0,nl.useStore)("".concat(l.id,"Store"),!1),N=(0,f.useRef)(!1),k=l.position||[0,0,0];(0,f.useMemo)(()=>iK(),[]),i0(l.id,w),i1(l.id);let[R]=(0,nl.useStore)("elementOpacityStore",{}),F=void 0!==R[l.id]?R[l.id]:1,[z]=(0,nl.useStore)("highlightedNodesStore",[]),[L]=(0,nl.useStore)("secondaryHighlightedArticlesStore",[]),G=void 0!==l.index?l.index:0,{isVisible:U,opacity:I}=or(l.id,G,83),O=null==L?void 0:L.includes(l.id),P=(0,f.useMemo)(()=>U?F*I:0,[U,F,I]),[B,D]=(0,nl.useStore)("selectedNodeStore",null),[,W]=(0,nl.useStore)("walkThroughActive",!1),H=(0,f.useMemo)(()=>B&&B.id!==l.id&&!(null==z?void 0:z.includes(l.id))&&!O,[B,l.id,z,O]),V=(0,f.useMemo)(()=>{var e;return(null==B?void 0:B.id)===l.id||(null==z?void 0:z.includes(l.id))&&(null==B||null==(e=B.id)?void 0:e.startsWith("G"))},[B,l.id,z]),q=(0,f.useMemo)(()=>H?[6.48,8.64,1]:V?[10.8*1.3,14.4*1.3,1]:[10.8,14.4,1],[H,V]),[,X]=(0,nl.useStore)("highlightedNodesStore",[]),[Y]=(0,nl.useStore)("cameraInteractionStore",!1);(0,f.useEffect)(()=>{!N.current&&B&&B.id!==l.id&&w&&requestAnimationFrame(()=>{N.current||(M(0),S(!1),_(!1),T(!1))})},[B,w,l.id,T]);let[J,Z]=(0,f.useState)(!1);(0,f.useEffect)(()=>{if(!l.connections||0===l.connections.length)return void Z(!1);let t=()=>{let{getStore:t}=e.r(77741);Z(l.connections.some(e=>{try{let n=t("".concat(e,"Store"),!1);return!0===n}catch(e){return!1}}))};t();let n=setInterval(t,500);return()=>clearInterval(n)},[l.connections]);let Q=(0,f.useCallback)(e=>{e&&e.stopPropagation(),M(e=>{let t=+(0===e);return 1===t?(N.current=!0,requestAnimationFrame(()=>{S(!0),_(!0),T(!0),g&&g(),setTimeout(()=>{N.current=!1},100)})):(S(!1),_(!1),v(),T(!1)),t})},[T,g,v]),$=(0,f.useCallback)(e=>{e.stopPropagation(),M(0),S(!1),_(!1),T(!1),D(null),X([]),W(!1),v&&v()},[T,D,X,W,v]);return(0,f.useEffect)(()=>{1===b&&(_(!0),g&&g(),T(!0))},[A,g,T]),(0,f.useEffect)(()=>{if(!l.id)return;let e=()=>{let e=window.location.hash.substring(1);e!==l.id||E?e!==l.id&&E&&""!==e?(j(!1),v(),M(0),S(!1),_(!1),T(!1)):""===e&&E&&(j(!1),v(),M(0),S(!1),_(!1),T(!1)):setTimeout(()=>{j(!0)},1e3)};return e(),window.addEventListener("hashchange",e),()=>{window.removeEventListener("hashchange",e)}},[l.id,E,v,T]),(0,d.jsx)(d.Fragment,{children:(0,d.jsx)("group",(0,tc._)((0,u._)({},p),{dispose:null,frustumCulled:!1,children:(0,d.jsxs)("group",{position:k,scale:[.5,.5,.5],onClick:Q,opacity:P,ref:x,className:"articleNodeGroup",frustumCulled:!1,children:[!J&&(0,d.jsx)(on,{imageUrl:l.imageUrl,position:[0,0,0],scale:q,tiltAmount:.15,opacity:P,faceCamera:V||O,showCross:(null==B?void 0:B.id)===l.id&&!O,title:l.title,showTitle:(null==B?void 0:B.id)===l.id||(null==z?void 0:z.includes(l.id))&&(null==B||null==(n=B.id)?void 0:n.startsWith("G")),showReadButton:(null==B?void 0:B.id)===l.id||(null==z?void 0:z.includes(l.id))&&(null==B||null==(r=B.id)?void 0:r.startsWith("G")),onReadClick:function(e){e.stopPropagation(),j(!0),l.id&&window.history.pushState(null,"","#".concat(l.id))},onCloseCross:$,onClick:Q,nodeId:l.id,highlightState:{isSelected:(null==B?void 0:B.id)===l.id,isHighlighted:null==z?void 0:z.includes(l.id),isSecondaryHighlighted:O,hasSelection:!!B}}),(0,d.jsx)(iQ.Html,{center:!0,children:(0,d.jsx)(nN.default,{isOpen:E,contentLabel:"Article Modal",className:"archive-modal-content",overlayClassName:"archive-modal-overlay",bodyOpenClassName:"archive-modal-open",htmlOpenClassName:"archive-modal-open",children:(0,d.jsx)(i$.default,{closeModal:()=>void(j(!1),v(),M(0),S(!1),_(!1),T(!1),window.location.hash==="#".concat(l.id)&&window.history.pushState(null,"",window.location.pathname)),connect1:(null==(i=l.connectionKeywords)?void 0:i[0])||"",connect2:(null==(o=l.connectionKeywords)?void 0:o[1])||"",connect3:(null==(a=l.connectionKeywords)?void 0:a[2])||"",connect4:(null==(s=l.connectionKeywords)?void 0:s[3])||"",img:l.imageUrl,title:l.title,author:l.author,content:l.content,authorBio:l.authorBio,keywords:l.keywords,photoCredit:l.photoCredit})})})]})}))})}let ol=f.default.memo(function(e){var{nodeData:t}=e,n=(0,c._)(e,["nodeData"]);return t.modelPath&&""!==t.modelPath.trim()?(0,d.jsx)(f.Suspense,{fallback:null,children:(0,d.jsx)(oo,(0,u._)({nodeData:t},n))}):(0,d.jsx)(oa,(0,u._)({nodeData:t},n))},(e,t)=>{let n=e.nodeData.position||[0,0,0],r=t.nodeData.position||[0,0,0];return n[0]===r[0]&&n[1]===r[1]&&n[2]===r[2]&&e.nodeData.id===t.nodeData.id&&e.showAllLines===t.showAllLines});function ou(e){var{nodeData:t}=e,n=(0,c._)(e,["nodeData"]);let{nodes:r,materials:i}=(0,iZ.useGLTF)(t.modelPath);return(0,d.jsx)(oc,(0,u._)({nodeData:t,nodes:r,materials:i},n))}function od(e){var{nodeData:t}=e,n=(0,c._)(e,["nodeData"]);return(0,d.jsx)(oc,(0,u._)({nodeData:t,nodes:{},materials:{}},n))}function oc(e){let{nodeData:t,nodes:n,materials:r,showAllLines:i,title:o,active:a,props:s,setTitle:l,setDefault:c,glossaryShellComponent:h}=e,m=(0,f.useRef)(),[p,g]=(0,f.useState)(!1),[v,y]=(0,f.useState)(!1),[w,_]=(0,f.useState)(0),[A,S]=(0,f.useState)(!1),b=(0,f.useRef)(!1),M=t.position||[0,0,0],[E]=(0,nl.useStore)("elementOpacityStore",{}),j=void 0!==E[t.id]?E[t.id]:1;(0,f.useMemo)(()=>1.93,[]);let C=void 0!==t.index?t.index:0,{isVisible:T,opacity:N}=or(t.id,C,83),k=(0,f.useMemo)(()=>T?j*N:0,[T,j,N]),R=(0,f.useMemo)(()=>t.id&&t.id.startsWith("G")&&.01>Math.abs(k-.3),[k,t.id]);(0,f.useMemo)(()=>{let e=iK();return e.opacity=k,e.transparent=k<1,e},[k]),i0(t.id,p),i1(t.id);let[F]=(0,nl.useStore)("highlightedNodesStore",[]),z=(0,f.useMemo)(()=>Array.isArray(F)&&F.includes(t.id),[F,t.id]),[L,G]=(0,nl.useStore)("selectedNodeStore",null),[,U]=(0,nl.useStore)("walkThroughActive",!1),I=(0,f.useMemo)(()=>(null==L?void 0:L.id)===t.id,[L,t.id]),[,O]=(0,nl.useStore)("highlightedNodesStore",[]),P=(0,f.useMemo)(()=>z&&!I&&!p,[z,I,p]),[B,D]=(0,nl.useStore)("".concat(t.id,"Store"),!1);(0,f.useEffect)(()=>{!b.current&&L&&L.id!==t.id&&p&&requestAnimationFrame(()=>{b.current||(_(0),y(!1),g(!1))})},[L,p,t.id]),(0,f.useEffect)(()=>{r&&Object.keys(r).length>0&&Object.values(r).forEach(e=>{e&&(e.opacity=k,e.transparent=k<1)})},[k,r]);let W=(0,f.useCallback)(e=>{e&&e.stopPropagation(),b.current=!0,requestAnimationFrame(()=>{y(e=>!e),_(e=>e+1),D(!1),setTimeout(()=>{b.current=!1},100)})},[D]),H=(0,f.useCallback)(e=>{e.stopPropagation(),_(0),y(!1),g(!1),D(!1),G(null),O([]),U(!1),c&&c()},[D,G,O,U,c]);return(0,f.useEffect)(()=>{1===w?(g(!0),l&&l(),D(!0)):2===w&&(g(!1),_(0),c&&c())},[v,l,c,D]),(0,f.useEffect)(()=>{i?_(1):i||_(0)},[i]),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("group",(0,tc._)((0,u._)({},s),{dispose:null,position:M,scale:[1,1,1],onClick:W,ref:m,opacity:k,className:"glossaryNodeGroup",frustumCulled:!1,children:[(0,d.jsxs)("mesh",{position:[0,0,0],visible:!1,children:[(0,d.jsx)("planeGeometry",{args:[5,2]}),(0,d.jsx)("meshBasicMaterial",{transparent:!0,opacity:0,side:x.DoubleSide})]}),(0,d.jsx)(iQ.Html,{center:!0,children:(0,d.jsxs)("div",{className:"glossaryContainer",children:[(0,d.jsxs)("div",{className:"glossaryPill ".concat(I||z||p?"selected":""," ").concat(P?"secondaryHighlighted":""," ").concat(z||p?"highlighted":""," ").concat(R?"dimmed":""),onClick:e=>{e.stopPropagation(),W()},style:{opacity:k},children:[(0,d.jsx)("span",{className:"glossaryPillTitle",children:(o||t.title||"").toUpperCase()}),(I||z||p)&&t.hasOpenButton&&(0,d.jsx)("span",{className:"glossaryPillOpenButton",onClick:e=>{e.stopPropagation();let n=(t.title||"").toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,"");sessionStorage.setItem("fromLivingContinuity",Date.now().toString()),window.location.href="/glossary#".concat(n)},children:"OPEN"})]}),(I||p)&&!P&&(0,d.jsxs)("div",{className:"glossaryCross ".concat(I||p?"selected":""),style:{opacity:k},onClick:H,children:[(0,d.jsx)("div",{className:"glossaryCrossBackground"}),(0,d.jsx)("div",{className:"glossaryCrossBorder"}),(0,d.jsxs)("div",{className:"glossaryCrossLines",children:[(0,d.jsx)("div",{className:"glossaryCrossLine line1"}),(0,d.jsx)("div",{className:"glossaryCrossLine line2"})]})]})]})})]})),!0==p&&(0,d.jsx)("group",{children:(0,d.jsx)(na,{points:[...M,...M],color:"#ffffff",lineWidth:1})}),!0==i&&(0,d.jsx)("group",{children:(0,d.jsx)(na,{points:[...M,...M],color:"#ffffff",lineWidth:1})})]})}let oh=f.default.memo(function(e){var{nodeData:t}=e,n=(0,c._)(e,["nodeData"]);return t.modelPath&&""!==t.modelPath.trim()?(0,d.jsx)(f.Suspense,{fallback:null,children:(0,d.jsx)(ou,(0,u._)({nodeData:t},n))}):(0,d.jsx)(od,(0,u._)({nodeData:t},n))},(e,t)=>{let n=e.nodeData.position||[0,0,0],r=t.nodeData.position||[0,0,0];return n[0]===r[0]&&n[1]===r[1]&&n[2]===r[2]&&e.nodeData.id===t.nodeData.id&&e.showAllLines===t.showAllLines});function of(){let[,e]=(0,nl.useStore)("cameraInteractionStore",!1),[t]=(0,nl.useStore)("selectedNodeStore",null),n=(0,f.useRef)(null),r=(0,f.useRef)(!1);return(0,f.useEffect)(()=>{(null==t?void 0:t.id)&&(e(!1),n.current&&(clearTimeout(n.current),n.current=null),r.current=!1)},[t,e]),(0,f.useEffect)(()=>{let t=document.querySelector("canvas");if(!t)return;let i=null,o=!1,a=e=>{i={x:e.clientX,y:e.clientY},o=!1},s=t=>{if(i&&!o){let a=Math.abs(t.clientX-i.x),s=Math.abs(t.clientY-i.y);(a>5||s>5)&&(o=!0,r.current=!0,e(!0),n.current&&(clearTimeout(n.current),n.current=null))}else o&&(r.current=!0,e(!0))},l=()=>{o&&(r.current=!1,n.current&&clearTimeout(n.current),n.current=setTimeout(()=>{r.current||e(!1)},1500)),i=null,o=!1},u=()=>{r.current=!0,e(!0),n.current&&clearTimeout(n.current),n.current=setTimeout(()=>{r.current||e(!1)},2e3)};return t.addEventListener("pointerdown",a,{passive:!0}),t.addEventListener("pointermove",s,{passive:!0}),t.addEventListener("pointerup",l,{passive:!0}),t.addEventListener("wheel",u,{passive:!0}),()=>{t.removeEventListener("pointerdown",a),t.removeEventListener("pointermove",s),t.removeEventListener("pointerup",l),t.removeEventListener("wheel",u),n.current&&clearTimeout(n.current)}},[e]),null}function om(){let[e]=(0,nl.useStore)("selectedNodeStore",null),[t]=(0,nl.useStore)("cameraInteractionStore",!1),n=(0,f.useRef)(null),r=(0,f.useRef)(null);return(0,f.useEffect)(()=>{var i,o,a;let s=(0,nl.getStore)("connectionLinesVisibilityStore");if(r.current&&clearTimeout(r.current),(null==e?void 0:e.id)!==(null==(i=n.current)?void 0:i.id)){let t=(null==e?void 0:e.id)&&!(null==(o=n.current)?void 0:o.id),i=!(null==e?void 0:e.id)&&(null==(a=n.current)?void 0:a.id);t?(s.setState(!1),r.current=setTimeout(()=>{s.setState(!0)},1500)):i&&(s.setState(!1),r.current=setTimeout(()=>{s.setState(!0)},1e3)),n.current=e}return t&&(null==e?void 0:e.id)&&(s.setState(!1),r.current=setTimeout(()=>{s.setState(!0)},1200)),()=>{r.current&&clearTimeout(r.current)}},[e,t]),null}let op=new Set,og=new Set;function ov(e){if(!(!e||op.has(e)||og.has(e))){op.add(e);try{iZ.useGLTF.preload(e)}catch(t){og.add(e),op.delete(e)}}}function oy(e){let{nodeData:t,processedData:n,isActive:r}=e,[,i]=(0,nl.useStore)("selectedNodeStore",null),o=(0,f.useRef)(null),a=(0,f.useRef)(null),s=(0,f.useRef)(new Set),l=(0,f.useRef)(!1),u=(0,f.useRef)(!1),d=(0,f.useRef)(r),c=(0,f.useRef)(t),h=(0,f.useRef)(n);return(0,f.useEffect)(()=>{d.current=r,c.current=t,h.current=n},[r,t,n]),(0,f.useEffect)(()=>{if(!r||!t||!n){o.current&&(clearInterval(o.current),o.current=null),r||(i(null),a.current=null,s.current.clear(),l.current=!1,u.current=!1);return}let e=[...t.articles||[],...t.glossary||[]];if(0===e.length)return;let f=e=>{i({id:e.id,ts:Date.now()})},m=()=>{if(!d.current||!c.current||!h.current)return;o.current&&clearInterval(o.current);let t=[...c.current.articles||[],...c.current.glossary||[]];0!==t.length&&(a.current||(a.current=t[Math.floor(Math.random()*t.length)],s.current.add(a.current.id),f(a.current)),o.current=setInterval(()=>{let t,n;if(!d.current||!c.current||!h.current){o.current&&(clearInterval(o.current),o.current=null);return}(n=0===(t=e.filter(t=>s.current.size>=e.length||!s.current.has(t.id))).length?(s.current.clear(),e[Math.floor(Math.random()*e.length)]):t[Math.floor(Math.random()*t.length)])&&(a.current=n,s.current.add(n.id),f(n))},8e3))};u.current||(u.current=!0,m());let p=()=>{"hidden"===document.visibilityState?(l.current=null!==o.current,o.current&&(clearInterval(o.current),o.current=null)):"visible"===document.visibilityState&&l.current&&d.current&&c.current&&h.current&&m()};return document.addEventListener("visibilitychange",p),()=>{o.current&&(clearInterval(o.current),o.current=null),document.removeEventListener("visibilitychange",p)}},[r,t,n,i]),null}function ox(){let{camera:e}=(0,m.useThree)(),[t]=(0,nl.useStore)("selectedNodeStore",null),[n]=(0,nl.useStore)("highlightedNodesStore",[]),[r]=(0,nl.useStore)("walkThroughActive",!1),i=(0,f.useMemo)(()=>!!t||Array.isArray(n)&&n.length>0,[t,n]),o=(0,f.useMemo)(()=>r?i?47.5:50:i?45:50,[i,r]);return(0,p.useFrame)(()=>{if(e&&e.isPerspectiveCamera){let t=o-e.fov;Math.abs(t)>.1?(e.fov+=.1*t,e.updateProjectionMatrix()):Math.abs(t)>.01&&(e.fov=o,e.updateProjectionMatrix())}}),null}let ow={},o_={},oA=!1,oS=async t=>{if(!ow[t])try{let n=t.toLowerCase(),r=await e.f({"../models/entries_selected/a1":{id:()=>52461,module:()=>e.A(52461)},"../models/entries_selected/a1.jsx":{id:()=>52461,module:()=>e.A(52461)},"../models/entries_selected/a10":{id:()=>2306,module:()=>e.A(2306)},"../models/entries_selected/a10.jsx":{id:()=>2306,module:()=>e.A(2306)},"../models/entries_selected/a11":{id:()=>5703,module:()=>e.A(5703)},"../models/entries_selected/a11.jsx":{id:()=>5703,module:()=>e.A(5703)},"../models/entries_selected/a12":{id:()=>75800,module:()=>e.A(75800)},"../models/entries_selected/a12.jsx":{id:()=>75800,module:()=>e.A(75800)},"../models/entries_selected/a13":{id:()=>11898,module:()=>e.A(11898)},"../models/entries_selected/a13.jsx":{id:()=>11898,module:()=>e.A(11898)},"../models/entries_selected/a14":{id:()=>84880,module:()=>e.A(84880)},"../models/entries_selected/a14.jsx":{id:()=>84880,module:()=>e.A(84880)},"../models/entries_selected/a15":{id:()=>8983,module:()=>e.A(8983)},"../models/entries_selected/a15.jsx":{id:()=>8983,module:()=>e.A(8983)},"../models/entries_selected/a16":{id:()=>41689,module:()=>e.A(41689)},"../models/entries_selected/a16.jsx":{id:()=>41689,module:()=>e.A(41689)},"../models/entries_selected/a17":{id:()=>75114,module:()=>e.A(75114)},"../models/entries_selected/a17.jsx":{id:()=>75114,module:()=>e.A(75114)},"../models/entries_selected/a18":{id:()=>34897,module:()=>e.A(34897)},"../models/entries_selected/a18.jsx":{id:()=>34897,module:()=>e.A(34897)},"../models/entries_selected/a19":{id:()=>28618,module:()=>e.A(28618)},"../models/entries_selected/a19.jsx":{id:()=>28618,module:()=>e.A(28618)},"../models/entries_selected/a2":{id:()=>48152,module:()=>e.A(48152)},"../models/entries_selected/a2.jsx":{id:()=>48152,module:()=>e.A(48152)},"../models/entries_selected/a20":{id:()=>34474,module:()=>e.A(34474)},"../models/entries_selected/a20.jsx":{id:()=>34474,module:()=>e.A(34474)},"../models/entries_selected/a21":{id:()=>28979,module:()=>e.A(28979)},"../models/entries_selected/a21.jsx":{id:()=>28979,module:()=>e.A(28979)},"../models/entries_selected/a22":{id:()=>76036,module:()=>e.A(76036)},"../models/entries_selected/a22.jsx":{id:()=>76036,module:()=>e.A(76036)},"../models/entries_selected/a23":{id:()=>45881,module:()=>e.A(45881)},"../models/entries_selected/a23.jsx":{id:()=>45881,module:()=>e.A(45881)},"../models/entries_selected/a24":{id:()=>55411,module:()=>e.A(55411)},"../models/entries_selected/a24.jsx":{id:()=>55411,module:()=>e.A(55411)},"../models/entries_selected/a25":{id:()=>87255,module:()=>e.A(87255)},"../models/entries_selected/a25.jsx":{id:()=>87255,module:()=>e.A(87255)},"../models/entries_selected/a26":{id:()=>70328,module:()=>e.A(70328)},"../models/entries_selected/a26.jsx":{id:()=>70328,module:()=>e.A(70328)},"../models/entries_selected/a27":{id:()=>92950,module:()=>e.A(92950)},"../models/entries_selected/a27.jsx":{id:()=>92950,module:()=>e.A(92950)},"../models/entries_selected/a28":{id:()=>83276,module:()=>e.A(83276)},"../models/entries_selected/a28.jsx":{id:()=>83276,module:()=>e.A(83276)},"../models/entries_selected/a29":{id:()=>74511,module:()=>e.A(74511)},"../models/entries_selected/a29.jsx":{id:()=>74511,module:()=>e.A(74511)},"../models/entries_selected/a3":{id:()=>14166,module:()=>e.A(14166)},"../models/entries_selected/a3.jsx":{id:()=>14166,module:()=>e.A(14166)},"../models/entries_selected/a4":{id:()=>13672,module:()=>e.A(13672)},"../models/entries_selected/a4.jsx":{id:()=>13672,module:()=>e.A(13672)},"../models/entries_selected/a5":{id:()=>35620,module:()=>e.A(35620)},"../models/entries_selected/a5.jsx":{id:()=>35620,module:()=>e.A(35620)},"../models/entries_selected/a6":{id:()=>20369,module:()=>e.A(20369)},"../models/entries_selected/a6.jsx":{id:()=>20369,module:()=>e.A(20369)},"../models/entries_selected/a7":{id:()=>69435,module:()=>e.A(69435)},"../models/entries_selected/a7.jsx":{id:()=>69435,module:()=>e.A(69435)},"../models/entries_selected/a8":{id:()=>10712,module:()=>e.A(10712)},"../models/entries_selected/a8.jsx":{id:()=>10712,module:()=>e.A(10712)},"../models/entries_selected/a9":{id:()=>10686,module:()=>e.A(10686)},"../models/entries_selected/a9.jsx":{id:()=>10686,module:()=>e.A(10686)}}).import("../models/entries_selected/".concat(n)),i="".concat(t,"Selected2");ow[t]=r[i]||r.default||r["".concat(t,"Selected")]}catch(e){return console.warn("Could not load selected component for ".concat(t,":"),e),null}return ow[t]},ob=async t=>{if(!t)return null;let n=t.replace("../glossaryShell/","");if(!o_[n])try{let t;try{t=await e.f({"../models/glossaryShell/accessibility":{id:()=>45201,module:()=>e.A(45201)},"../models/glossaryShell/accessibility.jsx":{id:()=>45201,module:()=>e.A(45201)},"../models/glossaryShell/appropriations":{id:()=>58842,module:()=>e.A(58842)},"../models/glossaryShell/appropriations.jsx":{id:()=>58842,module:()=>e.A(58842)},"../models/glossaryShell/archive":{id:()=>6474,module:()=>e.A(6474)},"../models/glossaryShell/archive.jsx":{id:()=>6474,module:()=>e.A(6474)},"../models/glossaryShell/belonging":{id:()=>10696,module:()=>e.A(10696)},"../models/glossaryShell/belonging.jsx":{id:()=>10696,module:()=>e.A(10696)},"../models/glossaryShell/built-environment":{id:()=>37012,module:()=>e.A(37012)},"../models/glossaryShell/built-environment.jsx":{id:()=>37012,module:()=>e.A(37012)},"../models/glossaryShell/citizen":{id:()=>7082,module:()=>e.A(7082)},"../models/glossaryShell/citizen.jsx":{id:()=>7082,module:()=>e.A(7082)},"../models/glossaryShell/climate":{id:()=>27219,module:()=>e.A(27219)},"../models/glossaryShell/climate.jsx":{id:()=>27219,module:()=>e.A(27219)},"../models/glossaryShell/cohesion":{id:()=>12682,module:()=>e.A(12682)},"../models/glossaryShell/cohesion.jsx":{id:()=>12682,module:()=>e.A(12682)},"../models/glossaryShell/collective":{id:()=>42455,module:()=>e.A(42455)},"../models/glossaryShell/collective.jsx":{id:()=>42455,module:()=>e.A(42455)},"../models/glossaryShell/colonialism":{id:()=>50574,module:()=>e.A(50574)},"../models/glossaryShell/colonialism.jsx":{id:()=>50574,module:()=>e.A(50574)},"../models/glossaryShell/commons":{id:()=>15648,module:()=>e.A(15648)},"../models/glossaryShell/commons.jsx":{id:()=>15648,module:()=>e.A(15648)},"../models/glossaryShell/demolition":{id:()=>37517,module:()=>e.A(37517)},"../models/glossaryShell/demolition.jsx":{id:()=>37517,module:()=>e.A(37517)},"../models/glossaryShell/density":{id:()=>40104,module:()=>e.A(40104)},"../models/glossaryShell/density.jsx":{id:()=>40104,module:()=>e.A(40104)},"../models/glossaryShell/desert":{id:()=>16255,module:()=>e.A(16255)},"../models/glossaryShell/desert.jsx":{id:()=>16255,module:()=>e.A(16255)},"../models/glossaryShell/displacement":{id:()=>18874,module:()=>e.A(18874)},"../models/glossaryShell/displacement.jsx":{id:()=>18874,module:()=>e.A(18874)},"../models/glossaryShell/dispossession":{id:()=>1982,module:()=>e.A(1982)},"../models/glossaryShell/dispossession.jsx":{id:()=>1982,module:()=>e.A(1982)},"../models/glossaryShell/ecology":{id:()=>11720,module:()=>e.A(11720)},"../models/glossaryShell/ecology.jsx":{id:()=>11720,module:()=>e.A(11720)},"../models/glossaryShell/everyday-urbanism":{id:()=>82996,module:()=>e.A(82996)},"../models/glossaryShell/everyday-urbanism.jsx":{id:()=>82996,module:()=>e.A(82996)},"../models/glossaryShell/eviction":{id:()=>89282,module:()=>e.A(89282)},"../models/glossaryShell/eviction.jsx":{id:()=>89282,module:()=>e.A(89282)},"../models/glossaryShell/fragmentation":{id:()=>33005,module:()=>e.A(33005)},"../models/glossaryShell/fragmentation.jsx":{id:()=>33005,module:()=>e.A(33005)},"../models/glossaryShell/gender":{id:()=>77517,module:()=>e.A(77517)},"../models/glossaryShell/gender.jsx":{id:()=>77517,module:()=>e.A(77517)},"../models/glossaryShell/gentrification":{id:()=>47061,module:()=>e.A(47061)},"../models/glossaryShell/gentrification.jsx":{id:()=>47061,module:()=>e.A(47061)},"../models/glossaryShell/green-space":{id:()=>79594,module:()=>e.A(79594)},"../models/glossaryShell/green-space.jsx":{id:()=>79594,module:()=>e.A(79594)},"../models/glossaryShell/heritage":{id:()=>93699,module:()=>e.A(93699)},"../models/glossaryShell/heritage.jsx":{id:()=>93699,module:()=>e.A(93699)},"../models/glossaryShell/housing":{id:()=>22338,module:()=>e.A(22338)},"../models/glossaryShell/housing.jsx":{id:()=>22338,module:()=>e.A(22338)},"../models/glossaryShell/identity":{id:()=>42835,module:()=>e.A(42835)},"../models/glossaryShell/identity.jsx":{id:()=>42835,module:()=>e.A(42835)},"../models/glossaryShell/indigenous":{id:()=>26592,module:()=>e.A(26592)},"../models/glossaryShell/indigenous.jsx":{id:()=>26592,module:()=>e.A(26592)},"../models/glossaryShell/infrastructure":{id:()=>95273,module:()=>e.A(95273)},"../models/glossaryShell/infrastructure.jsx":{id:()=>95273,module:()=>e.A(95273)},"../models/glossaryShell/kafala-visa":{id:()=>40857,module:()=>e.A(40857)},"../models/glossaryShell/kafala-visa.jsx":{id:()=>40857,module:()=>e.A(40857)},"../models/glossaryShell/knowledge":{id:()=>67653,module:()=>e.A(67653)},"../models/glossaryShell/knowledge.jsx":{id:()=>67653,module:()=>e.A(67653)},"../models/glossaryShell/labour":{id:()=>47709,module:()=>e.A(47709)},"../models/glossaryShell/labour.jsx":{id:()=>47709,module:()=>e.A(47709)},"../models/glossaryShell/land-use":{id:()=>42984,module:()=>e.A(42984)},"../models/glossaryShell/land-use.jsx":{id:()=>42984,module:()=>e.A(42984)},"../models/glossaryShell/marginalisation":{id:()=>63237,module:()=>e.A(63237)},"../models/glossaryShell/marginalisation.jsx":{id:()=>63237,module:()=>e.A(63237)},"../models/glossaryShell/memory":{id:()=>78168,module:()=>e.A(78168)},"../models/glossaryShell/memory.jsx":{id:()=>78168,module:()=>e.A(78168)},"../models/glossaryShell/migrant":{id:()=>80634,module:()=>e.A(80634)},"../models/glossaryShell/migrant.jsx":{id:()=>80634,module:()=>e.A(80634)},"../models/glossaryShell/multispecies":{id:()=>55623,module:()=>e.A(55623)},"../models/glossaryShell/multispecies.jsx":{id:()=>55623,module:()=>e.A(55623)},"../models/glossaryShell/narrative":{id:()=>74770,module:()=>e.A(74770)},"../models/glossaryShell/narrative.jsx":{id:()=>74770,module:()=>e.A(74770)},"../models/glossaryShell/neoliberalism":{id:()=>595,module:()=>e.A(595)},"../models/glossaryShell/neoliberalism.jsx":{id:()=>595,module:()=>e.A(595)},"../models/glossaryShell/park":{id:()=>95231,module:()=>e.A(95231)},"../models/glossaryShell/park.jsx":{id:()=>95231,module:()=>e.A(95231)},"../models/glossaryShell/periphery":{id:()=>30819,module:()=>e.A(30819)},"../models/glossaryShell/periphery.jsx":{id:()=>30819,module:()=>e.A(30819)},"../models/glossaryShell/placemaking":{id:()=>21900,module:()=>e.A(21900)},"../models/glossaryShell/placemaking.jsx":{id:()=>21900,module:()=>e.A(21900)},"../models/glossaryShell/power":{id:()=>60182,module:()=>e.A(60182)},"../models/glossaryShell/power.jsx":{id:()=>60182,module:()=>e.A(60182)},"../models/glossaryShell/precarity":{id:()=>96404,module:()=>e.A(96404)},"../models/glossaryShell/precarity.jsx":{id:()=>96404,module:()=>e.A(96404)},"../models/glossaryShell/privacy":{id:()=>51264,module:()=>e.A(51264)},"../models/glossaryShell/privacy.jsx":{id:()=>51264,module:()=>e.A(51264)},"../models/glossaryShell/public-space":{id:()=>25561,module:()=>e.A(25561)},"../models/glossaryShell/public-space.jsx":{id:()=>25561,module:()=>e.A(25561)},"../models/glossaryShell/redevelopment":{id:()=>48279,module:()=>e.A(48279)},"../models/glossaryShell/redevelopment.jsx":{id:()=>48279,module:()=>e.A(48279)},"../models/glossaryShell/rent":{id:()=>50028,module:()=>e.A(50028)},"../models/glossaryShell/rent.jsx":{id:()=>50028,module:()=>e.A(50028)},"../models/glossaryShell/residents":{id:()=>46754,module:()=>e.A(46754)},"../models/glossaryShell/residents.jsx":{id:()=>46754,module:()=>e.A(46754)},"../models/glossaryShell/segregation":{id:()=>74905,module:()=>e.A(74905)},"../models/glossaryShell/segregation.jsx":{id:()=>74905,module:()=>e.A(74905)},"../models/glossaryShell/sustainability":{id:()=>72739,module:()=>e.A(72739)},"../models/glossaryShell/sustainability.jsx":{id:()=>72739,module:()=>e.A(72739)},"../models/glossaryShell/typology":{id:()=>87810,module:()=>e.A(87810)},"../models/glossaryShell/typology.jsx":{id:()=>87810,module:()=>e.A(87810)},"../models/glossaryShell/urban-informality":{id:()=>88543,module:()=>e.A(88543)},"../models/glossaryShell/urban-informality.jsx":{id:()=>88543,module:()=>e.A(88543)},"../models/glossaryShell/urban-planning":{id:()=>34763,module:()=>e.A(34763)},"../models/glossaryShell/urban-planning.jsx":{id:()=>34763,module:()=>e.A(34763)},"../models/glossaryShell/urban-renewal":{id:()=>50584,module:()=>e.A(50584)},"../models/glossaryShell/urban-renewal.jsx":{id:()=>50584,module:()=>e.A(50584)},"../models/glossaryShell/waste":{id:()=>70257,module:()=>e.A(70257)},"../models/glossaryShell/waste.jsx":{id:()=>70257,module:()=>e.A(70257)},"../models/glossaryShell/zones-zoning":{id:()=>76495,module:()=>e.A(76495)},"../models/glossaryShell/zones-zoning.jsx":{id:()=>76495,module:()=>e.A(76495)}}).import("../models/glossaryShell/".concat(n))}catch(i){let r=n.replace(/-/g,"");try{t=await e.f({"../models/glossaryShell/accessibility":{id:()=>45201,module:()=>e.A(45201)},"../models/glossaryShell/accessibility.jsx":{id:()=>45201,module:()=>e.A(45201)},"../models/glossaryShell/appropriations":{id:()=>58842,module:()=>e.A(58842)},"../models/glossaryShell/appropriations.jsx":{id:()=>58842,module:()=>e.A(58842)},"../models/glossaryShell/archive":{id:()=>6474,module:()=>e.A(6474)},"../models/glossaryShell/archive.jsx":{id:()=>6474,module:()=>e.A(6474)},"../models/glossaryShell/belonging":{id:()=>10696,module:()=>e.A(10696)},"../models/glossaryShell/belonging.jsx":{id:()=>10696,module:()=>e.A(10696)},"../models/glossaryShell/built-environment":{id:()=>37012,module:()=>e.A(37012)},"../models/glossaryShell/built-environment.jsx":{id:()=>37012,module:()=>e.A(37012)},"../models/glossaryShell/citizen":{id:()=>7082,module:()=>e.A(7082)},"../models/glossaryShell/citizen.jsx":{id:()=>7082,module:()=>e.A(7082)},"../models/glossaryShell/climate":{id:()=>27219,module:()=>e.A(27219)},"../models/glossaryShell/climate.jsx":{id:()=>27219,module:()=>e.A(27219)},"../models/glossaryShell/cohesion":{id:()=>12682,module:()=>e.A(12682)},"../models/glossaryShell/cohesion.jsx":{id:()=>12682,module:()=>e.A(12682)},"../models/glossaryShell/collective":{id:()=>42455,module:()=>e.A(42455)},"../models/glossaryShell/collective.jsx":{id:()=>42455,module:()=>e.A(42455)},"../models/glossaryShell/colonialism":{id:()=>50574,module:()=>e.A(50574)},"../models/glossaryShell/colonialism.jsx":{id:()=>50574,module:()=>e.A(50574)},"../models/glossaryShell/commons":{id:()=>15648,module:()=>e.A(15648)},"../models/glossaryShell/commons.jsx":{id:()=>15648,module:()=>e.A(15648)},"../models/glossaryShell/demolition":{id:()=>37517,module:()=>e.A(37517)},"../models/glossaryShell/demolition.jsx":{id:()=>37517,module:()=>e.A(37517)},"../models/glossaryShell/density":{id:()=>40104,module:()=>e.A(40104)},"../models/glossaryShell/density.jsx":{id:()=>40104,module:()=>e.A(40104)},"../models/glossaryShell/desert":{id:()=>16255,module:()=>e.A(16255)},"../models/glossaryShell/desert.jsx":{id:()=>16255,module:()=>e.A(16255)},"../models/glossaryShell/displacement":{id:()=>18874,module:()=>e.A(18874)},"../models/glossaryShell/displacement.jsx":{id:()=>18874,module:()=>e.A(18874)},"../models/glossaryShell/dispossession":{id:()=>1982,module:()=>e.A(1982)},"../models/glossaryShell/dispossession.jsx":{id:()=>1982,module:()=>e.A(1982)},"../models/glossaryShell/ecology":{id:()=>11720,module:()=>e.A(11720)},"../models/glossaryShell/ecology.jsx":{id:()=>11720,module:()=>e.A(11720)},"../models/glossaryShell/everyday-urbanism":{id:()=>82996,module:()=>e.A(82996)},"../models/glossaryShell/everyday-urbanism.jsx":{id:()=>82996,module:()=>e.A(82996)},"../models/glossaryShell/eviction":{id:()=>89282,module:()=>e.A(89282)},"../models/glossaryShell/eviction.jsx":{id:()=>89282,module:()=>e.A(89282)},"../models/glossaryShell/fragmentation":{id:()=>33005,module:()=>e.A(33005)},"../models/glossaryShell/fragmentation.jsx":{id:()=>33005,module:()=>e.A(33005)},"../models/glossaryShell/gender":{id:()=>77517,module:()=>e.A(77517)},"../models/glossaryShell/gender.jsx":{id:()=>77517,module:()=>e.A(77517)},"../models/glossaryShell/gentrification":{id:()=>47061,module:()=>e.A(47061)},"../models/glossaryShell/gentrification.jsx":{id:()=>47061,module:()=>e.A(47061)},"../models/glossaryShell/green-space":{id:()=>79594,module:()=>e.A(79594)},"../models/glossaryShell/green-space.jsx":{id:()=>79594,module:()=>e.A(79594)},"../models/glossaryShell/heritage":{id:()=>93699,module:()=>e.A(93699)},"../models/glossaryShell/heritage.jsx":{id:()=>93699,module:()=>e.A(93699)},"../models/glossaryShell/housing":{id:()=>22338,module:()=>e.A(22338)},"../models/glossaryShell/housing.jsx":{id:()=>22338,module:()=>e.A(22338)},"../models/glossaryShell/identity":{id:()=>42835,module:()=>e.A(42835)},"../models/glossaryShell/identity.jsx":{id:()=>42835,module:()=>e.A(42835)},"../models/glossaryShell/indigenous":{id:()=>26592,module:()=>e.A(26592)},"../models/glossaryShell/indigenous.jsx":{id:()=>26592,module:()=>e.A(26592)},"../models/glossaryShell/infrastructure":{id:()=>95273,module:()=>e.A(95273)},"../models/glossaryShell/infrastructure.jsx":{id:()=>95273,module:()=>e.A(95273)},"../models/glossaryShell/kafala-visa":{id:()=>40857,module:()=>e.A(40857)},"../models/glossaryShell/kafala-visa.jsx":{id:()=>40857,module:()=>e.A(40857)},"../models/glossaryShell/knowledge":{id:()=>67653,module:()=>e.A(67653)},"../models/glossaryShell/knowledge.jsx":{id:()=>67653,module:()=>e.A(67653)},"../models/glossaryShell/labour":{id:()=>47709,module:()=>e.A(47709)},"../models/glossaryShell/labour.jsx":{id:()=>47709,module:()=>e.A(47709)},"../models/glossaryShell/land-use":{id:()=>42984,module:()=>e.A(42984)},"../models/glossaryShell/land-use.jsx":{id:()=>42984,module:()=>e.A(42984)},"../models/glossaryShell/marginalisation":{id:()=>63237,module:()=>e.A(63237)},"../models/glossaryShell/marginalisation.jsx":{id:()=>63237,module:()=>e.A(63237)},"../models/glossaryShell/memory":{id:()=>78168,module:()=>e.A(78168)},"../models/glossaryShell/memory.jsx":{id:()=>78168,module:()=>e.A(78168)},"../models/glossaryShell/migrant":{id:()=>80634,module:()=>e.A(80634)},"../models/glossaryShell/migrant.jsx":{id:()=>80634,module:()=>e.A(80634)},"../models/glossaryShell/multispecies":{id:()=>55623,module:()=>e.A(55623)},"../models/glossaryShell/multispecies.jsx":{id:()=>55623,module:()=>e.A(55623)},"../models/glossaryShell/narrative":{id:()=>74770,module:()=>e.A(74770)},"../models/glossaryShell/narrative.jsx":{id:()=>74770,module:()=>e.A(74770)},"../models/glossaryShell/neoliberalism":{id:()=>595,module:()=>e.A(595)},"../models/glossaryShell/neoliberalism.jsx":{id:()=>595,module:()=>e.A(595)},"../models/glossaryShell/park":{id:()=>95231,module:()=>e.A(95231)},"../models/glossaryShell/park.jsx":{id:()=>95231,module:()=>e.A(95231)},"../models/glossaryShell/periphery":{id:()=>30819,module:()=>e.A(30819)},"../models/glossaryShell/periphery.jsx":{id:()=>30819,module:()=>e.A(30819)},"../models/glossaryShell/placemaking":{id:()=>21900,module:()=>e.A(21900)},"../models/glossaryShell/placemaking.jsx":{id:()=>21900,module:()=>e.A(21900)},"../models/glossaryShell/power":{id:()=>60182,module:()=>e.A(60182)},"../models/glossaryShell/power.jsx":{id:()=>60182,module:()=>e.A(60182)},"../models/glossaryShell/precarity":{id:()=>96404,module:()=>e.A(96404)},"../models/glossaryShell/precarity.jsx":{id:()=>96404,module:()=>e.A(96404)},"../models/glossaryShell/privacy":{id:()=>51264,module:()=>e.A(51264)},"../models/glossaryShell/privacy.jsx":{id:()=>51264,module:()=>e.A(51264)},"../models/glossaryShell/public-space":{id:()=>25561,module:()=>e.A(25561)},"../models/glossaryShell/public-space.jsx":{id:()=>25561,module:()=>e.A(25561)},"../models/glossaryShell/redevelopment":{id:()=>48279,module:()=>e.A(48279)},"../models/glossaryShell/redevelopment.jsx":{id:()=>48279,module:()=>e.A(48279)},"../models/glossaryShell/rent":{id:()=>50028,module:()=>e.A(50028)},"../models/glossaryShell/rent.jsx":{id:()=>50028,module:()=>e.A(50028)},"../models/glossaryShell/residents":{id:()=>46754,module:()=>e.A(46754)},"../models/glossaryShell/residents.jsx":{id:()=>46754,module:()=>e.A(46754)},"../models/glossaryShell/segregation":{id:()=>74905,module:()=>e.A(74905)},"../models/glossaryShell/segregation.jsx":{id:()=>74905,module:()=>e.A(74905)},"../models/glossaryShell/sustainability":{id:()=>72739,module:()=>e.A(72739)},"../models/glossaryShell/sustainability.jsx":{id:()=>72739,module:()=>e.A(72739)},"../models/glossaryShell/typology":{id:()=>87810,module:()=>e.A(87810)},"../models/glossaryShell/typology.jsx":{id:()=>87810,module:()=>e.A(87810)},"../models/glossaryShell/urban-informality":{id:()=>88543,module:()=>e.A(88543)},"../models/glossaryShell/urban-informality.jsx":{id:()=>88543,module:()=>e.A(88543)},"../models/glossaryShell/urban-planning":{id:()=>34763,module:()=>e.A(34763)},"../models/glossaryShell/urban-planning.jsx":{id:()=>34763,module:()=>e.A(34763)},"../models/glossaryShell/urban-renewal":{id:()=>50584,module:()=>e.A(50584)},"../models/glossaryShell/urban-renewal.jsx":{id:()=>50584,module:()=>e.A(50584)},"../models/glossaryShell/waste":{id:()=>70257,module:()=>e.A(70257)},"../models/glossaryShell/waste.jsx":{id:()=>70257,module:()=>e.A(70257)},"../models/glossaryShell/zones-zoning":{id:()=>76495,module:()=>e.A(76495)},"../models/glossaryShell/zones-zoning.jsx":{id:()=>76495,module:()=>e.A(76495)}}).import("../models/glossaryShell/".concat(r)),n=r}catch(e){throw e}}let r=n.split(/[-_]/).map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join("");o_[n]=t.default||t[r]||Object.values(t).find(e=>"function"==typeof e)}catch(e){return console.warn("Could not load glossary shell for ".concat(n,":"),e),null}return o_[n]};e.s(["default",0,()=>{let[e]=(0,nl.useStore)("cameraOptions"),[t]=(0,nl.useStore)("livingContinuity_sceneRotation",!1),[n,r]=(0,nl.useStore)("walkThroughActive",!1),[i,o]=(0,f.useState)(!0),[a,s]=(0,f.useState)(!0),[l,c]=(0,f.useState)(""),[h,p]=(0,f.useState)(null),[g,v]=(0,f.useState)(null),[y,w]=(0,f.useState)({}),[_,A]=(0,f.useState)({}),[S]=(0,nl.useStore)("selectedNodeStore",null),[b]=(0,nl.useStore)("cameraInteractionStore",!1),[M,E]=(0,f.useState)(!1),[j,C]=(0,f.useState)(!0),[T,N]=(0,f.useState)(!0),[k]=(0,f.useState)(()=>{let e;return[28*Math.cos(e=Math.random()*Math.PI*2),6,28*Math.sin(e)]});(0,f.useEffect)(()=>{fetch("/data/nodes.json?t=".concat(Date.now())).then(e=>{if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));return e.json()}).then(e=>{var t,n,r;let i;(0,f.startTransition)(()=>{var t,n;let r,i,o,a,s,l;p(e),v((r=[],i=[],o=new Map,a=(null==(t=e.articles)?void 0:t.length)||0,l=a+(s=(null==(n=e.glossary)?void 0:n.length)||0),e.articles&&e.articles.forEach((e,t)=>{let n=np(t,l,15,a,s),i=(0,tc._)((0,u._)({},e),{type:"article",position:n,x:n[0],y:n[1],z:n[2],vx:0,vy:0,vz:0,fx:null,fy:null,fz:null});r.push(i),o.set(e.id,i)}),e.glossary&&e.glossary.forEach((e,t)=>{let n=np(a+t,l,15,a,s),i=(0,tc._)((0,u._)({},e),{type:"glossary",position:n,x:n[0],y:n[1],z:n[2],vx:0,vy:0,vz:0,fx:null,fy:null,fz:null});r.push(i),o.set(e.id,i)}),r.forEach(e=>{e.connections&&e.connections.length>0&&e.connections.forEach(t=>{let n=o.get(t);n&&i.push({source:e.id,target:t,sourceNode:e,targetNode:n})})}),{nodes:r,links:i,nodeMap:o}))}),r=((null==(t=e.articles)?void 0:t.length)||0)+((null==(n=e.glossary)?void 0:n.length)||0),(i=(0,nl.getStore)("loadingState"))&&i.setState({nodesLoaded:0,totalNodes:r,isLoading:!0,nodesVisible:[]});let o=e=>{"requestIdleCallback"in window?requestIdleCallback(e,{timeout:2e3}):setTimeout(e,100)},a=async()=>{let t=e.articles||[],n=e.glossary||[],r=async(e,t,n,r)=>{for(let i=0;i<e.length;i+=5)await new Promise(a=>{o(async()=>{let o=e.slice(i,i+5),s=await Promise.allSettled(o.map(async e=>{try{let n=await t(e);return{id:e.id,component:n}}catch(t){return console.warn("Failed to load ".concat(r," component for ").concat(e.id,":"),t),{id:e.id,component:null}}}));(0,f.startTransition)(()=>{n(e=>{let t=(0,u._)({},e);return s.forEach(e=>{var n;"fulfilled"===e.status&&(null==(n=e.value)?void 0:n.component)&&(t[e.value.id]=e.value.component)}),t})}),setTimeout(a,50)})})};await Promise.all([r(t,e=>e.selectedModelPath?oS(e.id):Promise.resolve(null),w,"article"),r(n,e=>e.glossaryShellPath?ob(e.glossaryShellPath):Promise.resolve(null),A,"glossary")]),oi()};o(()=>{e&&(e.articles&&e.articles.forEach(e=>{e.modelPath&&""!==e.modelPath.trim()&&ov(e.modelPath)}),e.glossary&&e.glossary.forEach(e=>{e.modelPath&&""!==e.modelPath.trim()&&ov(e.modelPath)})),(function(e){if(!e)return Promise.resolve();let t=[],n=e.articles||[];for(let e=0;e<n.length;e+=6)n.slice(e,e+6).forEach(e=>{if(e.imageUrl){let n=new Image;n.crossOrigin="anonymous";let r=new Promise(t=>{n.onload=t,n.onerror=t,n.src=e.imageUrl});t.push(r)}}),e+6<n.length&&t.push(new Promise(e=>setTimeout(e,10)));return Promise.allSettled(t)})(e).catch(()=>{})}),o(()=>{a().catch(e=>{console.error("Error loading components:",e),oi()})})}).catch(e=>{console.error("Failed to load node data:",e),(0,f.startTransition)(()=>{p({articles:[],glossary:[]}),v({nodes:[],links:[],nodeMap:new Map})})})},[]),(0,f.useEffect)(()=>{let e,t=setTimeout(()=>{E(!0),e=setTimeout(()=>{C(!1)},20)},10);return()=>{clearTimeout(t),e&&clearTimeout(e)}},[]),(0,f.useEffect)(()=>{let e;return e=console.error,console.error=function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];let i=n[0],o=n.join(" ");"string"==typeof i&&(i.includes("THREE.GLTFLoader")&&i.includes("Couldn't load texture")||i.includes("GLTFLoader")&&i.includes("texture"))||"string"==typeof o&&(o.includes("THREE.GLTFLoader")&&o.includes("texture")||o.includes("GLTFLoader")&&o.includes("texture"))||e.apply(console,n)},()=>{console.error=e}},[]);let R=(0,f.useCallback)(()=>{s(e=>!e)},[]);(0,f.useEffect)(()=>{let e=e=>{"Enter"===e.key&&a&&R()};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[a,R]),(0,f.useEffect)(()=>{if(!a&&g&&h){let e=setTimeout(()=>{r(!0)},8e3);return()=>clearTimeout(e)}},[a,g,h,r]);let F=(0,f.useMemo)(()=>{if(!h)return{};let e={};return h.articles.forEach(t=>{e[t.id]=()=>c(t.title)}),h.glossary.forEach(t=>{e[t.id]=()=>c(t.title||"")}),e},[h]),z=(0,f.useCallback)(()=>c(""),[]),L=f.default.memo(()=>{let{scene:e}=(0,m.useThree)();return(0,f.useEffect)(()=>{e.background=new x.Color(1842204)},[e]),null});L.displayName="SceneBackground";let G=f.default.memo(e=>{let{cameraOptions:t}=e,n=(0,m.useThree)(),[r]=(0,nl.useStore)("selectedNodeStore",null);return(0,f.useEffect)(()=>{if(r||!t||!oA)return;let e={top:[.267,14.68,.6],reset:[5.29,-1.59,6],overview:[0,6,18]}[t];e&&(n.camera.position.set(...e),n.camera.lookAt(0,0,0),n.camera.updateProjectionMatrix())},[t,n.camera,r]),null}),U=f.default.memo(e=>{let{initialPosition:t}=e,{camera:n,set:r}=(0,m.useThree)(),i=f.default.useRef(t);return(0,f.useEffect)(()=>{if(!oA&&i.current){let e=setTimeout(()=>{oA||(n.position.set(...i.current),n.lookAt(0,0,0),n.updateProjectionMatrix(),r({camera:n}),oA=!0)},50);return()=>clearTimeout(e)}},[]),null});return U.displayName="InitialCameraSetup",G.displayName="CameraDolly",(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(nN.default,{isOpen:a,contentLabel:"Welcome Modal",shouldCloseOnOverlayClick:!0,shouldCloseOnEsc:!1,ariaHideApp:!1,className:"welcomeModalContent",overlayClassName:"welcomeModalOverlay",onRequestClose:R,closeTimeoutMS:150,preventScroll:!0,children:(0,d.jsx)("div",{onClick:R,children:(0,d.jsx)(nO,{onClick:R})})}),(!g||!h)&&(0,d.jsx)("div",{className:"welcomeLoading",children:"Loading..."}),(0,d.jsx)("div",{className:"welcomeTopbarWrapper",children:(0,d.jsx)(nI,{title:l})}),(0,d.jsx)("div",{className:"welcomeCanvasWrapper",children:(0,d.jsxs)(tH,{frameloop:i||b||j?"always":"demand",children:[(0,d.jsx)(L,{}),(0,d.jsx)(U,{initialPosition:k}),(0,d.jsx)("ambientLight",{intensity:1}),M&&(0,d.jsx)(f.Suspense,{fallback:null,children:(0,d.jsx)(tP,{preset:"city"})}),(0,d.jsx)(G,{cameraOptions:e}),g&&h&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(oy,{nodeData:h,processedData:g,isActive:n}),(0,d.jsx)(nT,{}),(0,d.jsx)(of,{}),(0,d.jsx)(om,{}),(0,d.jsx)(ox,{}),h.articles.map(e=>{let t=g.nodeMap.get(e.id);if(!t)return null;let n=y[e.id],r=F[e.id]||z;return(0,d.jsx)(f.Suspense,{fallback:null,children:(0,d.jsx)(ol,{nodeData:t,showAllLines:!1,setTitle:r,setDefault:z,selectedComponent:n})},e.id)}),h.glossary.map(e=>{let t=g.nodeMap.get(e.id);if(!t)return null;let n=_[e.id],r=F[e.id]||z;return(0,d.jsx)(f.Suspense,{fallback:null,children:(0,d.jsx)(oh,{nodeData:t,showAllLines:!1,title:e.title,setTitle:r,setDefault:z,glossaryShellComponent:n})},e.id)}),(0,d.jsx)(nC,{processedData:g})]}),(0,d.jsx)(tB.default,{autoRotate:!!t&&!n,autoRotateSpeed:.5,minDistance:1,maxDistance:60,enableDamping:!0,dampingFactor:.08,enablePan:!0,makeDefault:!1,rotateSpeed:.8,panSpeed:.8,zoomSpeed:.8,enableRotate:!0})]})})]})},"dynamic",0,"force-dynamic"],81694)}]);

//# sourceMappingURL=e7c03a6bfbee85a3.js.map